1                                        The WPS System      10:48 Wednesday, July 29, 2015     

NOTE: (c) Copyright World Programming Limited 2002-2014.  All rights reserved.
NOTE: World Programming System 3.01 (03.01.01.00.000635)
      Licensed to Cognesia
NOTE: This session is executing on the LINUX platform and is running in 64 bit mode

NOTE: AUTOEXEC processing beginning; file is
      /home/software/wps-3.1.1.0.635-maintenance/autoexec.sas
MPRINT(DIRECT_LIBS):  libname base "/project17/CACDIRECT/DATA/BASE_DEMO/A";
NOTE: Library base assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CACDIRECT/DATA/BASE_DEMO/A

MPRINT(DIRECT_LIBS):  libname indiv "/project17/CACDIRECT/DATA/INDIV_DEMO/A";
NOTE: Library indiv assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CACDIRECT/DATA/INDIV_DEMO/A

MPRINT(DIRECT_LIBS):  libname scf "/project17/CACDIRECT/DATA/SCF_MKEY/A";
NOTE: Library scf assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CACDIRECT/DATA/SCF_MKEY/A

MPRINT(DIRECT_LIBS):  libname process "/project17/CACDIRECT/DATA/PROCESS";
NOTE: Library process assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CACDIRECT/DATA/PROCESS

MPRINT(DIRECT_LIBS):  libname geo "/project17/CACDIRECT/DATA/GEO/A";
NOTE: Library geo assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CACDIRECT/DATA/GEO/A

MPRINT(DIRECT_LIBS):  libname easi "/project17/CENSUS/DATA/2010/EASI";
NOTE: Library easi assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CENSUS/DATA/2010/EASI

MPRINT(DIRECT_LIBS):  libname cen2010 "/project17/CENSUS/DATA/2010/FINAL";
NOTE: Library cen2010 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CENSUS/DATA/2010/FINAL

MPRINT(DIRECT_LIBS):  libname cen2000 "/project17/CENSUS/DATA/FINAL";
NOTE: Library cen2000 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CENSUS/DATA/FINAL

MPRINT(DIRECT_LIBS):  libname samp "/project/CACDIRECT/DATA/SAMPLES/A";
NOTE: Library samp assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project/CACDIRECT/DATA/SAMPLES/A

MPRINT(DIRECT_LIBS):  libname dev "/project17/CACDIRECT/DATA/DEVELOPMENT";
NOTE: Library dev assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CACDIRECT/DATA/DEVELOPMENT

MPRINT(DIRECT_LIBS):  libname et "/project17/CACDIRECT/DATA/ETECH/A";
NOTE: Library et assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CACDIRECT/DATA/ETECH/A

MPRINT(DIRECT_LIBS):  libname jhs "/project17/CACDIRECT/DATA/JOB_HISTORY";
NOTE: Library jhs assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CACDIRECT/DATA/JOB_HISTORY

MPRINT(DIRECT_LIBS):  libname buycnc "/project17/CACDIRECT/DATA/BUYER_CONNECT/A";
NOTE: Library buycnc assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CACDIRECT/DATA/BUYER_CONNECT/A

MPRINT(DIRECT_LIBS):  libname foret "/project17/CACDIRECT/DATA/ETECH/FORETECH";
NOTE: Library foret assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CACDIRECT/DATA/ETECH/FORETECH

MPRINT(DIRECT_LIBS):  libname newsilh "/project17/CACDIRECT/DATA/SILH3D/A";
NOTE: Library newsilh assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CACDIRECT/DATA/SILH3D/A

MPRINT(DIRECT_LIBS):  libname ddnc "/project17/CACDIRECT/DATA/DDNC";
NOTE: Library ddnc assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CACDIRECT/DATA/DDNC

MPRINT(DIRECT_LIBS):  libname domsilh "/project17/CACDIRECT/DATA/DOM_SILH/A";
NOTE: Library domsilh assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CACDIRECT/DATA/DOM_SILH/A

MPRINT(DIRECT_LIBS):  libname intmdl "/project/CACDIRECT/DATA/INTMDL/A";
NOTE: Library intmdl assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project/CACDIRECT/DATA/INTMDL/A

MPRINT(DIRECT_LIBS):  libname for_rts "/project/CACDIRECT/DATA/REAL_TIME/A";
NOTE: Library for_rts assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project/CACDIRECT/DATA/REAL_TIME/A

MPRINT(DIRECT_LIBS):  libname v12 "/project/CACDIRECT/DATA/V12/A";
NOTE: Library v12 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project/CACDIRECT/DATA/V12/A

MPRINT(DIRECT_LIBS):  libname bridge "/project/CACDIRECT/DATA/BRIDGE/A";
NOTE: Library bridge assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project/CACDIRECT/DATA/BRIDGE/A

MPRINT(DIRECT_LIBS):  libname geoagg "/project/CACDIRECT/DATA/GEOAGG/A";
NOTE: Library geoagg assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project/CACDIRECT/DATA/GEOAGG/A

NOTE: Library dma assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project/CACDIRECT/DATA/DMA/A

NOTE: Format cdif output
NOTE: Procedure format step took :
      real time : 0.027
      cpu time  : 0.026


NOTE: Format cac_le_a output
NOTE: Format cac_le_b output
NOTE: Format $cac_le_c output
NOTE: Format match output
NOTE: Format geo_match output
NOTE: Format $cac_cdi output
NOTE: Format prod_act output
NOTE: Format cac_act output
NOTE: Format cac_prod output
NOTE: Format cac_kids output
NOTE: Format cac_mar output
NOTE: Format cac_age output
NOTE: Format $cac_inc output
NOTE: Format $cac_ninc output
NOTE: Format $silh_ld output
NOTE: Format $silh_super output
NOTE: Format $silh output
NOTE: Format pofaage output
NOTE: Format pofaagi output
NOTE: Format cac_edu output
NOTE: Format cac_occ output
NOTE: Format $etethnic output
NOTE: Format $etrelig output
NOTE: Format $etlang output
NOTE: Format $ethisporg output
NOTE: Format $ethispasm output
NOTE: Format $etasiaasm output
NOTE: Format $etgender output
NOTE: Procedure format step took :
      real time : 0.008
      cpu time  : 0.008


NOTE: Format $val_st_scf output
NOTE: Procedure format step took :
      real time : 0.008
      cpu time  : 0.008


MPRINT(B2B_LIBS):  libname b2b '/project/B2B/DATA/PRODUCTION/FIRM/B';
NOTE: Library b2b assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project/B2B/DATA/PRODUCTION/FIRM/B

MPRINT(B2B_LIBS):  libname b2bem '/project/B2B/DATA/PRODUCTION/EM/B';
NOTE: Library b2bem assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project/B2B/DATA/PRODUCTION/EM/B

MPRINT(B2B_LIBS):  libname b2bmkey '/project/B2B/DATA/PRODUCTION/MATCHKEYS/B';
NOTE: Library b2bmkey assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project/B2B/DATA/PRODUCTION/MATCHKEYS/B

MPRINT(B2B_LIBS):  libname b2bsamp '/project18/CLIENT/B2B/DATA/PRODUCTION/SAMPLES/B';
NOTE: Library b2bsamp assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project18/CLIENT/B2B/DATA/PRODUCTION/SAMPLES/B

MPRINT(B2B_LIBS):  libname b2bprocs '/project/B2B/DATA/PRODUCTION/PROCESS';
NOTE: Library b2bprocs assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project/B2B/DATA/PRODUCTION/PROCESS

NOTE: Format $salesvol output
NOTE: Format $empsize output
NOTE: Format $offsize output
NOTE: Format $adsize output
NOTE: Format $location output
NOTE: Format $ctitle output
NOTE: Format $callstat output
NOTE: Format $b2bcred output
NOTE: Format $sqftg output
NOTE: Format $teleexp output
NOTE: Format $utilexp output
NOTE: Format $adexp output
NOTE: Format $payexp output
NOTE: Format $rentexp output
NOTE: Format $pcexp output
NOTE: Format $osupexp output
NOTE: Format $acctexp output
NOTE: Format $packexp output
NOTE: Format $labrexp output
NOTE: Format $insrexp output
NOTE: Format $prntexp output
NOTE: Format $admnexp output
NOTE: Format $leglexp output
NOTE: Format $cstatus output
NOTE: Format $exptype output
NOTE: Format $actflag output
NOTE: Format $tcode output
NOTE: Format $ttype output
NOTE: Format $wealth output
NOTE: Format $addrtype output
NOTE: Format $busstat output
NOTE: Format $govflag output
NOTE: Format $indflag output
NOTE: Format $sic1cac output
NOTE: Format $sic2cac output
NOTE: Format $sic4cac output
NOTE: Procedure format step took :
      real time : 0.024
      cpu time  : 0.024


NOTE: Format $sicdis output
NOTE: Procedure format step took :
      real time : 0.079
      cpu time  : 0.078


NOTE: AUTOEXEC processing completed

1         *;
2         * 180_bb_agg_base_by_zip.sas;
3         * Aggregates base demo to ZIP to create aggregates for buzz board profile app;
4         *;
5         
6         * LOCATION OF CURRENT SQL DATABASE SUPPORTING THE PROFILE APP;
7         * PEER 1 CAC_DIRECT;
8         /*
9         %let user=mmattingly;
10        %let pw=BearDown_15;
11        %let server=216.157.38.64;
12        libname peer1 ODBC
NOPROMPT="UID=&user;pwd=&pw;DSN=MSSQL;SERVER=&server;DATABASE=CAC_DIRECT;" readbuff=10000
insertbuff=10000 dbcommit=10000;
13        */
14        
15        proc format;
16        value $silh_value
17        'A1'=1
18        'A2'=2
19        'A3'=3
20        'A4'=4
21        'A5'=5
22        'A6'=6
23        'B1'=7
24        'B2'=8
25        'B3'=9
26        'B4'=10
27        'C1'=11
28        'C2'=12
29        'C3'=13
30        'C4'=14
31        'C5'=15
32        'D1'=16
33        'D2'=17
34        'D3'=18
35        'D4'=19
36        'D5'=20
37        'E1'=21
38        'E2'=22
39        'E3'=23
40        'E4'=24
41        'F1'=25
42        'F2'=26
43        'F3'=27
44        'F4'=28
45        'F5'=29
46        'F6'=30
47        'F7'=31
48        'G1'=32
49        'G2'=33
50        'G3'=34
51        'H1'=35
52        'H2'=36
53        'H3'=37
54        'H4'=38
55        'H5'=39
56        'I1'=40
57        'I2'=41
58        'I3'=42
59        'I4'=43
60        'I5'=44
61        'J1'=45
62        'J2'=46
63        'J3'=47
64        'J4'=48
65        'K1'=49
66        'K2'=50
67        'K3'=51
68        'K4'=52
69        'L1'=53
70        'L2'=54
71        'L3'=55
72        'L4'=56
73        'L5'=57
74        'L6'=58
75        'XX'=59
76        ;
NOTE: Format $silh_value output
77        run;
NOTE: Procedure format step took :
      real time : 0.001
      cpu time  : 0.000


78        
79        %macro aggregation(cac_read_dir_loc=,sort_var=,by_var=,merge_field=,testobs=,
codepath=PROD);
80        
81           %include "/project/CACDIRECT/CODE/&codepath./METADATA/library.inc";
82        
83           %if &cac_read_dir_loc=A %then %do;                                       *** IF
CURRENT PRODUCTION DATA IS IN A THEN WRITE DATA FOR NEW QUARTER TO B;
84              libname _ALL_;
85              libname base      "/project/CACDIRECT/&cidatapath./BASE_DEMO/B";
86              libname for_rts  "/project/CACDIRECT/&cidatapath./REAL_TIME/B";
87              libname cen2010 "/project17/CENSUS/DATA/2010/FINAL";
88           %end;
89        
90           %else %if &cac_read_dir_loc=B %then %do;                                        ***
IF CURRENT PRODUCTION DATA IS IN B THEN WRITE DATA FOR NEW QUARTER TO A;
91              libname _ALL_;
92              libname base      "/project/CACDIRECT/&cidatapath./BASE_DEMO/A";
93              libname for_rts  "/project/CACDIRECT/&cidatapath./REAL_TIME/A";
94              libname cen2010 "/project17/CENSUS/DATA/2010/FINAL";
95           %end;
96        
97           filename file_3
"/project/CACDIRECT/&cidatapath./EXPORT/BUZZBOARD/buzzboard_zip_level.csv";
98        
99          
*-----------------------------------------------------------------------------------------------
-------------------------------------*;
100          *------ Define States and get state count
-------------------------------------------------------------------------------------------*;
101         
*-----------------------------------------------------------------------------------------------
-------------------------------------*;
102          %let states = AL AK AZ AR CA CO CT DE FL GA HI ID IL IN IA KS KY LA ME MD MA MI MN
MS MO MT
103                        NE NV NH NJ NM NY NC ND OH OK OR PA RI SC SD TN TX UT VT VA WA WV WI
WY DC;
104          %***let states = VT;
105       
106          data _NULL_; array x(*) &states; call symput("numstates",dim(x)); run;
107       
108          %do ipb = 1 %to &numstates;
109            
*-----------------------------------------------------------------------------------------------
-------------------------------------*;
110             *------ Grab ConsumerIntellibase Data!!!!
-------------------------------------------------------------------------------------------*;
111            
*-----------------------------------------------------------------------------------------------
-------------------------------------*;
112             proc sort data = base.base_demo_%scan(&states,&ipb.) (obs=&testobs
113                                                                   keep=cac_addr_zip
cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh cac_addr_latitude
cac_addr_longitude
114       								 cac_silh_dig_inf cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf
115       							    )
116                        out = base_demo_%scan(&states,&ipb.);
117                by &sort_var;
118             run;
119       
120             data base_demo_%scan(&states,&ipb.) (keep=matching_field avg_lat avg_lon silh_:
cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social avg_cac_silh_dig_inf
121       						sum_cac_silh_social sum_cac_silh_dig_inf counts_hh sum_cac_silh_soc_inf
avg_cac_silh_soc_inf);
122                set base_demo_%scan(&states,&ipb.);
123                by &sort_var;
124                *array silh(59) _temporary_ (1-59);
125                array silh_counts (59) silh_1-silh_59 ;
126                array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
127                retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
128       
129                if first.&by_var then do;
130                   sum_lat=0;
131                   sum_lon=0;
132       	    sum_cac_silh_social=0;
133       	    sum_cac_silh_dig_inf=0;
134                   sum_cac_silh_soc_inf=0;
135                   counter = 0;
136       	    counts_hh=0;
137                   do p=1 to 59;
138                      silh_counts(p)=0;
139                   end;
140                   do q=1 to 7;
141                      buy_style(q)=0;
142       	    end;
143                end;
144       
145                if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
counter+1;
146       	 counts_hh+1;
147                sum_lat+cac_addr_latitude;
148                sum_lon+cac_addr_longitude;
149       	 sum_cac_silh_social+cac_silh_social;
150       	 sum_cac_silh_dig_inf+cac_silh_dig_inf;
151                sum_cac_silh_soc_inf+cac_silh_soc_inf;
152                silh_counts(put(CAC_SILH,silh_value.)+0)+1;
153       
154                %do b=1 %to 7;
155                   if cac_silh_buy_style_group=&b then buy_style(&b)+1;
156                %end;
157       
158       
159                if last.&by_var then do;
160                   matching_field =cac_addr_zip;
161                   avg_lat=sum_lat/counter;
162                   avg_lon=sum_lon/counter;
163       	    avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
164       	    avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
165       	    avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
166                   output;
167                end;
168                drop p q;
169             run;
170             proc sort data = base_demo_%scan(&states,&ipb.);
171                by &merge_field ;
172             run;
173       
174            
*-----------------------------------------------------------------------------------------------
-------------------------------------*;
175             *------ Grab Census Data!!!!
------------------------------------------------------------------------------------------------
--------*;
176            
*-----------------------------------------------------------------------------------------------
-------------------------------------*;
177             proc sort data=cen2010.cac_census_xref_%scan(&states,&ipb.)
out=census_xref_%scan(&states,&ipb.);
178                by cac_census_id;
179             run;
180       
181             proc  sort NODUPKEY data=cen2010.cac_census_final_%scan(&states,&ipb.)
out=census_%scan(&states,&ipb.);
182                by cac_census_id;
183             run;
184       
185             data cen_%scan(&states,&ipb.) (drop   = cac_census_id cac_addr_zip cen_hsevac_4
cen_hhrel_4 cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
186                                            rename = (cen_popage_2 = median_age
cen_hhinc_2=median_income));
187                merge census_%scan(&states,&ipb.)(in=a keep= cac_census_id county blkgrp
tract cen_count_pop cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
cen_hhrel_4)
188       	       census_xref_%scan(&states,&ipb.)(in=b);
189                by cac_census_id;
190                matching_field =cac_addr_zip;
191       	 with_children  = cen_hhrel_4;
192       	 owner_occupied = cen_hsevac_4;
193             run;
194             proc sort NODUPKEY  data = cen_%scan(&states,&ipb.)(where=(CAC_ADDR_ZIP4=""));
195                by &merge_field  ;
196             run;
197            
*-----------------------------------------------------------------------------------------------
-------------------------------------*;
198             *------ Put intellibase rollup and cen together
-------------------------------------------------------------------------------------*;
199            
*-----------------------------------------------------------------------------------------------
-------------------------------------*;
200             data for_buzzboard_%scan(&states,&ipb.);
201                merge cen_%scan(&states,&ipb.)       (in=a)
202                      base_demo_%scan(&states,&ipb.) (in=b);
203                by &merge_field ;
204                if a and b;
205                state = "%scan(&states,&ipb.)";
206             run;
207       
208            
*-----------------------------------------------------------------------------------------------
-------------------------------------*;
209             *------ Dump the Junk
------------------------------------------------------------------------------------------------
---------------*;
210            
*-----------------------------------------------------------------------------------------------
-------------------------------------*;
211             proc datasets NOLIST library = work;
212                delete  cen_%scan(&states,&ipb.) base_demo_%scan(&states,&ipb.);
213             run;
214       
215          %end; *numstates loop;
216         
*-----------------------------------------------------------------------------------------------
-------------------------------------*;
217          *------ Stack the States and do some Diags
------------------------------------------------------------------------------------------*;
218         
*-----------------------------------------------------------------------------------------------
-------------------------------------*;
219       
220          data for_rts.buzzboard_zip_level;
221             set %do v = 1 %to &numstates; for_buzzboard_%scan(&states,&v.) %end; ;
222             if matching_field="" then delete;
223          run;
224          title '--------------------  for_rts.buzzboard_zip_level
--------------------------------------';
225          proc means data =  for_rts.buzzboard_zip_level ;
226          run;
227          proc freq data =  for_rts.buzzboard_zip_level ;
228             table state;
229          run;
230          proc print data =  for_rts.buzzboard_zip_level (obs=100);
231          run;
232       
233          data _null_;
234             set  for_rts.buzzboard_zip_level;
235             file file_3 dsd dlm=',' lrecl=20000;
236             put CAC_ADDR_ZIP4 CEN_COUNT_FAM CEN_COUNT_HH CEN_COUNT_POP avg_cac_silh_dig_inf
avg_cac_silh_soc_inf avg_cac_silh_social avg_lat avg_lon
237                 cac_silh_buy_style_group_3
cac_silh_buy_style_group_4	cac_silh_buy_style_group_5 counts_hh matching_field median_age
median_income
238                 owner_occupied silh_1 silh_2 silh_3 silh_4 silh_5 silh_6 silh_7 silh_8
silh_9 silh_10 silh_11 silh_12 silh_13 silh_14 silh_15
239                 silh_16 silh_17 silh_18 silh_19 silh_20 silh_21 silh_22 silh_23 silh_24
silh_25 silh_26 silh_27 silh_28	
240                 silh_29 silh_30 silh_31 silh_32 silh_33 silh_34 silh_35 silh_36 silh_37
silh_38 silh_39 silh_40 silh_41 silh_42 silh_43 silh_44	
241                 silh_45 silh_46 silh_47 silh_48 silh_49 silh_50 silh_51 silh_52 silh_53
silh_54 silh_55 silh_56 silh_57 silh_58 silh_59 state	
242                 sum_cac_silh_dig_inf sum_cac_silh_soc_inf sum_cac_silh_social with_children;
243          run;
244       
245       
246       %mend aggregation;
247       %aggregation(cac_read_dir_loc=B,sort_var= cac_addr_zip, by_var  = cac_addr_zip,
merge_field = matching_field, testobs = max, codepath=DEVELOPMENT/1240_Z2_HH);
MPRINT(AGGREGATION):  **************************************************************************
                      ****;
MPRINT(AGGREGATION):  * MASTER CONTROLLER FOR ENABLING CACDIRECT PROCESSING/MATCHING;
MPRINT(AGGREGATION):  * Updated: 4/19/2012 - JS  * Updated: 5/1/2012 - MM ADDED JOB_HISTORY LIB 
                      * Updated: 5/4/2012 - MM ADDED CEN2010  * Updated: 5/7/2012 - MM ADDED
                      BUYCNC * Updated: 5/7/2012 - MM Changed DEV to point to project17 from
                      project17 * Updated: 7/9/2012 - MM Removed BAK since it no longer required
                      * Updated: 7/11/2012 - MM Added NCOA_KILL * Updated: 7/12/2012 - MM Added
                      FORET
                      **************************************************************************
                      ****;
MPRINT(AGGREGATION):  *------------------LIBRARIES------------------;
MPRINT(AGGREGATION):  **** MACRO DIRECT_LIBS DEFINES LIBRARIES FOR PRODUCTION CACDIRECT DATA;
MPRINT(AGGREGATION):  **** MM 1/2013;
MPRINT(AGGREGATION):  **** MACRO TAKES 3 PARAMETERS: 1) CAC_DIRECT_PROD_DIR: (A|B) USED TO
                      DETERMINE WHERE DATA IS READ FROM;
MPRINT(AGGREGATION):  **** A = PROJECT17/A/..;
MPRINT(AGGREGATION):  **** B = PROJECT17/B/..;
MPRINT(AGGREGATION):  **** 2) YEAR: YEAR OF PRODUCTION DATA;
MPRINT(AGGREGATION):  **** 3) QTR: QTR OF PRODUCTION DATA;
MPRINT(AGGREGATION):  **** NEW MACRO CALL CREATED UPDATED UPON THE COMPLETION OF CACDIRECT
                      UPDATE;
MPRINT(AGGREGATION):  **** HISTORICAL MACROS CALLS LEFT FOR HISTORICAL REFERENCE;
MPRINT(DIRECT_LIBS):  libname base
                      "/project17/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/BASE_DEMO/B";
NOTE: Library base assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/BASE_DEMO/B

MPRINT(DIRECT_LIBS):  libname indiv
                      "/project17/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/INDIV_DEMO/B";
NOTE: Library indiv does not exist
MPRINT(DIRECT_LIBS):  libname scf "/project17/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/SCF_MKEY/B";
NOTE: Library scf does not exist
MPRINT(DIRECT_LIBS):  libname process
                      "/project17/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/PROCESS";
NOTE: Library process does not exist
MPRINT(DIRECT_LIBS):  libname geo "/project17/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/GEO/B";
NOTE: Library geo does not exist
MPRINT(DIRECT_LIBS):  libname easi "/project17/CENSUS/DATA/2010/EASI";
NOTE: Library easi assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CENSUS/DATA/2010/EASI

MPRINT(DIRECT_LIBS):  libname cen2010 "/project17/CENSUS/DATA/2010/FINAL";
NOTE: Library cen2010 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CENSUS/DATA/2010/FINAL

MPRINT(DIRECT_LIBS):  libname cen2000 "/project17/CENSUS/DATA/FINAL";
NOTE: Library cen2000 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CENSUS/DATA/FINAL

MPRINT(DIRECT_LIBS):  libname samp "/project/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/SAMPLES/B";
NOTE: Library samp does not exist
MPRINT(DIRECT_LIBS):  libname dev
                      "/project17/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/DEVELOPMENT";
NOTE: Library dev does not exist
MPRINT(DIRECT_LIBS):  libname et "/project17/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/ETECH/B";
NOTE: Library et does not exist
MPRINT(DIRECT_LIBS):  libname jhis
                      "/project17/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/JOB_HISTORY";
NOTE: Library jhis does not exist
MPRINT(DIRECT_LIBS):  libname buycnc
                      "/project17/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/BUYER_CONNECT/B";
NOTE: Library buycnc does not exist
MPRINT(DIRECT_LIBS):  libname foret
                      "/project17/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/ETECH/FORETECH";
NOTE: Library foret does not exist
MPRINT(DIRECT_LIBS):  libname newsilh
                      "/project17/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/SILH3D/B";
NOTE: Library newsilh does not exist
MPRINT(DIRECT_LIBS):  libname ddnc "/project17/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/DDNC";
NOTE: Library ddnc does not exist
MPRINT(DIRECT_LIBS):  libname domsilh
                      "/project17/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/DOM_SILH/B";
NOTE: Library domsilh does not exist
MPRINT(DIRECT_LIBS):  libname intmdl "/project/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/INTMDL/B";
NOTE: Library intmdl does not exist
MPRINT(DIRECT_LIBS):  libname for_rts
                      "/project/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/REAL_TIME/B";
NOTE: Library for_rts assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/REAL_TIME/B

MPRINT(DIRECT_LIBS):  libname v12 "/project/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/V12/B";
NOTE: Library v12 does not exist
MPRINT(DIRECT_LIBS):  libname bridge "/project/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/BRIDGE/B";
NOTE: Library bridge assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/BRIDGE/B

MPRINT(DIRECT_LIBS):  libname geoagg "/project/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/GEOAGG/B";
NOTE: Library geoagg does not exist
MPRINT(AGGREGATION):  ;
MPRINT(AGGREGATION):  * LIBNAME FOR RAW DMA DATA;
MPRINT(AGGREGATION):  libname dma "/project/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/DMA/A";
NOTE: Library dma does not exist
MPRINT(AGGREGATION):  *------CLIENT MATCHMAKER----*  %let sts = AK AL AR AZ CA CO CT DC DE FL  
                      GA HI IA ID IL IN KS KY LA MA  MD ME MI MN MO MS MT NC ND NE   NH NJ NM NV
                      NY OH OK OR PA RI  SC SD TN TX UT VA VT WA WI WV  WY;
MPRINT(AGGREGATION):  ********************;
MPRINT(AGGREGATION):  *INFILE STATEMENTS *;
MPRINT(AGGREGATION):  ********************;
MPRINT(AGGREGATION):  *--- for input of TSP install;
MPRINT(AGGREGATION):  ************;
MPRINT(AGGREGATION):  * FORMATS;
MPRINT(AGGREGATION):  ************;
MPRINT(AGGREGATION):  proc format;
MPRINT(AGGREGATION):  value cdif 1001 ='D' 1003 ='B' 1005 ='D' 1007 ='D' 1009 ='B' 1011 ='D'
                      1013 ='D' 1015 ='C' 1017 ='D' 1019 ='D' 1021 ='D' 1023 ='D' 1025 ='D' 1027
                      ='D' 1029 ='D' 1031 ='D' 1033 ='D' 1035 ='D' 1037 ='D' 1039 ='D' 1041 ='D'
                      1043 ='C' 1045 ='D' 1047 ='D' 1049 ='D' 1051 ='D' 1053 ='D' 1055 ='C' 1057
                      ='D' 1059 ='D' 1061 ='D' 1063 ='D' 1065 ='D' 1067 ='D' 1069 ='C' 1071 ='D'
                      1073 ='B' 1075 ='D' 1077 ='C' 1079 ='D' 1081 ='C' 1083 ='C' 1085 ='D' 1087
                      ='D' 1089 ='C' 1091 ='D' 1093 ='D' 1095 ='C' 1097 ='B' 1099 ='D' 1101 ='C'
                      1103 ='C' 1105 ='D' 1107 ='D' 1109 ='D' 1111 ='D' 1113 ='D' 1115 ='B' 1117
                      ='B' 1119 ='D' 1121 ='D' 1123 ='D' 1125 ='C' 1127 ='D' 1129 ='D' 1131 ='D'
                      1133 ='D' 2013 ='D' 2016 ='D' 2020 ='C' 2050 ='D' 2060 ='D' 2068 ='D' 2070
                      ='D' 2090 ='D' 2100 ='D' 2105 ='D' 2110 ='D' 2122 ='D' 2130 ='D' 2150 ='D'
                      2164 ='D' 2170 ='D' 2180 ='D' 2185 ='D' 2188 ='D' 2195 ='D' 2198 ='D' 2220
                      ='D' 2230 ='D' 2240 ='D' 2261 ='D' 2270 ='D' 2275 ='D' 2282 ='D' 2290 ='D'
                      4001 ='D' 4003 ='D' 4005 ='D' 4007 ='D' 4009 ='D' 4011 ='D' 4012 ='D' 4013
                      ='A' 4015 ='B' 4017 ='D' 4019 ='B' 4021 ='A' 4023 ='D' 4025 ='D' 4027 ='D'
                      5001 ='D' 5003 ='D' 5005 ='D' 5007 ='C' 5009 ='D' 5011 ='D' 5013 ='D' 5015
                      ='D' 5017 ='D' 5019 ='D' 5021 ='D' 5023 ='D' 5025 ='D' 5027 ='D' 5029 ='D'
                      5031 ='C' 5033 ='D' 5035 ='B' 5037 ='D' 5039 ='D' 5041 ='D' 5043 ='D' 5045
                      ='B' 5047 ='D' 5049 ='D' 5051 ='C' 5053 ='D' 5055 ='D' 5057 ='D' 5059 ='D'
                      5061 ='D' 5063 ='D' 5065 ='D' 5067 ='D' 5069 ='D' 5071 ='D' 5073 ='D' 5075
                      ='D' 5077 ='D' 5079 ='D' 5081 ='D' 5083 ='D' 5085 ='B' 5087 ='D' 5089 ='D'
                      5091 ='D' 5093 ='D' 5095 ='D' 5097 ='D' 5099 ='D' 5101 ='D' 5103 ='D' 5105
                      ='D' 5107 ='D' 5109 ='D' 5111 ='D' 5113 ='D' 5115 ='D' 5117 ='D' 5119 ='B'
                      5121 ='D' 5123 ='D' 5125 ='B' 5127 ='D' 5129 ='D' 5131 ='C' 5133 ='D' 5135
                      ='D' 5137 ='D' 5139 ='D' 5141 ='D' 5143 ='C' 5145 ='D' 5147 ='D' 5149 ='D'
                      6001 ='A' 6003 ='D' 6005 ='D' 6007 ='C' 6009 ='D' 6011 ='D' 6013 ='A' 6015
                      ='D' 6017 ='B' 6019 ='B' 6021 ='D' 6023 ='D' 6025 ='D' 6027 ='D' 6029 ='B'
                      6031 ='D' 6033 ='D' 6035 ='D' 6037 ='A' 6039 ='B' 6041 ='A' 6043 ='D' 6045
                      ='D' 6047 ='D' 6049 ='D' 6051 ='D' 6053 ='C' 6055 ='A' 6057 ='C' 6059 ='A'
                      6061 ='B' 6063 ='D' 6065 ='A' 6067 ='B' 6069 ='D' 6071 ='A' 6073 ='A' 6075
                      ='A' 6077 ='C' 6079 ='D' 6081 ='A' 6083 ='C' 6085 ='A' 6087 ='A' 6089 ='D'
                      6091 ='D' 6093 ='D' 6095 ='A' 6097 ='A' 6099 ='C' 6101 ='C' 6103 ='D' 6105
                      ='D' 6107 ='D' 6109 ='D' 6111 ='A' 6113 ='B' 6115 ='D' 8001 ='A' 8003 ='D'
                      8005 ='A' 8007 ='D' 8009 ='D' 8011 ='D' 8013 ='A' 8014 ='C' 8015 ='D' 8017
                      ='D' 8019 ='D' 8021 ='D' 8023 ='D' 8025 ='D' 8027 ='D' 8029 ='D' 8031 ='A'
                      8033 ='D' 8035 ='A' 8037 ='D' 8039 ='D' 8041 ='C' 8043 ='D' 8045 ='D' 8047
                      ='D' 8049 ='D' 8051 ='D' 8053 ='D' 8055 ='D' 8057 ='D' 8059 ='A' 8061 ='D'
                      8063 ='D' 8065 ='D' 8067 ='D' 8069 ='D' 8071 ='D' 8073 ='D' 8075 ='D' 8077
                      ='D' 8079 ='D' 8081 ='D' 8083 ='D' 8085 ='D' 8087 ='D' 8089 ='D' 8091 ='D'
                      8093 ='D' 8095 ='D' 8097 ='D' 8099 ='D' 8101 ='D' 8103 ='D' 8105 ='D' 8107
                      ='D' 8109 ='D' 8111 ='D' 8113 ='D' 8115 ='D' 8117 ='D' 8119 ='D' 8121 ='D'
                      8123 ='A' 8125 ='D' 9001 ='A' 9003 ='C' 9005 ='A' 9007 ='A' 9009 ='A' 9011
                      ='C' 9013 ='C' 9015 ='C' 10001 ='C' 10003 ='A' 10005 ='C' 11001 ='A' 12001
                      ='C' 12003 ='D' 12005 ='C' 12007 ='D' 12009 ='B' 12011 ='A' 12013 ='D'
                      12015 ='C' 12017 ='C' 12019 ='B' 12021 ='C' 12023 ='D' 12027 ='D' 12029
                      ='D' 12031 ='B' 12033 ='C' 12035 ='B' 12037 ='D' 12039 ='D' 12041 ='D'
                      12043 ='D' 12045 ='D' 12047 ='D' 12049 ='D' 12051 ='D' 12053 ='A' 12055
                      ='C' 12057 ='A' 12059 ='D' 12061 ='C' 12063 ='D' 12065 ='D' 12067 ='D'
                      12069 ='B' 12071 ='B' 12073 ='C' 12075 ='D' 12077 ='D' 12079 ='D' 12081
                      ='B' 12083 ='C' 12085 ='C' 12086 ='A' 12087 ='C' 12089 ='B' 12091 ='C'
                      12093 ='D' 12095 ='B' 12097 ='B' 12099 ='B' 12101 ='A' 12103 ='A' 12105
                      ='B' 12107 ='C' 12109 ='B' 12111 ='C' 12113 ='C' 12115 ='B' 12117 ='B'
                      12119 ='D' 12121 ='D' 12123 ='D' 12125 ='D' 12127 ='B' 12129 ='D' 12131
                      ='D' 12133 ='D' 13001 ='D' 13003 ='D' 13005 ='D' 13007 ='D' 13009 ='C'
                      13011 ='D' 13013 ='A' 13015 ='A' 13017 ='D' 13019 ='D' 13021 ='C' 13023
                      ='D' 13025 ='D' 13027 ='D' 13029 ='D' 13031 ='D' 13033 ='D' 13035 ='D'
                      13037 ='D' 13039 ='D' 13043 ='D' 13045 ='A' 13047 ='C' 13049 ='D' 13051
                      ='C' 13053 ='D' 13055 ='D' 13057 ='A' 13059 ='C' 13061 ='D' 13063 ='A'
                      13065 ='D' 13067 ='A' 13069 ='D' 13071 ='D' 13073 ='C' 13075 ='D' 13077
                      ='A' 13079 ='D' 13081 ='D' 13083 ='D' 13085 ='D' 13087 ='D' 13089 ='A'
                      13091 ='D' 13093 ='D' 13095 ='C' 13097 ='A' 13099 ='D' 13101 ='D' 13103
                      ='D' 13105 ='D' 13107 ='D' 13109 ='D' 13111 ='D' 13113 ='A' 13115 ='C'
                      13117 ='A' 13119 ='D' 13121 ='A' 13123 ='D' 13125 ='D' 13127 ='C' 13129
                      ='C' 13131 ='D' 13133 ='D' 13135 ='A' 13137 ='C' 13139 ='C' 13141 ='D'
                      13143 ='D' 13145 ='D' 13147 ='C' 13149 ='D' 13151 ='A' 13153 ='C' 13155
                      ='D' 13157 ='C' 13159 ='D' 13161 ='D' 13163 ='D' 13165 ='D' 13167 ='D'
                      13169 ='D' 13171 ='D' 13173 ='D' 13175 ='D' 13177 ='D' 13179 ='C' 13181
                      ='D' 13183 ='D' 13185 ='C' 13187 ='D' 13189 ='D' 13191 ='D' 13193 ='D'
                      13195 ='D' 13197 ='D' 13199 ='D' 13201 ='D' 13205 ='D' 13207 ='D' 13209
                      ='D' 13211 ='D' 13213 ='D' 13215 ='C' 13217 ='A' 13219 ='C' 13221 ='D'
                      13223 ='A' 13225 ='C' 13227 ='A' 13229 ='D' 13231 ='D' 13233 ='C' 13235
                      ='D' 13237 ='D' 13239 ='D' 13241 ='D' 13243 ='D' 13245 ='C' 13247 ='A'
                      13249 ='D' 13251 ='D' 13253 ='D' 13255 ='A' 13257 ='C' 13259 ='D' 13261
                      ='D' 13263 ='D' 13265 ='D' 13267 ='D' 13269 ='D' 13271 ='D' 13273 ='D'
                      13275 ='D' 13277 ='C' 13279 ='D' 13281 ='D' 13283 ='D' 13285 ='C' 13287
                      ='D' 13289 ='D' 13291 ='D' 13293 ='D' 13295 ='C' 13297 ='A' 13299 ='D'
                      13301 ='D' 13303 ='D' 13305 ='D' 13307 ='D' 13309 ='D' 13311 ='D' 13313
                      ='C' 13315 ='D' 13317 ='D' 13319 ='D' 13321 ='D' 15001 ='D' 15003 ='C'
                      15007 ='D' 15009 ='C' 16001 ='C' 16003 ='D' 16005 ='D' 16007 ='D' 16009
                      ='D' 16011 ='D' 16013 ='D' 16015 ='D' 16017 ='D' 16019 ='D' 16021 ='D'
                      16023 ='D' 16025 ='D' 16027 ='C' 16029 ='D' 16031 ='D' 16033 ='D' 16035
                      ='D' 16037 ='D' 16039 ='D' 16041 ='D' 16043 ='D' 16045 ='D' 16047 ='D'
                      16049 ='D' 16051 ='D' 16053 ='D' 16055 ='C' 16057 ='D' 16059 ='D' 16061
                      ='D' 16063 ='D' 16065 ='D' 16067 ='D' 16069 ='D' 16071 ='D' 16073 ='D'
                      16075 ='D' 16077 ='D' 16079 ='D' 16081 ='D' 16083 ='D' 16085 ='D' 16087
                      ='D' 17001 ='D' 17003 ='D' 17005 ='D' 17007 ='C' 17009 ='D' 17011 ='D'
                      17013 ='D' 17015 ='D' 17017 ='D' 17019 ='C' 17021 ='D' 17023 ='D' 17025
                      ='D' 17027 ='A' 17029 ='C' 17031 ='A' 17033 ='D' 17035 ='D' 17037 ='A'
                      17039 ='D' 17041 ='D' 17043 ='A' 17045 ='D' 17047 ='D' 17049 ='D' 17051
                      ='D' 17053 ='D' 17055 ='D' 17057 ='D' 17059 ='D' 17061 ='D' 17063 ='A'
                      17065 ='D' 17067 ='D' 17069 ='D' 17071 ='D' 17073 ='D' 17075 ='D' 17077
                      ='D' 17079 ='D' 17081 ='D' 17083 ='A' 17085 ='D' 17087 ='D' 17089 ='A'
                      17091 ='A' 17093 ='A' 17095 ='D' 17097 ='A' 17099 ='D' 17101 ='D' 17103
                      ='D' 17105 ='D' 17107 ='D' 17109 ='D' 17111 ='A' 17113 ='C' 17115 ='C'
                      17117 ='D' 17119 ='A' 17121 ='D' 17123 ='D' 17125 ='D' 17127 ='D' 17129
                      ='D' 17131 ='D' 17133 ='A' 17135 ='D' 17137 ='D' 17139 ='D' 17141 ='D'
                      17143 ='C' 17145 ='D' 17147 ='D' 17149 ='D' 17151 ='D' 17153 ='D' 17155
                      ='D' 17157 ='D' 17159 ='D' 17161 ='C' 17163 ='A' 17165 ='D' 17167 ='C'
                      17169 ='D' 17171 ='D' 17173 ='D' 17175 ='D' 17177 ='D' 17179 ='C' 17181
                      ='D' 17183 ='D' 17185 ='D' 17187 ='D' 17189 ='D' 17191 ='D' 17193 ='D'
                      17195 ='D' 17197 ='A' 17199 ='C' 17201 ='C' 17203 ='D' 18001 ='D' 18003
                      ='C' 18005 ='C' 18007 ='D' 18009 ='D' 18011 ='B' 18013 ='D' 18015 ='D'
                      18017 ='D' 18019 ='B' 18021 ='D' 18023 ='D' 18025 ='D' 18027 ='D' 18029
                      ='B' 18031 ='D' 18033 ='C' 18035 ='C' 18037 ='D' 18039 ='C' 18041 ='C'
                      18043 ='B' 18045 ='D' 18047 ='D' 18049 ='D' 18051 ='D' 18053 ='C' 18055
                      ='D' 18057 ='B' 18059 ='B' 18061 ='B' 18063 ='B' 18065 ='C' 18067 ='C'
                      18069 ='D' 18071 ='D' 18073 ='D' 18075 ='D' 18077 ='D' 18079 ='D' 18081
                      ='B' 18083 ='D' 18085 ='C' 18087 ='D' 18089 ='A' 18091 ='C' 18093 ='D'
                      18095 ='B' 18097 ='B' 18099 ='D' 18101 ='D' 18103 ='D' 18105 ='C' 18107
                      ='D' 18109 ='B' 18111 ='D' 18113 ='D' 18115 ='B' 18117 ='D' 18119 ='D'
                      18121 ='D' 18123 ='D' 18125 ='D' 18127 ='A' 18129 ='D' 18131 ='D' 18133
                      ='D' 18135 ='D' 18137 ='D' 18139 ='D' 18141 ='C' 18143 ='B' 18145 ='B'
                      18147 ='D' 18149 ='D' 18151 ='C' 18153 ='D' 18155 ='D' 18157 ='C' 18159
                      ='D' 18161 ='D' 18163 ='C' 18165 ='D' 18167 ='C' 18169 ='D' 18171 ='D'
                      18173 ='C' 18175 ='D' 18177 ='C' 18179 ='D' 18181 ='D' 18183 ='D' 19001
                      ='D' 19003 ='D' 19005 ='D' 19007 ='D' 19009 ='D' 19011 ='D' 19013 ='C'
                      19015 ='D' 19017 ='D' 19019 ='D' 19021 ='D' 19023 ='D' 19025 ='D' 19027
                      ='D' 19029 ='D' 19031 ='D' 19033 ='D' 19035 ='D' 19037 ='D' 19039 ='D'
                      19041 ='D' 19043 ='D' 19045 ='D' 19047 ='D' 19049 ='D' 19051 ='D' 19053
                      ='D' 19055 ='D' 19057 ='C' 19059 ='D' 19061 ='C' 19063 ='D' 19065 ='D'
                      19067 ='D' 19069 ='D' 19071 ='D' 19073 ='D' 19075 ='D' 19077 ='D' 19079
                      ='D' 19081 ='D' 19083 ='D' 19085 ='D' 19087 ='D' 19089 ='D' 19091 ='D'
                      19093 ='D' 19095 ='D' 19097 ='D' 19099 ='D' 19101 ='D' 19103 ='C' 19105
                      ='D' 19107 ='D' 19109 ='D' 19111 ='D' 19113 ='C' 19115 ='D' 19117 ='D'
                      19119 ='D' 19121 ='D' 19123 ='D' 19125 ='D' 19127 ='D' 19129 ='D' 19131
                      ='D' 19133 ='D' 19135 ='D' 19137 ='D' 19139 ='D' 19141 ='D' 19143 ='D'
                      19145 ='D' 19147 ='D' 19149 ='D' 19151 ='D' 19153 ='C' 19155 ='B' 19157
                      ='D' 19159 ='D' 19161 ='D' 19163 ='C' 19165 ='D' 19167 ='D' 19169 ='D'
                      19171 ='D' 19173 ='D' 19175 ='D' 19177 ='D' 19179 ='D' 19181 ='D' 19183
                      ='D' 19185 ='D' 19187 ='D' 19189 ='D' 19191 ='D' 19193 ='D' 19195 ='D'
                      19197 ='D' 20001 ='D' 20003 ='D' 20005 ='D' 20007 ='D' 20009 ='D' 20011
                      ='D' 20013 ='D' 20015 ='D' 20017 ='D' 20019 ='D' 20021 ='D' 20023 ='D'
                      20025 ='D' 20027 ='D' 20029 ='D' 20031 ='D' 20033 ='D' 20035 ='D' 20037
                      ='D' 20039 ='D' 20041 ='D' 20043 ='D' 20045 ='C' 20047 ='D' 20049 ='D'
                      20051 ='D' 20053 ='D' 20055 ='D' 20057 ='D' 20059 ='D' 20061 ='D' 20063
                      ='D' 20065 ='D' 20067 ='D' 20069 ='D' 20071 ='D' 20073 ='D' 20075 ='D'
                      20077 ='D' 20079 ='D' 20081 ='D' 20083 ='D' 20085 ='D' 20087 ='D' 20089
                      ='D' 20091 ='B' 20093 ='D' 20095 ='D' 20097 ='D' 20099 ='D' 20101 ='D'
                      20103 ='B' 20105 ='D' 20107 ='D' 20109 ='D' 20111 ='D' 20113 ='D' 20115
                      ='D' 20117 ='D' 20119 ='D' 20121 ='B' 20123 ='D' 20125 ='D' 20127 ='D'
                      20129 ='D' 20131 ='D' 20133 ='D' 20135 ='D' 20137 ='D' 20139 ='D' 20141
                      ='D' 20143 ='D' 20145 ='D' 20147 ='D' 20149 ='D' 20151 ='D' 20153 ='D'
                      20155 ='D' 20157 ='D' 20159 ='D' 20161 ='D' 20163 ='D' 20165 ='D' 20167
                      ='D' 20169 ='D' 20171 ='D' 20173 ='C' 20175 ='D' 20177 ='C' 20179 ='D'
                      20181 ='D' 20183 ='D' 20185 ='D' 20187 ='D' 20189 ='D' 20191 ='D' 20193
                      ='D' 20195 ='D' 20197 ='D' 20199 ='D' 20201 ='D' 20203 ='D' 20205 ='D'
                      20207 ='D' 20209 ='B' 21001 ='D' 21003 ='D' 21005 ='D' 21007 ='D' 21009
                      ='D' 21011 ='D' 21013 ='D' 21015 ='B' 21017 ='D' 21019 ='C' 21021 ='C'
                      21023 ='D' 21025 ='D' 21027 ='D' 21029 ='B' 21031 ='D' 21033 ='D' 21035
                      ='D' 21037 ='B' 21039 ='D' 21041 ='D' 21043 ='D' 21045 ='D' 21047 ='D'
                      21049 ='C' 21051 ='D' 21053 ='D' 21055 ='D' 21057 ='D' 21059 ='C' 21061
                      ='D' 21063 ='D' 21065 ='D' 21067 ='C' 21069 ='D' 21071 ='D' 21073 ='C'
                      21075 ='D' 21077 ='B' 21079 ='D' 21081 ='B' 21083 ='D' 21085 ='D' 21087
                      ='D' 21089 ='C' 21091 ='D' 21093 ='C' 21095 ='D' 21097 ='D' 21099 ='D'
                      21101 ='C' 21103 ='D' 21105 ='D' 21107 ='D' 21109 ='D' 21111 ='B' 21113
                      ='C' 21115 ='D' 21117 ='B' 21119 ='D' 21121 ='D' 21123 ='D' 21125 ='C'
                      21127 ='D' 21129 ='D' 21131 ='D' 21133 ='D' 21135 ='D' 21137 ='D' 21139
                      ='D' 21141 ='D' 21143 ='D' 21145 ='C' 21147 ='D' 21149 ='D' 21151 ='C'
                      21153 ='D' 21155 ='D' 21157 ='C' 21159 ='D' 21161 ='D' 21163 ='D' 21165
                      ='D' 21167 ='D' 21169 ='D' 21171 ='D' 21173 ='C' 21175 ='D' 21177 ='D'
                      21179 ='D' 21181 ='D' 21183 ='D' 21185 ='B' 21187 ='D' 21189 ='D' 21191
                      ='B' 21193 ='D' 21195 ='D' 21197 ='D' 21199 ='D' 21201 ='D' 21203 ='D'
                      21205 ='D' 21207 ='D' 21209 ='D' 21211 ='D' 21213 ='D' 21215 ='D' 21217
                      ='D' 21219 ='D' 21221 ='D' 21223 ='D' 21225 ='D' 21227 ='C' 21229 ='D'
                      21231 ='D' 21233 ='D' 21235 ='D' 21237 ='D' 21239 ='C' 22001 ='D' 22003
                      ='D' 22005 ='B' 22007 ='D' 22009 ='D' 22011 ='D' 22013 ='D' 22015 ='C'
                      22017 ='C' 22019 ='C' 22021 ='D' 22023 ='D' 22025 ='D' 22027 ='D' 22029
                      ='D' 22031 ='D' 22033 ='B' 22035 ='D' 22037 ='D' 22039 ='D' 22041 ='D'
                      22043 ='D' 22045 ='C' 22047 ='D' 22049 ='D' 22051 ='B' 22053 ='D' 22055
                      ='C' 22057 ='C' 22059 ='D' 22061 ='D' 22063 ='B' 22065 ='D' 22067 ='D'
                      22069 ='D' 22071 ='B' 22073 ='C' 22075 ='B' 22077 ='D' 22079 ='D' 22081
                      ='D' 22083 ='D' 22085 ='D' 22087 ='B' 22089 ='B' 22091 ='D' 22093 ='B'
                      22095 ='B' 22097 ='D' 22099 ='D' 22101 ='C' 22103 ='B' 22105 ='C' 22107
                      ='D' 22109 ='C' 22111 ='D' 22113 ='D' 22115 ='D' 22117 ='D' 22119 ='D'
                      22121 ='B' 22123 ='D' 22125 ='D' 22127 ='D' 23001 ='C' 23003 ='D' 23005
                      ='C' 23007 ='D' 23009 ='D' 23011 ='C' 23013 ='C' 23015 ='C' 23017 ='D'
                      23019 ='D' 23021 ='D' 23023 ='C' 23025 ='D' 23027 ='D' 23029 ='D' 23031
                      ='C' 24001 ='C' 24003 ='A' 24005 ='A' 24009 ='A' 24011 ='D' 24013 ='A'
                      24015 ='A' 24017 ='A' 24019 ='D' 24021 ='A' 24023 ='D' 24025 ='A' 24027
                      ='A' 24029 ='D' 24031 ='A' 24033 ='A' 24035 ='A' 24037 ='C' 24039 ='D'
                      24041 ='C' 24043 ='A' 24045 ='C' 24047 ='C' 24510 ='A' 25001 ='C' 25003
                      ='C' 25005 ='C' 25007 ='C' 25009 ='C' 25011 ='C' 25013 ='C' 25015 ='C'
                      25017 ='C' 25019 ='C' 25021 ='C' 25023 ='C' 25025 ='C' 25027 ='C' 26001
                      ='D' 26003 ='D' 26005 ='B' 26007 ='D' 26009 ='D' 26011 ='D' 26013 ='D'
                      26015 ='D' 26017 ='C' 26019 ='D' 26021 ='C' 26023 ='D' 26025 ='C' 26027
                      ='C' 26029 ='D' 26031 ='D' 26033 ='D' 26035 ='D' 26037 ='C' 26039 ='D'
                      26041 ='D' 26043 ='D' 26045 ='C' 26047 ='D' 26049 ='A' 26051 ='D' 26053
                      ='D' 26055 ='C' 26057 ='D' 26059 ='D' 26061 ='D' 26063 ='D' 26065 ='C'
                      26067 ='D' 26069 ='D' 26071 ='D' 26073 ='C' 26075 ='C' 26077 ='C' 26079
                      ='D' 26081 ='B' 26083 ='D' 26085 ='D' 26087 ='A' 26089 ='D' 26091 ='A'
                      26093 ='A' 26095 ='D' 26097 ='D' 26099 ='A' 26101 ='D' 26103 ='D' 26105
                      ='D' 26107 ='D' 26109 ='D' 26111 ='C' 26113 ='D' 26115 ='A' 26117 ='D'
                      26119 ='D' 26121 ='B' 26123 ='D' 26125 ='A' 26127 ='D' 26129 ='D' 26131
                      ='D' 26133 ='D' 26135 ='D' 26137 ='D' 26139 ='B' 26141 ='D' 26143 ='D'
                      26145 ='C' 26147 ='A' 26149 ='C' 26151 ='D' 26153 ='D' 26155 ='C' 26157
                      ='D' 26159 ='C' 26161 ='A' 26163 ='A' 26165 ='D' 27001 ='D' 27003 ='A'
                      27005 ='D' 27007 ='D' 27009 ='D' 27011 ='D' 27013 ='D' 27015 ='D' 27017
                      ='D' 27019 ='A' 27021 ='D' 27023 ='D' 27025 ='A' 27027 ='D' 27029 ='D'
                      27031 ='D' 27033 ='D' 27035 ='D' 27037 ='A' 27039 ='D' 27041 ='D' 27043
                      ='D' 27045 ='D' 27047 ='D' 27049 ='D' 27051 ='D' 27053 ='A' 27055 ='D'
                      27057 ='D' 27059 ='A' 27061 ='D' 27063 ='D' 27065 ='D' 27067 ='D' 27069
                      ='D' 27071 ='D' 27073 ='D' 27075 ='D' 27077 ='D' 27079 ='D' 27081 ='D'
                      27083 ='D' 27085 ='D' 27087 ='D' 27089 ='D' 27091 ='D' 27093 ='D' 27095
                      ='D' 27097 ='D' 27099 ='D' 27101 ='D' 27103 ='D' 27105 ='D' 27107 ='D'
                      27109 ='C' 27111 ='D' 27113 ='D' 27115 ='D' 27117 ='D' 27119 ='D' 27121
                      ='D' 27123 ='A' 27125 ='D' 27127 ='D' 27129 ='D' 27131 ='D' 27133 ='D'
                      27135 ='D' 27137 ='D' 27139 ='A' 27141 ='A' 27143 ='D' 27145 ='D' 27147
                      ='D' 27149 ='D' 27151 ='D' 27153 ='D' 27155 ='D' 27157 ='D' 27159 ='D'
                      27161 ='D' 27163 ='A' 27165 ='D' 27167 ='D' 27169 ='D' 27171 ='A' 27173
                      ='D' 28001 ='D' 28003 ='D' 28005 ='D' 28007 ='D' 28009 ='D' 28011 ='D'
                      28013 ='D' 28015 ='D' 28017 ='D' 28019 ='D' 28021 ='D' 28023 ='D' 28025
                      ='D' 28027 ='D' 28029 ='D' 28031 ='D' 28033 ='B' 28035 ='C' 28037 ='D'
                      28039 ='D' 28041 ='D' 28043 ='D' 28045 ='C' 28047 ='C' 28049 ='C' 28051
                      ='D' 28053 ='D' 28055 ='D' 28057 ='D' 28059 ='C' 28061 ='D' 28063 ='D'
                      28065 ='D' 28067 ='D' 28069 ='D' 28071 ='D' 28073 ='D' 28075 ='D' 28077
                      ='D' 28079 ='D' 28081 ='C' 28083 ='D' 28085 ='D' 28087 ='C' 28089 ='D'
                      28091 ='D' 28093 ='D' 28095 ='D' 28097 ='D' 28099 ='D' 28101 ='D' 28103
                      ='D' 28105 ='D' 28107 ='D' 28109 ='D' 28111 ='D' 28113 ='D' 28115 ='D'
                      28117 ='D' 28119 ='D' 28121 ='C' 28123 ='D' 28125 ='D' 28127 ='D' 28129
                      ='D' 28131 ='D' 28133 ='D' 28135 ='D' 28137 ='D' 28139 ='D' 28141 ='D'
                      28143 ='D' 28145 ='D' 28147 ='D' 28149 ='D' 28151 ='D' 28153 ='D' 28155
                      ='D' 28157 ='D' 28159 ='D' 28161 ='D' 28163 ='D' 29001 ='D' 29003 ='D'
                      29005 ='D' 29007 ='D' 29009 ='D' 29011 ='D' 29013 ='D' 29015 ='D' 29017
                      ='D' 29019 ='C' 29021 ='C' 29023 ='D' 29025 ='D' 29027 ='D' 29029 ='C'
                      29031 ='C' 29033 ='D' 29035 ='D' 29037 ='B' 29039 ='D' 29041 ='D' 29043
                      ='D' 29045 ='D' 29047 ='B' 29049 ='B' 29051 ='C' 29053 ='D' 29055 ='A'
                      29057 ='D' 29059 ='D' 29061 ='D' 29063 ='D' 29065 ='D' 29067 ='D' 29069
                      ='D' 29071 ='A' 29073 ='D' 29075 ='D' 29077 ='C' 29079 ='D' 29081 ='D'
                      29083 ='D' 29085 ='D' 29087 ='D' 29089 ='D' 29091 ='D' 29093 ='D' 29095
                      ='B' 29097 ='C' 29099 ='A' 29101 ='D' 29103 ='D' 29105 ='D' 29107 ='B'
                      29109 ='D' 29111 ='D' 29113 ='A' 29115 ='D' 29117 ='D' 29119 ='D' 29121
                      ='D' 29123 ='D' 29125 ='D' 29127 ='D' 29129 ='D' 29131 ='D' 29133 ='D'
                      29135 ='D' 29137 ='D' 29139 ='D' 29141 ='D' 29143 ='D' 29145 ='D' 29147
                      ='D' 29149 ='D' 29151 ='D' 29153 ='D' 29155 ='D' 29157 ='D' 29159 ='D'
                      29161 ='D' 29163 ='D' 29165 ='B' 29167 ='D' 29169 ='D' 29171 ='D' 29173
                      ='D' 29175 ='D' 29177 ='B' 29179 ='D' 29181 ='D' 29183 ='A' 29185 ='D'
                      29186 ='D' 29187 ='C' 29189 ='A' 29195 ='D' 29197 ='D' 29199 ='D' 29201
                      ='D' 29203 ='D' 29205 ='D' 29207 ='D' 29209 ='D' 29211 ='D' 29213 ='D'
                      29215 ='D' 29217 ='D' 29219 ='A' 29221 ='D' 29223 ='D' 29225 ='D' 29227
                      ='D' 29229 ='D' 29510 ='A' 30001 ='D' 30003 ='D' 30005 ='D' 30007 ='D'
                      30009 ='D' 30011 ='D' 30013 ='D' 30015 ='D' 30017 ='D' 30019 ='D' 30021
                      ='D' 30023 ='D' 30025 ='D' 30027 ='D' 30029 ='D' 30031 ='D' 30033 ='D'
                      30035 ='D' 30037 ='D' 30039 ='D' 30041 ='D' 30043 ='D' 30045 ='D' 30047
                      ='D' 30049 ='D' 30051 ='D' 30053 ='D' 30055 ='D' 30057 ='D' 30059 ='D'
                      30061 ='D' 30063 ='D' 30065 ='D' 30067 ='D' 30069 ='D' 30071 ='D' 30073
                      ='D' 30075 ='D' 30077 ='D' 30079 ='D' 30081 ='D' 30083 ='D' 30085 ='D'
                      30087 ='D' 30089 ='D' 30091 ='D' 30093 ='D' 30095 ='D' 30097 ='D' 30099
                      ='D' 30101 ='D' 30103 ='D' 30105 ='D' 30107 ='D' 30109 ='D' 30111 ='D'
                      31001 ='D' 31003 ='D' 31005 ='D' 31007 ='D' 31009 ='D' 31011 ='D' 31013
                      ='D' 31015 ='D' 31017 ='D' 31019 ='D' 31021 ='D' 31023 ='D' 31025 ='B'
                      31027 ='D' 31029 ='D' 31031 ='D' 31033 ='D' 31035 ='D' 31037 ='D' 31039
                      ='D' 31041 ='D' 31043 ='D' 31045 ='D' 31047 ='D' 31049 ='D' 31051 ='D'
                      31053 ='D' 31055 ='B' 31057 ='D' 31059 ='D' 31061 ='D' 31063 ='D' 31065
                      ='D' 31067 ='D' 31069 ='D' 31071 ='D' 31073 ='D' 31075 ='D' 31077 ='D'
                      31079 ='D' 31081 ='D' 31083 ='D' 31085 ='D' 31087 ='D' 31089 ='D' 31091
                      ='D' 31093 ='D' 31095 ='D' 31097 ='D' 31099 ='D' 31101 ='D' 31103 ='D'
                      31105 ='D' 31107 ='D' 31109 ='C' 31111 ='D' 31113 ='D' 31115 ='D' 31117
                      ='D' 31119 ='D' 31121 ='D' 31123 ='D' 31125 ='D' 31127 ='D' 31129 ='D'
                      31131 ='D' 31133 ='D' 31135 ='D' 31137 ='D' 31139 ='D' 31141 ='D' 31143
                      ='D' 31145 ='D' 31147 ='D' 31149 ='D' 31151 ='D' 31153 ='B' 31155 ='D'
                      31157 ='D' 31159 ='D' 31161 ='D' 31163 ='D' 31165 ='D' 31167 ='D' 31169
                      ='D' 31171 ='D' 31173 ='D' 31175 ='D' 31177 ='B' 31179 ='D' 31181 ='D'
                      31183 ='D' 31185 ='D' 32001 ='D' 32003 ='B' 32005 ='D' 32007 ='D' 32009
                      ='D' 32011 ='D' 32013 ='D' 32015 ='D' 32017 ='D' 32019 ='D' 32021 ='D'
                      32023 ='B' 32027 ='D' 32029 ='D' 32031 ='C' 32033 ='D' 32510 ='C' 33001
                      ='C' 33003 ='D' 33005 ='C' 33007 ='D' 33009 ='D' 33011 ='C' 33013 ='C'
                      33015 ='C' 33017 ='C' 33019 ='D' 34001 ='A' 34003 ='A' 34005 ='A' 34007
                      ='A' 34009 ='A' 34011 ='A' 34013 ='A' 34015 ='A' 34017 ='A' 34019 ='A'
                      34021 ='A' 34023 ='A' 34025 ='A' 34027 ='A' 34029 ='A' 34031 ='A' 34033
                      ='A' 34035 ='A' 34037 ='A' 34039 ='A' 34041 ='A' 35001 ='B' 35003 ='D'
                      35005 ='D' 35006 ='D' 35007 ='D' 35009 ='D' 35011 ='D' 35013 ='D' 35015
                      ='D' 35017 ='D' 35019 ='D' 35021 ='D' 35023 ='D' 35025 ='D' 35027 ='D'
                      35028 ='D' 35029 ='D' 35031 ='D' 35033 ='D' 35035 ='D' 35037 ='D' 35039
                      ='D' 35041 ='D' 35043 ='B' 35045 ='D' 35047 ='D' 35049 ='D' 35051 ='D'
                      35053 ='D' 35055 ='D' 35057 ='D' 35059 ='D' 35061 ='B' 36001 ='B' 36003
                      ='D' 36005 ='A' 36007 ='C' 36009 ='D' 36011 ='B' 36013 ='C' 36015 ='C'
                      36017 ='D' 36019 ='D' 36021 ='C' 36023 ='D' 36025 ='D' 36027 ='A' 36029
                      ='B' 36031 ='D' 36033 ='D' 36035 ='C' 36037 ='B' 36039 ='D' 36041 ='D'
                      36043 ='D' 36045 ='D' 36047 ='A' 36049 ='D' 36051 ='B' 36053 ='B' 36055
                      ='B' 36057 ='B' 36059 ='A' 36061 ='A' 36063 ='B' 36065 ='C' 36067 ='B'
                      36069 ='B' 36071 ='A' 36073 ='B' 36075 ='B' 36077 ='D' 36079 ='A' 36081
                      ='A' 36083 ='B' 36085 ='A' 36087 ='A' 36089 ='D' 36091 ='B' 36093 ='B'
                      36095 ='B' 36097 ='D' 36099 ='C' 36101 ='D' 36103 ='A' 36105 ='D' 36107
                      ='D' 36109 ='C' 36111 ='C' 36113 ='D' 36115 ='D' 36117 ='B' 36119 ='A'
                      36121 ='D' 36123 ='D' 37001 ='B' 37003 ='C' 37005 ='D' 37007 ='D' 37009
                      ='D' 37011 ='C' 37013 ='D' 37015 ='D' 37017 ='D' 37019 ='C' 37021 ='C'
                      37023 ='C' 37025 ='B' 37027 ='C' 37029 ='D' 37031 ='C' 37033 ='D' 37035
                      ='C' 37037 ='B' 37039 ='D' 37041 ='D' 37043 ='D' 37045 ='C' 37047 ='D'
                      37049 ='C' 37051 ='C' 37053 ='B' 37055 ='C' 37057 ='B' 37059 ='B' 37061
                      ='D' 37063 ='B' 37065 ='C' 37067 ='B' 37069 ='B' 37071 ='B' 37073 ='D'
                      37075 ='D' 37077 ='D' 37079 ='D' 37081 ='B' 37083 ='D' 37085 ='C' 37087
                      ='C' 37089 ='C' 37091 ='D' 37093 ='C' 37095 ='D' 37097 ='C' 37099 ='D'
                      37101 ='B' 37103 ='D' 37105 ='C' 37107 ='C' 37109 ='B' 37111 ='D' 37113
                      ='D' 37115 ='D' 37117 ='D' 37119 ='B' 37121 ='D' 37123 ='D' 37125 ='C'
                      37127 ='C' 37129 ='C' 37131 ='D' 37133 ='C' 37135 ='B' 37137 ='D' 37139
                      ='C' 37141 ='D' 37143 ='D' 37145 ='D' 37147 ='C' 37149 ='D' 37151 ='B'
                      37153 ='D' 37155 ='C' 37157 ='C' 37159 ='B' 37161 ='C' 37163 ='D' 37165
                      ='C' 37167 ='C' 37169 ='B' 37171 ='C' 37173 ='D' 37175 ='D' 37177 ='D'
                      37179 ='B' 37181 ='C' 37183 ='B' 37185 ='D' 37187 ='D' 37189 ='C' 37191
                      ='C' 37193 ='D' 37195 ='C' 37197 ='B' 37199 ='D' 38001 ='D' 38003 ='D'
                      38005 ='D' 38007 ='D' 38009 ='D' 38011 ='D' 38013 ='D' 38015 ='D' 38017
                      ='D' 38019 ='D' 38021 ='D' 38023 ='D' 38025 ='D' 38027 ='D' 38029 ='D'
                      38031 ='D' 38033 ='D' 38035 ='D' 38037 ='D' 38039 ='D' 38041 ='D' 38043
                      ='D' 38045 ='D' 38047 ='D' 38049 ='D' 38051 ='D' 38053 ='D' 38055 ='D'
                      38057 ='D' 38059 ='D' 38061 ='D' 38063 ='D' 38065 ='D' 38067 ='D' 38069
                      ='D' 38071 ='D' 38073 ='D' 38075 ='D' 38077 ='D' 38079 ='D' 38081 ='D'
                      38083 ='D' 38085 ='D' 38087 ='D' 38089 ='D' 38091 ='D' 38093 ='D' 38095
                      ='D' 38097 ='D' 38099 ='D' 38101 ='D' 38103 ='D' 38105 ='D' 39001 ='D'
                      39003 ='C' 39005 ='C' 39007 ='A' 39009 ='D' 39011 ='C' 39013 ='C' 39015
                      ='B' 39017 ='B' 39019 ='D' 39021 ='D' 39023 ='B' 39025 ='B' 39027 ='D'
                      39029 ='B' 39031 ='D' 39033 ='C' 39035 ='A' 39037 ='D' 39039 ='D' 39041
                      ='B' 39043 ='C' 39045 ='B' 39047 ='D' 39049 ='B' 39051 ='B' 39053 ='D'
                      39055 ='A' 39057 ='B' 39059 ='D' 39061 ='B' 39063 ='C' 39065 ='D' 39067
                      ='D' 39069 ='D' 39071 ='D' 39073 ='D' 39075 ='D' 39077 ='D' 39079 ='D'
                      39081 ='C' 39083 ='D' 39085 ='A' 39087 ='C' 39089 ='B' 39091 ='D' 39093
                      ='A' 39095 ='B' 39097 ='B' 39099 ='B' 39101 ='C' 39103 ='A' 39105 ='D'
                      39107 ='D' 39109 ='B' 39111 ='D' 39113 ='B' 39115 ='D' 39117 ='D' 39119
                      ='C' 39121 ='D' 39123 ='C' 39125 ='D' 39127 ='D' 39129 ='B' 39131 ='D'
                      39133 ='A' 39135 ='D' 39137 ='D' 39139 ='C' 39141 ='D' 39143 ='C' 39145
                      ='C' 39147 ='D' 39149 ='C' 39151 ='C' 39153 ='A' 39155 ='B' 39157 ='C'
                      39159 ='D' 39161 ='D' 39163 ='D' 39165 ='B' 39167 ='D' 39169 ='C' 39171
                      ='D' 39173 ='B' 39175 ='D' 40001 ='D' 40003 ='D' 40005 ='D' 40007 ='D'
                      40009 ='D' 40011 ='D' 40013 ='D' 40015 ='D' 40017 ='B' 40019 ='D' 40021
                      ='D' 40023 ='D' 40025 ='D' 40027 ='B' 40029 ='D' 40031 ='D' 40033 ='D'
                      40035 ='D' 40037 ='B' 40039 ='D' 40041 ='D' 40043 ='D' 40045 ='D' 40047
                      ='D' 40049 ='D' 40051 ='D' 40053 ='D' 40055 ='D' 40057 ='D' 40059 ='D'
                      40061 ='D' 40063 ='D' 40065 ='D' 40067 ='D' 40069 ='D' 40071 ='D' 40073
                      ='D' 40075 ='D' 40077 ='D' 40079 ='D' 40081 ='D' 40083 ='B' 40085 ='D'
                      40087 ='B' 40089 ='D' 40091 ='D' 40093 ='D' 40095 ='D' 40097 ='D' 40099
                      ='D' 40101 ='D' 40103 ='D' 40105 ='D' 40107 ='D' 40109 ='B' 40111 ='D'
                      40113 ='B' 40115 ='D' 40117 ='D' 40119 ='D' 40121 ='D' 40123 ='D' 40125
                      ='B' 40127 ='D' 40129 ='D' 40131 ='B' 40133 ='D' 40135 ='D' 40137 ='D'
                      40139 ='D' 40141 ='D' 40143 ='B' 40145 ='B' 40147 ='D' 40149 ='D' 40151
                      ='D' 40153 ='D' 41001 ='D' 41003 ='D' 41005 ='B' 41007 ='D' 41009 ='B'
2                                        The WPS System      10:48 Wednesday, July 29, 2015     

                      41011 ='D' 41013 ='D' 41015 ='D' 41017 ='C' 41019 ='D' 41021 ='D' 41023
                      ='D' 41025 ='D' 41027 ='D' 41029 ='D' 41031 ='D' 41033 ='D' 41035 ='D'
                      41037 ='D' 41039 ='C' 41041 ='D' 41043 ='D' 41045 ='D' 41047 ='B' 41049
                      ='D' 41051 ='B' 41053 ='B' 41055 ='D' 41057 ='D' 41059 ='D' 41061 ='D'
                      41063 ='D' 41065 ='D' 41067 ='B' 41069 ='D' 41071 ='B' 42001 ='C' 42003
                      ='A' 42005 ='C' 42007 ='A' 42009 ='D' 42011 ='C' 42013 ='C' 42015 ='D'
                      42017 ='A' 42019 ='A' 42021 ='C' 42023 ='D' 42025 ='B' 42027 ='C' 42029
                      ='A' 42031 ='D' 42033 ='D' 42035 ='D' 42037 ='B' 42039 ='D' 42041 ='B'
                      42043 ='B' 42045 ='A' 42047 ='D' 42049 ='C' 42051 ='A' 42053 ='D' 42055
                      ='C' 42057 ='D' 42059 ='D' 42061 ='D' 42063 ='C' 42065 ='D' 42067 ='D'
                      42069 ='B' 42071 ='C' 42073 ='C' 42075 ='B' 42077 ='B' 42079 ='B' 42081
                      ='C' 42083 ='D' 42085 ='C' 42087 ='C' 42089 ='C' 42091 ='A' 42093 ='C'
                      42095 ='B' 42097 ='C' 42099 ='B' 42101 ='A' 42103 ='A' 42105 ='D' 42107
                      ='C' 42109 ='C' 42111 ='D' 42113 ='D' 42115 ='D' 42117 ='D' 42119 ='C'
                      42121 ='D' 42123 ='D' 42125 ='A' 42127 ='D' 42129 ='A' 42131 ='B' 42133
                      ='C' 44001 ='C' 44003 ='C' 44005 ='C' 44007 ='C' 44009 ='C' 45001 ='D'
                      45003 ='C' 45005 ='D' 45007 ='B' 45009 ='D' 45011 ='D' 45013 ='C' 45015
                      ='B' 45017 ='D' 45019 ='B' 45021 ='B' 45023 ='D' 45025 ='D' 45027 ='D'
                      45029 ='D' 45031 ='C' 45033 ='D' 45035 ='B' 45037 ='D' 45039 ='D' 45041
                      ='C' 45043 ='D' 45045 ='B' 45047 ='C' 45049 ='D' 45051 ='C' 45053 ='D'
                      45055 ='D' 45057 ='D' 45059 ='C' 45061 ='D' 45063 ='B' 45065 ='D' 45067
                      ='D' 45069 ='D' 45071 ='D' 45073 ='C' 45075 ='D' 45077 ='B' 45079 ='B'
                      45081 ='D' 45083 ='B' 45085 ='C' 45087 ='D' 45089 ='D' 45091 ='B' 46003
                      ='D' 46005 ='D' 46007 ='D' 46009 ='D' 46011 ='D' 46013 ='D' 46015 ='D'
                      46017 ='D' 46019 ='D' 46021 ='D' 46023 ='D' 46025 ='D' 46027 ='D' 46029
                      ='D' 46031 ='D' 46033 ='D' 46035 ='D' 46037 ='D' 46039 ='D' 46041 ='D'
                      46043 ='D' 46045 ='D' 46047 ='D' 46049 ='D' 46051 ='D' 46053 ='D' 46055
                      ='D' 46057 ='D' 46059 ='D' 46061 ='D' 46063 ='D' 46065 ='D' 46067 ='D'
                      46069 ='D' 46071 ='D' 46073 ='D' 46075 ='D' 46077 ='D' 46079 ='D' 46081
                      ='D' 46083 ='D' 46085 ='D' 46087 ='D' 46089 ='D' 46091 ='D' 46093 ='D'
                      46095 ='D' 46097 ='D' 46099 ='C' 46101 ='D' 46103 ='D' 46105 ='D' 46107
                      ='D' 46109 ='D' 46111 ='D' 46113 ='D' 46115 ='D' 46117 ='D' 46119 ='D'
                      46121 ='D' 46123 ='D' 46125 ='D' 46127 ='D' 46129 ='D' 46135 ='D' 46137
                      ='D' 47001 ='B' 47003 ='D' 47005 ='D' 47007 ='D' 47009 ='B' 47011 ='C'
                      47013 ='D' 47015 ='D' 47017 ='D' 47019 ='C' 47021 ='B' 47023 ='D' 47025
                      ='D' 47027 ='D' 47029 ='D' 47031 ='C' 47033 ='D' 47035 ='D' 47037 ='B'
                      47039 ='D' 47041 ='D' 47043 ='B' 47045 ='D' 47047 ='B' 47049 ='D' 47051
                      ='D' 47053 ='D' 47055 ='D' 47057 ='D' 47059 ='C' 47061 ='D' 47063 ='C'
                      47065 ='C' 47067 ='D' 47069 ='D' 47071 ='D' 47073 ='C' 47075 ='D' 47077
                      ='D' 47079 ='D' 47081 ='D' 47083 ='D' 47085 ='D' 47087 ='D' 47089 ='C'
                      47091 ='D' 47093 ='B' 47095 ='D' 47097 ='D' 47099 ='D' 47101 ='D' 47103
                      ='D' 47105 ='B' 47107 ='C' 47109 ='D' 47111 ='D' 47113 ='C' 47115 ='D'
                      47117 ='D' 47119 ='D' 47121 ='D' 47123 ='D' 47125 ='C' 47127 ='D' 47129
                      ='D' 47131 ='D' 47133 ='D' 47135 ='D' 47137 ='D' 47139 ='D' 47141 ='C'
                      47143 ='D' 47145 ='C' 47147 ='B' 47149 ='B' 47151 ='D' 47153 ='D' 47155
                      ='B' 47157 ='B' 47159 ='D' 47161 ='D' 47163 ='C' 47165 ='B' 47167 ='B'
                      47169 ='D' 47171 ='D' 47173 ='B' 47175 ='D' 47177 ='D' 47179 ='C' 47181
                      ='D' 47183 ='D' 47185 ='D' 47187 ='B' 47189 ='B' 48001 ='D' 48003 ='D'
                      48005 ='D' 48007 ='C' 48009 ='D' 48011 ='D' 48013 ='D' 48015 ='D' 48017
                      ='D' 48019 ='D' 48021 ='B' 48023 ='D' 48025 ='D' 48027 ='C' 48029 ='B'
                      48031 ='D' 48033 ='D' 48035 ='D' 48037 ='D' 48039 ='A' 48041 ='C' 48043
                      ='D' 48045 ='D' 48047 ='D' 48049 ='D' 48051 ='D' 48053 ='D' 48055 ='B'
                      48057 ='D' 48059 ='D' 48061 ='C' 48063 ='D' 48065 ='D' 48067 ='D' 48069
                      ='D' 48071 ='A' 48073 ='D' 48075 ='D' 48077 ='D' 48079 ='D' 48081 ='D'
                      48083 ='D' 48085 ='A' 48087 ='D' 48089 ='D' 48091 ='B' 48093 ='D' 48095
                      ='D' 48097 ='D' 48099 ='D' 48101 ='D' 48103 ='D' 48105 ='D' 48107 ='D'
                      48109 ='D' 48111 ='D' 48113 ='A' 48115 ='D' 48117 ='D' 48119 ='D' 48121
                      ='A' 48123 ='D' 48125 ='D' 48127 ='D' 48129 ='D' 48131 ='D' 48133 ='D'
                      48135 ='C' 48137 ='D' 48139 ='A' 48141 ='B' 48143 ='D' 48145 ='D' 48147
                      ='D' 48149 ='D' 48151 ='D' 48153 ='D' 48155 ='D' 48157 ='A' 48159 ='D'
                      48161 ='D' 48163 ='D' 48165 ='D' 48167 ='A' 48169 ='D' 48171 ='D' 48173
                      ='D' 48175 ='D' 48177 ='D' 48179 ='D' 48181 ='C' 48183 ='C' 48185 ='D'
                      48187 ='B' 48189 ='D' 48191 ='D' 48193 ='D' 48195 ='D' 48197 ='D' 48199
                      ='D' 48201 ='A' 48203 ='D' 48205 ='D' 48207 ='D' 48209 ='B' 48211 ='D'
                      48213 ='A' 48215 ='C' 48217 ='D' 48219 ='D' 48221 ='A' 48223 ='D' 48225
                      ='D' 48227 ='D' 48229 ='D' 48231 ='A' 48233 ='D' 48235 ='D' 48237 ='D'
                      48239 ='D' 48241 ='D' 48243 ='D' 48245 ='C' 48247 ='D' 48249 ='D' 48251
                      ='A' 48253 ='D' 48255 ='D' 48257 ='A' 48259 ='D' 48261 ='D' 48263 ='D'
                      48265 ='D' 48267 ='D' 48269 ='D' 48271 ='D' 48273 ='C' 48275 ='D' 48277
                      ='D' 48279 ='D' 48281 ='D' 48283 ='D' 48285 ='D' 48287 ='D' 48289 ='D'
                      48291 ='A' 48293 ='D' 48295 ='D' 48297 ='D' 48299 ='D' 48301 ='D' 48303
                      ='C' 48305 ='D' 48307 ='D' 48309 ='C' 48311 ='D' 48313 ='D' 48315 ='D'
                      48317 ='D' 48319 ='D' 48321 ='D' 48323 ='C' 48325 ='D' 48327 ='D' 48329
                      ='C' 48331 ='D' 48333 ='D' 48335 ='D' 48337 ='D' 48339 ='A' 48341 ='D'
                      48343 ='D' 48345 ='D' 48347 ='D' 48349 ='D' 48351 ='D' 48353 ='D' 48355
                      ='C' 48357 ='D' 48359 ='D' 48361 ='C' 48363 ='D' 48365 ='D' 48367 ='A'
                      48369 ='D' 48371 ='D' 48373 ='D' 48375 ='C' 48377 ='D' 48379 ='D' 48381
                      ='C' 48383 ='D' 48385 ='D' 48387 ='D' 48389 ='D' 48391 ='D' 48393 ='D'
                      48395 ='D' 48397 ='A' 48399 ='D' 48401 ='D' 48403 ='D' 48405 ='D' 48407
                      ='D' 48409 ='D' 48411 ='D' 48413 ='D' 48415 ='D' 48417 ='D' 48419 ='D'
                      48421 ='D' 48423 ='C' 48425 ='D' 48427 ='D' 48429 ='D' 48431 ='D' 48433
                      ='D' 48435 ='D' 48437 ='D' 48439 ='A' 48441 ='D' 48443 ='D' 48445 ='D'
                      48447 ='D' 48449 ='D' 48451 ='D' 48453 ='B' 48455 ='D' 48457 ='D' 48459
                      ='D' 48461 ='D' 48463 ='D' 48465 ='D' 48467 ='D' 48469 ='D' 48471 ='D'
                      48473 ='A' 48475 ='D' 48477 ='D' 48479 ='C' 48481 ='D' 48483 ='D' 48485
                      ='C' 48487 ='D' 48489 ='D' 48491 ='B' 48493 ='B' 48495 ='D' 48497 ='D'
                      48499 ='D' 48501 ='D' 48503 ='D' 48505 ='D' 48507 ='D' 49001 ='D' 49003
                      ='D' 49005 ='D' 49007 ='D' 49009 ='D' 49011 ='B' 49013 ='D' 49015 ='D'
                      49017 ='D' 49019 ='D' 49021 ='D' 49023 ='D' 49025 ='D' 49027 ='D' 49029
                      ='D' 49031 ='D' 49033 ='D' 49035 ='B' 49037 ='D' 49039 ='D' 49041 ='D'
                      49043 ='D' 49045 ='D' 49047 ='D' 49049 ='C' 49051 ='D' 49053 ='D' 49055
                      ='D' 49057 ='B' 50001 ='D' 50003 ='D' 50005 ='D' 50007 ='C' 50009 ='D'
                      50011 ='D' 50013 ='C' 50015 ='D' 50017 ='D' 50019 ='D' 50021 ='D' 50023
                      ='D' 50025 ='D' 50027 ='D' 51001 ='D' 51003 ='C' 51005 ='C' 51007 ='D'
                      51009 ='D' 51011 ='D' 51013 ='A' 51015 ='D' 51017 ='D' 51019 ='D' 51021
                      ='D' 51023 ='D' 51025 ='D' 51027 ='D' 51029 ='D' 51031 ='D' 51033 ='D'
                      51035 ='D' 51036 ='B' 51037 ='D' 51041 ='B' 51043 ='A' 51045 ='D' 51047
                      ='A' 51049 ='D' 51051 ='D' 51053 ='B' 51057 ='D' 51059 ='A' 51061 ='A'
                      51063 ='D' 51065 ='D' 51067 ='D' 51069 ='C' 51071 ='D' 51073 ='B' 51075
                      ='B' 51077 ='D' 51079 ='D' 51081 ='D' 51083 ='D' 51085 ='B' 51087 ='B'
                      51089 ='C' 51091 ='D' 51093 ='B' 51095 ='B' 51097 ='D' 51099 ='A' 51101
                      ='D' 51103 ='C' 51105 ='D' 51107 ='A' 51109 ='D' 51111 ='D' 51113 ='D'
                      51115 ='B' 51117 ='D' 51119 ='D' 51121 ='C' 51125 ='D' 51127 ='B' 51131
                      ='D' 51133 ='D' 51135 ='D' 51137 ='D' 51139 ='D' 51141 ='D' 51143 ='D'
                      51145 ='B' 51147 ='D' 51149 ='B' 51153 ='A' 51155 ='C' 51157 ='D' 51159
                      ='D' 51161 ='C' 51163 ='D' 51165 ='D' 51167 ='D' 51169 ='D' 51171 ='D'
                      51173 ='D' 51175 ='D' 51177 ='A' 51179 ='A' 51181 ='D' 51183 ='D' 51185
                      ='D' 51187 ='A' 51191 ='D' 51193 ='D' 51195 ='D' 51197 ='D' 51199 ='B'
                      51510 ='A' 51520 ='C' 51530 ='C' 51540 ='C' 51550 ='B' 51570 ='B' 51580
                      ='D' 51590 ='C' 51600 ='A' 51610 ='A' 51620 ='C' 51630 ='A' 51640 ='C'
                      51650 ='B' 51660 ='C' 51670 ='B' 51678 ='D' 51680 ='C' 51683 ='A' 51685
                      ='A' 51690 ='C' 51700 ='B' 51710 ='B' 51720 ='C' 51730 ='B' 51735 ='B'
                      51740 ='B' 51750 ='C' 51760 ='B' 51770 ='C' 51775 ='C' 51790 ='C' 51800
                      ='B' 51810 ='B' 51820 ='C' 51830 ='B' 51840 ='C' 53001 ='D' 53003 ='D'
                      53005 ='C' 53007 ='D' 53009 ='D' 53011 ='B' 53013 ='D' 53015 ='C' 53017
                      ='D' 53019 ='D' 53021 ='D' 53023 ='D' 53025 ='D' 53027 ='D' 53029 ='A'
                      53031 ='D' 53033 ='A' 53035 ='A' 53037 ='D' 53039 ='D' 53041 ='D' 53043
                      ='D' 53045 ='D' 53047 ='D' 53049 ='D' 53051 ='D' 53053 ='A' 53055 ='C'
                      53057 ='D' 53059 ='D' 53061 ='A' 53063 ='C' 53065 ='D' 53067 ='A' 53069
                      ='D' 53071 ='D' 53073 ='C' 53075 ='D' 53077 ='D' 54001 ='D' 54003 ='A'
                      54005 ='D' 54007 ='D' 54009 ='C' 54011 ='C' 54013 ='D' 54015 ='D' 54017
                      ='D' 54019 ='D' 54021 ='D' 54023 ='D' 54025 ='D' 54027 ='D' 54029 ='C'
                      54031 ='D' 54033 ='C' 54035 ='D' 54037 ='A' 54039 ='C' 54041 ='D' 54043
                      ='D' 54045 ='D' 54047 ='D' 54049 ='C' 54051 ='C' 54053 ='D' 54055 ='C'
                      54057 ='D' 54059 ='D' 54061 ='C' 54063 ='D' 54065 ='D' 54067 ='D' 54069
                      ='C' 54071 ='D' 54073 ='D' 54075 ='D' 54077 ='D' 54079 ='C' 54081 ='C'
                      54083 ='D' 54085 ='D' 54087 ='D' 54089 ='D' 54091 ='D' 54093 ='D' 54095
                      ='D' 54097 ='D' 54099 ='C' 54101 ='D' 54103 ='D' 54105 ='D' 54107 ='C'
                      54109 ='D' 55001 ='D' 55003 ='D' 55005 ='D' 55007 ='D' 55009 ='C' 55011
                      ='D' 55013 ='D' 55015 ='D' 55017 ='D' 55019 ='D' 55021 ='D' 55023 ='D'
                      55025 ='C' 55027 ='D' 55029 ='D' 55031 ='D' 55033 ='D' 55035 ='C' 55037
                      ='D' 55039 ='C' 55041 ='D' 55043 ='D' 55045 ='D' 55047 ='D' 55049 ='D'
                      55051 ='D' 55053 ='D' 55055 ='C' 55057 ='D' 55059 ='A' 55061 ='D' 55063
                      ='C' 55065 ='D' 55067 ='D' 55069 ='D' 55071 ='C' 55073 ='D' 55075 ='D'
                      55077 ='D' 55078 ='D' 55079 ='B' 55081 ='D' 55083 ='D' 55085 ='D' 55087
                      ='C' 55089 ='B' 55091 ='D' 55093 ='A' 55095 ='D' 55097 ='D' 55099 ='D'
                      55101 ='B' 55103 ='D' 55105 ='C' 55107 ='D' 55109 ='A' 55111 ='D' 55113
                      ='D' 55115 ='D' 55117 ='C' 55119 ='D' 55121 ='D' 55123 ='D' 55125 ='D'
                      55127 ='C' 55129 ='D' 55131 ='B' 55133 ='B' 55135 ='D' 55137 ='D' 55139
                      ='C' 55141 ='D' 56001 ='D' 56003 ='D' 56005 ='D' 56007 ='D' 56009 ='D'
                      56011 ='D' 56013 ='D' 56015 ='D' 56017 ='D' 56019 ='D' 56021 ='D' 56023
                      ='D' 56025 ='D' 56027 ='D' 56029 ='D' 56031 ='D' 56033 ='D' 56035 ='D'
                      56037 ='D' 56039 ='D' 56041 ='D' 56043 ='D' 56045 ='D' 60050 ='D' 64003
                      ='D' 66010 ='D' 68020 ='D' 69010 ='D' 70030 ='D' 78010 ='D' 78020 ='D'
                      78030 ='D' other='Z';
NOTE: Format cdif is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  ***********************************;
MPRINT(AGGREGATION):  * THE PROC FORMAT FOR CACdirect 3.0;
MPRINT(AGGREGATION):  ***********************************;
MPRINT(AGGREGATION):  ***********************************;
MPRINT(AGGREGATION):  * STATUS;
MPRINT(AGGREGATION):  * ETECH ADDED MWM 4/13/2012;
MPRINT(AGGREGATION):  * MACTCHMAKER QC VARAIBLES ADDED JDS 4/23/2012
                      ***********************************;
NOTE: Procedure format step took :
      real time : 0.030
      cpu time  : 0.026


MPRINT(AGGREGATION):  proc format;
MPRINT(AGGREGATION):  value cac_le_a  .='Unknown - New to File'  0='No'  1='Yes' ;
NOTE: Format cac_le_a is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value cac_le_b  .='Unknown - New to File'  0='No'  1='Decrease' 
                      2='Increase' ;
NOTE: Format cac_le_b is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value $cac_le_c  ''='Unknown - New to File'  'newer home' = 'Newer Home' 
                      'older home' = 'Older Home' ;
NOTE: Format $cac_le_c is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value match  0='No'  1='Yes';
NOTE: Format match is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  ;
MPRINT(AGGREGATION):  value geo_match  1='Match @ Zip+2'  2='Match @ Zip'  3='Match @ State' ;
NOTE: Format geo_match is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value $cac_cdi  'A' = 'Top 20 MSAs, approx. 35% of US households'  'B' =
                      'Next 55 MSAs, approx. 21% of US households'  'C' = 'Counties with density
                      greater than 44 hh/mile'  'D' = 'Counties with density less than 44
                      hh/mile'  other='Unknown' ;
NOTE: Format $cac_cdi is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value prod_act  1='Production Active'  2='Supplemental Active' 
                      3='Inactive' ;
NOTE: Format prod_act is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value cac_act  0='Inactive'  1='Active' ;
NOTE: Format cac_act is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value cac_prod  0='Supplemental'  1='Production' ;
NOTE: Format cac_prod is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value cac_kids  0='No Children'  1='Children Present'   other='Unknown' ;
NOTE: Format cac_kids is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value cac_mar  1 = 'At Least 1 Married'  2 = 'At Least 1 Single'  3 =
                      'Both Married and single'  other='Unknown' ;
NOTE: Format cac_mar is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value cac_age  1 = '18-24 Years Old'  2 = '25-34 Years Old'  3 = '35-44
                      Years Old'  4 = '45-54 Years Old'  5 = '55-64 Years Old'  6 = '65-74 Years
                      Old'  7 = '75+ Years Old'  other = 'Unknown' ;
NOTE: Format cac_age is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value $cac_inc  '1'='$0 - $14,999'  '2'='$15,000 - $19,999'  '3'='$20,000
                      - $29,999'  '4'='$30,000 - $39,999'  '5'='$40,000 - $49,999'  '6'='$50,000
                      - $74,999'  '7'='$75,000 - $99,999'  '8'='$100,000 - $124,999'  '9'='$125,
                      000 - $149,999'  'A'='$150,000 - $174,999'  'B'='$175,000 - $199,999' 
                      'C'='$200,000 - $249,999'  'D'='$250,000 or More'  other='Unknown' ;
NOTE: Format $cac_inc is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value $cac_ninc '0'= '$0 - $14,999' '1'= '$15,000 - $19,999' '2'= '$20,000
                      - $24,999' '3'= '$25,000 - $29,999' '4'= '$30,000 - $34,999' '5'= '$35,000
                      - $39,999' '6'= '$40,000 - $44,999' '7'= '$45,000 - $49,999' '8'= '$50,000
                      - $54,999' '9'= '$55,000 - $59,999' 'A'= '$60,000 - $64,999' 'B'= '$65,000
                      - $69,999' 'C'= '$70,000 - $74,999' 'D'= '$75,000 - $79,999' 'E'= '$80,000
                      - $84,999' 'F'= '$85,000 - $89,999' 'G'= '$90,000 - $94,999' 'H'= '$95,000
                      - $99,999' 'I'= '$100,000 - $104,999' 'J'= '$105,000 - $109,999' 'K'=
                      '$110,000 - $114,999' 'L'= '$115,000 - $119,999' 'M'= '$120,000 - $124,
                      999' 'N'= '$125,000 - $129,999' 'O'= '$130,000 - $134,999' 'P'= '$135,000
                      - $139,999' 'Q'= '$140,000 - $144,999' 'R'= '$145,000 - $149,999' 'S'=
                      '$150,000 - $159,999' 'T'= '$160,000 - $169,999' 'U'= '$170,000 - $174,
                      999' 'V'= '$175,000 - $189,999' 'W'= '$190,000 - $199,999' 'X'= '$200,000
                      - $224,999' 'Y'= '$225,000 - $249,999' 'Z'= '$250,000 or More' other =
                      'Unknown' ;
NOTE: Format $cac_ninc is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value $silh_ld  'A' = 'Rough Beginnings'  'B' = 'Rustic Life'  'C' =
                      'Wheels of the City'  'D' = 'On Their Way'  'E' = 'All About Town'  'F' =
                      'Business Life'  'G' = 'Flying Solo'  'H' = 'White Picket Fence'  'I' =
                      'Down Home'  'J' = 'Good Times'  'K' = 'Privileged Providers'  'L' =
                      'County Seat'  'M' = 'Make it Somehow'  'N' = 'Power Players'  'O' =
                      'Securing the Nest'  'P' = 'Rocky Retirement'  'Q' = 'Golden Sunset' 
                      other = 'Unscored' ;
NOTE: Format $silh_ld is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value $silh_super  'A' = 'Rough Beginnings'  'B' = 'White Picket Fence' 
                      'C' = 'On Their Way'  'D' = 'Rustic Life'  'E' = 'Privileged Providers' 
                      'F' = 'Good Times'  'G' = 'Power Players'  'H' = 'Down Home'  'I' =
                      'Securing the Nest'  'J' = 'Make it Somehow'  'K' = 'Rocky Retirement' 
                      'L' = 'Golden Sunset'  other = 'Unscored' ;
NOTE: Format $silh_super is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value $silh 'A1'='Shes in the Now' 'A2'='Hes Starting Out' 'A3'='Shes
                      Still Here' 'A4'='Hes Still Here' 'A5'='Shes Left Behind' 'A6'='Hes
                      Settling In' 'B1'='Starting Out Families' 'B2'='Americana Families'
                      'B3'='Emerging Wealthy' 'B4'='Young Neighbors' 'C1'='Wall Street Dreaming'
                      'C2'='Execs on the Move' 'C3'='Successful Social Techies' 'C4'='The
                      Culturally Connected ' 'C5'='New Luxury' 'D1'='Outskirts ' 'D2'='Shes a
                      Little Bit Country' 'D3'='Country Gals' 'D4'='Growin up Country'
                      'D5'='NASCAR Country' 'E1'='Suburban Family' 'E2'='Suburban Bourgeoisie'
                      'E3'='Executive Families' 'E4'='Successful Providers' 'F1'='Midlife
                      Survivor' 'F2'='Alone in the City' 'F3'='Solo in Style' 'F4'='Emerging
                      Urban Executives' 'F5'='Cultural Singles' 'F6'='Comfortable Singles'
                      'F7'='The Intellectual' 'G1'='Downtown Success' 'G2'='Power Elite'
                      'G3'='Arrived' 'H1'='Rustic Families' 'H2'='Small Town Providers'
                      'H3'='Neighborly Families' 'H4'='Established Families' 'H5'='Cultured
                      Elite' 'I1'='Metro Couples' 'I2'='In The Now' 'I3'='Settling by the Fire'
                      'I4'='Metro Nesters' 'I5'='Rural Empty Nesters' 'J1'='Retiring Needy'
                      'J2'='Her Hometown' 'J3'='The Retiring' 'J4'='Simple Life Retirees'
                      'K1'='Hanging On' 'K2'='Rustic Retired' 'K3'='Settled In Seniors'
                      'K4'='Living Off the Land' 'L1'='The Cultural Estate' 'L2'='Settled in the
                      Suburbs' 'L3'='Settled in the Country' 'L4'='Social Seniors' 'L5'='Single
                      Seniors' 'L6'='Cultured Alone' 'XX'='Unscored' other='Unscored' ;
NOTE: Format $silh is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value pofaage  .,0='None Present or Not Available'  1='Male present' 
                      2='Female present'  3='Male and Female present'  4='Unknown Gender
                      present'  5='Male and Unknown Gender present'  6='Female and Unknown
                      Gender present'  7='Male, Female and Unknown Gender present' ;
NOTE: Format pofaage is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value pofaagi  0='Not Available'  1='Adult Present' ;
NOTE: Format pofaagi is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value cac_edu 0='Unknown' 1='Some high school or less' 2='High school'
                      3='Some college' 4='College' 5='Graduate school' ;
NOTE: Format cac_edu is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value cac_occ 0="Unknown/No Data" 1="Physician/Dentist" 2="Health Care"
                      3="Lawyers/Judges" 5="Professional/Technical" 6="Management" 7="Teacher
                      Educator" 8="Sales/Marketing" 9="Clerical/Service Worker"
                      10="Tradesman/Machine Oper / Laborer" 11="Farmer" 12="Student"
                      13="Homemaker" 14="Retired" 15="Federal Employee" 16="Federal Employee
                      Retired" 17="Military" 18="Military Retired" 19="Other" 20="Business
                      Owner" ;
NOTE: Format cac_occ is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value $etethnic "00" = "UNCODED" "01" = "ENGLISH" "02" = "SCOTTISH" "03" =
                      "DANISH" "04" = "SWEDISH" "05" = "NORWEGIAN" "06" = "FINNISH" "07" =
                      "ICELANDIC" "08" = "DUTCH" "09" = "BELGIAN" "10" = "GERMAN" "11" =
                      "AUSTRIAN" "12" = "HUNGARIAN" "13" = "CZECH" "14" = "SLOVAK" "15" =
                      "IRISH" "16" = "WELSH" "17" = "FRENCH" "18" = "SWISS" "19" = "ITALIAN"
                      "20" = "HISPANIC" "21" = "PORTUGUESE" "22" = "POLISH" "23" = "ESTONIAN"
                      "24" = "LATVIAN" "25" = "LITHUANIAN" "26" = "UKRAINIAN" "27" = "GEORGIAN"
                      "28" = "BYELORUSSIAN" "29" = "ARMENIAN" "30" = "RUSSIAN" "31" = "TURKISH"
                      "32" = "KURDISH" "33" = "GREEK" "34" = "PERSIAN" "35" = "MOLDOVAN" "36" =
                      "BULGARIAN" "37" = "ROMANIAN" "38" = "ALBANIAN" "39" = "NATIVE AMERICAN"
                      "40" = "SLOVENIAN" "41" = "CROATIAN" "42" = "SERBIAN" "43" = "BOSNIAK"
                      "44" = "AZERBAIJANI" "45" = "KAZAKH" "46" = "AFGHAN" "47" = "PAKISTANI"
                      "48" = "BANGLADESHI" "49" = "INDONESIAN" "50" = "INDIAN" "51" = "BURMESE
                      (MYANMAR)" "52" = "MONGOLIAN" "53" = "CHINESE" "56" = "KOREAN" "57" =
                      "JAPANESE" "58" = "THAI" "59" = "MALAY" "60" = "LAOTIAN" "61" = "KHMER"
                      "62" = "VIETNAMESE" "63" = "SRI LANKAN" "64" = "UZBEK" "65" = "OTHER
                      ASIAN" "66" = "JEWISH" "67" = "ALEUT" "68" = "HEBREW" "70" = "ARAB" "72" =
                      "TURKMEN" "73" = "TAJIK" "74" = "KIRGHIZ" "75" = "SAUDI" "76" = "IRAQI"
                      "77" = "LIBYAN" "78" = "EGYPTIAN" "79" = "RWANDAN" "7A" = "HINDU" "7B" =
                      "DJIBOUTIAN" "7C" = "MANX" "7D" = "TELUGU" "7E" = "NEPALESE" "7F" =
                      "SAMOAN" "7G" = "MAURITANIAN" "7H" = "INUIT" "80" = "TONGAN" "81" =
                      "SENEGALESE" "82" = "MALAWIAN" "83" = "SUDANESE" "84" = "MOROCCAN" "85" =
                      "AFRICAN AMERICAN" "86" = "KENYAN" "87" = "NIGERIAN (NIGERIA)" "88" =
                      "GHANAIAN" "89" = "ZAMBIAN" "8A" = "CONGOLESE" "8B" = "CENTRAL AFRICAN
                      (CENTRAL AFRICAN REPUBLIC)" "8C" = "TOGOLESE" "8D" = "BAHRAINI" "8E" =
                      "QATARI" "8F" = "GUYANESE" "8G" = "TIBETAN" "8H" = "FIJIAN" "8I" = "SWAZI"
                      "8J" = "ZULU" "8K" = "XHOSA" "8L" = "BASOTHO" "8M" = "SOUTH AFRICAN" "8N"
                      = "LIBERIAN" "8O" = "COMORAN" "8P" = "BENINESE" "8Q" = "BURKINABE (BURKINA
                      FASO)" "8R" = "NIGERIEN (NIGER)" "8S" = "ASHANTI" "8T" = "SWAHILI" "8U" =
                      "HAITIAN" "8V" = "MALIAN" "8W" = "JAMAICAN" "8X" = "HAUSA" "8Y" = "PILI"
                      "90" = "CONGOLESE (DRG)" "91" = "SURINAMESE" "92" = "MOZAMBICAN
                      (MOZAMBIQUE)" "93" = "IVORIAN (IVORY COAST)" "94" = "BHUTANESE" "95" =
                      "ETHIOPIAN" "96" = "UGANDAN" "97" = "BATSWANA (BOTSWANA)" "98" =
                      "CAMEROONIAN" "99" = "ZIMBABWEAN" "9A" = "NAMIBIAN" "9B" = "BURUNDI" "9C"
                      = "TANZANIAN" "9D" = "GAMBIAN" "9E" = "SOMALI" "9F" = "MACEDONIAN" "9G" =
                      "CHADIAN" "9H" = "GABONESE" "9I" = "ANGOLAN" "9J" = "CHECHEN" "9K" =
                      "IGBO" "9L" = "YORUBA" "9M" = "ALGERIAN" "9N" = "FILIPINO" "9O" = "SOTHO
                      (LESOTHO)" "9P" = "TUNISIAN" "9Q" = "HAWAIIAN" "9R" = "MALAGASY
                      (MADAGASCAR)" "9S" = "BASQUE" "9T" = "SIERRA LEONEAN" "9U" = "KUWAITI"
                      "9V" = "YEMENI" "9W" = "GUINEAN (GUINEA-BISSAU)" "9X" = "PAPUA NEW
                      GUINEAN" "9Y" = "EQUATORIAL GUINEAN" "9Z" = "SYRIAN" "A1" = "AFRICAN
                      AMERICAN" "A2" = "AFRICAN AMERICAN" "A3" = "AFRICAN AMERICAN" "A4" =
                      "AFRICAN AMERICAN" "A5" = "AFRICAN AMERICAN" "D1" = "AFRICAN AMERICAN"
                      "D2" = "AFRICAN AMERICAN" "D3" = "AFRICAN AMERICAN" "D4" = "AFRICAN
                      AMERICAN" "D5" = "AFRICAN AMERICAN" "E1" = "AFRICAN AMERICAN" "E2" =
                      "AFRICAN AMERICAN" "E3" = "AFRICAN AMERICAN" "E4" = "AFRICAN AMERICAN"
                      "E5" = "AFRICAN AMERICAN" "F1" = "AFRICAN AMERICAN" "F2" = "AFRICAN
                      AMERICAN" "F3" = "AFRICAN AMERICAN" "F4" = "AFRICAN AMERICAN" "F5" =
                      "AFRICAN AMERICAN" "I1" = "AFRICAN AMERICAN" "I2" = "AFRICAN AMERICAN"
                      "I3" = "AFRICAN AMERICAN" "I4" = "AFRICAN AMERICAN" "I5" = "AFRICAN
                      AMERICAN" "S1" = "AFRICAN AMERICAN" "S2" = "AFRICAN AMERICAN" "S3" =
                      "AFRICAN AMERICAN" "S4" = "AFRICAN AMERICAN" "S5" = "AFRICAN AMERICAN"
                      "U1" = "AFRICAN AMERICAN" "U2" = "AFRICAN AMERICAN" "U3" = "AFRICAN
                      AMERICAN" "U4" = "AFRICAN AMERICAN" "U5" = "AFRICAN AMERICAN" "UC" =
                      "UNCODABLE RECORDS" "W1" = "AFRICAN AMERICAN" "W2" = "AFRICAN AMERICAN"
                      "W3" = "AFRICAN AMERICAN" "W4" = "AFRICAN AMERICAN" "W5" = "AFRICAN
                      AMERICAN" "ZZ" = "MULTI ETHNIC";
NOTE: Format $etethnic is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value $etrelig "B" = "BUDDHIST" "C" = "CATHOLIC" "E" = "ETHIOPIAN
                      ORTHODOX" "G" = "GREEK ORTHODOX" "H" = "HINDU" "I" = "MUSLIM" "J" =
                      "JEWISH" "K" = "SIKH" "L" = "LUTHERAN" "M" = "MORMON" "O" = "EASTERN
                      ORTHODOX" "P" = "PROTESTANT" "S" = "SHINTO" "X" = "UNCODED";
NOTE: Format $etrelig is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value $etlang "00" = "UNKNOWN" "01" = "ENGLISH" "03" = "DANISH" "04" =
                      "SWEDISH" "05" = "NORWEGIAN" "06" = "FINNISH" "07" = "ICELANDIC" "08" =
                      "DUTCH" "09" = "FLEMISH/WALLOON" "10" = "GERMAN" "12" = "HUNGARIAN" "13" =
                      "CZECH" "14" = "SLOVAK" "17" = "FRENCH" "19" = "ITALIAN" "20" = "SPANISH"
                      "21" = "PORTUGUESE" "22" = "POLISH" "23" = "ESTONIAN" "24" = "LATVIAN"
                      "25" = "LITHUANIAN" "27" = "GEORGIAN" "29" = "ARMENIAN" "30" = "RUSSIAN"
                      "31" = "TURKISH" "32" = "KURDISH" "33" = "GREEK" "34" = "FARSI" "35" =
                      "MOLDOVAN" "36" = "BULGARIAN" "37" = "ROMANIAN" "38" = "ALBANIAN" "40" =
                      "SLOVENIAN" "41" = "SERBO-CROATIAN" "44" = "AZERI" "45" = "KAZAKH" "46" =
                      "PASHTU/PASHTO" "47" = "URDU" "48" = "BENGALI/BANGLA" "49" = "BAHASA
                      INDONESIA" "51" = "BURMESE" "52" = "MONGOLIAN" "53" = "CHINESE" "56" =
                      "KOREAN" "57" = "JAPANESE" "58" = "THAI" "59" = "BAHASA MELAYU" "60" =
                      "LAO" "61" = "KHMER" "62" = "VIETNAMESE" "63" = "SINHALA" "64" = "UZBEK"
                      "68" = "HEBREW" "70" = "ARABIC" "72" = "TURKMEN" "73" = "TAJIK" "74" =
                      "KIRGHIZ" "7A" = "HINDI" "7E" = "NEPALI" "7F" = "SAMOAN" "80" = "TONGAN"
                      "86" = "OROMO" "88" = "GA" "8G" = "TIBETAN" "8I" = "SISWATI" "8J" = "ZULU"
                      "8K" = "XHOSA" "8M" = "AFRIKAANS" "8O" = "COMORIAN/SHIKOMORO" "8S" = "TWI
                      (OF ASHANTI ETHNICITY)" "8T" = "SWAHILI" "8X" = "HAUSA" "92" = "BANTU"
                      "94" = "DZONGKHA" "95" = "AMHARIC" "97" = "TSWANA" "9E" = "SOMALI" "9F" =
                      "MACEDONIAN" "9K" = "IGBO" "9L" = "YORUBA" "9N" = "TAGALOG" "9O" = "SOTHO"
                      "9R" = "MALAGASY" "9S" = "BASQUE";
NOTE: Format $etlang is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value $ethisporg "00" = "UNKNOWN" "01" = "MEXICO" "02" = "CUBA" "03" =
                      "PUERTO RICO" "04" = "NICARAGUA" "05" = "DOMINICAN REPUBLIC" "06" =
                      "COLOMBIA" "07" = "HONDURAS" "08" = "GUATEMALA" "09" = "EL SALVADOR" "10"
                      = "COSTA RICA" "11" = "PANAMA" "12" = "ECUADOR" "13" = "VENEZUELA" "14" =
                      "ARGENTINA" "15" = "CHILE" "16" = "PERU" "17" = "BOLIVIA" "18" = "URUGUAY"
                      "19" = "PARAGUAY" "20" = "SPAIN" "22" = "BRAZIL";
NOTE: Format $ethisporg is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value $ethispasm "1" = "ASSIMILATED" "2" = "BILINGUAL ENGLISH" "3" =
                      "BILINGUAL SPANISH" "4" = "UNASSIMILATED" "0" = "UNKNOWN";
NOTE: Format $ethispasm is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value $etasiaasm "1" = "ASSIMILATED" "2" = "BILINGUAL ENGLISH" "3" =
                      "BILINGUAL NATIVE" "4" = "UNASSIMILATED" "0" = "UNKNOWN";
NOTE: Format $etasiaasm is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  value $etgender "1" = "MALE" "2" = "FEMALE" "3" = "EITHER" "0" =
                      "UNKNOWN";
NOTE: Format $etgender is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  run;
NOTE: Procedure format step took :
      real time : 0.008
      cpu time  : 0.007


MPRINT(AGGREGATION):  proc format;
MPRINT(AGGREGATION):  value $val_st_scf 'AK_995' ='V' 'AK_996' ='V' 'AK_997' ='V' 'AK_998' ='V'
                      'AK_999' ='V' 'AL_350' ='V' 'AL_351' ='V' 'AL_352' ='V' 'AL_354' ='V'
                      'AL_355' ='V' 'AL_356' ='V' 'AL_357' ='V' 'AL_358' ='V' 'AL_359' ='V'
                      'AL_360' ='V' 'AL_361' ='V' 'AL_362' ='V' 'AL_363' ='V' 'AL_364' ='V'
                      'AL_365' ='V' 'AL_366' ='V' 'AL_367' ='V' 'AL_368' ='V' 'AL_369' ='V'
                      'AR_716' ='V' 'AR_717' ='V' 'AR_718' ='V' 'AR_719' ='V' 'AR_720' ='V'
                      'AR_721' ='V' 'AR_722' ='V' 'AR_723' ='V' 'AR_724' ='V' 'AR_725' ='V'
                      'AR_726' ='V' 'AR_727' ='V' 'AR_728' ='V' 'AR_729' ='V' 'AZ_850' ='V'
                      'AZ_851' ='V' 'AZ_852' ='V' 'AZ_853' ='V' 'AZ_855' ='V' 'AZ_856' ='V'
                      'AZ_857' ='V' 'AZ_859' ='V' 'AZ_860' ='V' 'AZ_863' ='V' 'AZ_864' ='V'
                      'AZ_865' ='V' 'CA_900' ='V' 'CA_902' ='V' 'CA_903' ='V' 'CA_904' ='V'
                      'CA_905' ='V' 'CA_906' ='V' 'CA_907' ='V' 'CA_908' ='V' 'CA_910' ='V'
                      'CA_911' ='V' 'CA_912' ='V' 'CA_913' ='V' 'CA_914' ='V' 'CA_915' ='V'
                      'CA_916' ='V' 'CA_917' ='V' 'CA_918' ='V' 'CA_919' ='V' 'CA_920' ='V'
                      'CA_921' ='V' 'CA_922' ='V' 'CA_923' ='V' 'CA_924' ='V' 'CA_925' ='V'
                      'CA_926' ='V' 'CA_927' ='V' 'CA_928' ='V' 'CA_930' ='V' 'CA_931' ='V'
                      'CA_932' ='V' 'CA_933' ='V' 'CA_934' ='V' 'CA_935' ='V' 'CA_936' ='V'
                      'CA_937' ='V' 'CA_939' ='V' 'CA_940' ='V' 'CA_941' ='V' 'CA_943' ='V'
                      'CA_944' ='V' 'CA_945' ='V' 'CA_946' ='V' 'CA_947' ='V' 'CA_948' ='V'
                      'CA_949' ='V' 'CA_950' ='V' 'CA_951' ='V' 'CA_952' ='V' 'CA_953' ='V'
                      'CA_954' ='V' 'CA_955' ='V' 'CA_956' ='V' 'CA_957' ='V' 'CA_958' ='V'
                      'CA_959' ='V' 'CA_960' ='V' 'CA_961' ='V' 'CO_800' ='V' 'CO_801' ='V'
                      'CO_802' ='V' 'CO_803' ='V' 'CO_804' ='V' 'CO_805' ='V' 'CO_806' ='V'
                      'CO_807' ='V' 'CO_808' ='V' 'CO_809' ='V' 'CO_810' ='V' 'CO_811' ='V'
                      'CO_812' ='V' 'CO_813' ='V' 'CO_814' ='V' 'CO_815' ='V' 'CO_816' ='V'
                      'CT_060' ='V' 'CT_061' ='V' 'CT_062' ='V' 'CT_063' ='V' 'CT_064' ='V'
                      'CT_065' ='V' 'CT_066' ='V' 'CT_067' ='V' 'CT_068' ='V' 'CT_069' ='V'
                      'DC_200' ='V' 'DC_202' ='V' 'DC_203' ='V' 'DC_205' ='V' 'DE_197' ='V'
                      'DE_198' ='V' 'DE_199' ='V' 'FL_320' ='V' 'FL_321' ='V' 'FL_322' ='V'
                      'FL_323' ='V' 'FL_324' ='V' 'FL_325' ='V' 'FL_326' ='V' 'FL_327' ='V'
                      'FL_328' ='V' 'FL_329' ='V' 'FL_330' ='V' 'FL_331' ='V' 'FL_332' ='V'
                      'FL_333' ='V' 'FL_334' ='V' 'FL_335' ='V' 'FL_336' ='V' 'FL_337' ='V'
                      'FL_338' ='V' 'FL_339' ='V' 'FL_341' ='V' 'FL_342' ='V' 'FL_344' ='V'
                      'FL_346' ='V' 'FL_347' ='V' 'FL_349' ='V' 'GA_300' ='V' 'GA_301' ='V'
                      'GA_302' ='V' 'GA_303' ='V' 'GA_304' ='V' 'GA_305' ='V' 'GA_306' ='V'
                      'GA_307' ='V' 'GA_308' ='V' 'GA_309' ='V' 'GA_310' ='V' 'GA_311' ='V'
                      'GA_312' ='V' 'GA_313' ='V' 'GA_314' ='V' 'GA_315' ='V' 'GA_316' ='V'
                      'GA_317' ='V' 'GA_318' ='V' 'GA_319' ='V' 'GA_398' ='V' 'HI_967' ='V'
                      'HI_968' ='V' 'IA_500' ='V' 'IA_501' ='V' 'IA_502' ='V' 'IA_503' ='V'
                      'IA_504' ='V' 'IA_505' ='V' 'IA_506' ='V' 'IA_507' ='V' 'IA_508' ='V'
                      'IA_510' ='V' 'IA_511' ='V' 'IA_512' ='V' 'IA_513' ='V' 'IA_514' ='V'
                      'IA_515' ='V' 'IA_516' ='V' 'IA_520' ='V' 'IA_521' ='V' 'IA_522' ='V'
                      'IA_523' ='V' 'IA_524' ='V' 'IA_525' ='V' 'IA_526' ='V' 'IA_527' ='V'
                      'IA_528' ='V' 'ID_832' ='V' 'ID_833' ='V' 'ID_834' ='V' 'ID_835' ='V'
                      'ID_836' ='V' 'ID_837' ='V' 'ID_838' ='V' 'IL_600' ='V' 'IL_601' ='V'
                      'IL_602' ='V' 'IL_603' ='V' 'IL_604' ='V' 'IL_605' ='V' 'IL_606' ='V'
                      'IL_607' ='V' 'IL_608' ='V' 'IL_609' ='V' 'IL_610' ='V' 'IL_611' ='V'
                      'IL_612' ='V' 'IL_613' ='V' 'IL_614' ='V' 'IL_615' ='V' 'IL_616' ='V'
                      'IL_617' ='V' 'IL_618' ='V' 'IL_619' ='V' 'IL_620' ='V' 'IL_622' ='V'
                      'IL_623' ='V' 'IL_624' ='V' 'IL_625' ='V' 'IL_626' ='V' 'IL_627' ='V'
                      'IL_628' ='V' 'IL_629' ='V' 'IN_460' ='V' 'IN_461' ='V' 'IN_462' ='V'
                      'IN_463' ='V' 'IN_464' ='V' 'IN_465' ='V' 'IN_466' ='V' 'IN_467' ='V'
                      'IN_468' ='V' 'IN_469' ='V' 'IN_470' ='V' 'IN_471' ='V' 'IN_472' ='V'
                      'IN_473' ='V' 'IN_474' ='V' 'IN_475' ='V' 'IN_476' ='V' 'IN_477' ='V'
                      'IN_478' ='V' 'IN_479' ='V' 'KS_660' ='V' 'KS_661' ='V' 'KS_662' ='V'
                      'KS_664' ='V' 'KS_665' ='V' 'KS_666' ='V' 'KS_667' ='V' 'KS_668' ='V'
                      'KS_669' ='V' 'KS_670' ='V' 'KS_671' ='V' 'KS_672' ='V' 'KS_673' ='V'
                      'KS_674' ='V' 'KS_675' ='V' 'KS_676' ='V' 'KS_677' ='V' 'KS_678' ='V'
                      'KS_679' ='V' 'KY_400' ='V' 'KY_401' ='V' 'KY_402' ='V' 'KY_403' ='V'
                      'KY_404' ='V' 'KY_405' ='V' 'KY_406' ='V' 'KY_407' ='V' 'KY_408' ='V'
                      'KY_409' ='V' 'KY_410' ='V' 'KY_411' ='V' 'KY_412' ='V' 'KY_413' ='V'
                      'KY_414' ='V' 'KY_415' ='V' 'KY_416' ='V' 'KY_417' ='V' 'KY_418' ='V'
                      'KY_420' ='V' 'KY_421' ='V' 'KY_422' ='V' 'KY_423' ='V' 'KY_424' ='V'
                      'KY_425' ='V' 'KY_426' ='V' 'KY_427' ='V' 'LA_700' ='V' 'LA_701' ='V'
                      'LA_703' ='V' 'LA_704' ='V' 'LA_705' ='V' 'LA_706' ='V' 'LA_707' ='V'
                      'LA_708' ='V' 'LA_710' ='V' 'LA_711' ='V' 'LA_712' ='V' 'LA_713' ='V'
                      'LA_714' ='V' 'MA_010' ='V' 'MA_011' ='V' 'MA_012' ='V' 'MA_013' ='V'
                      'MA_014' ='V' 'MA_015' ='V' 'MA_016' ='V' 'MA_017' ='V' 'MA_018' ='V'
                      'MA_019' ='V' 'MA_020' ='V' 'MA_021' ='V' 'MA_022' ='V' 'MA_023' ='V'
                      'MA_024' ='V' 'MA_025' ='V' 'MA_026' ='V' 'MA_027' ='V' 'MD_206' ='V'
                      'MD_207' ='V' 'MD_208' ='V' 'MD_209' ='V' 'MD_210' ='V' 'MD_211' ='V'
                      'MD_212' ='V' 'MD_214' ='V' 'MD_215' ='V' 'MD_216' ='V' 'MD_217' ='V'
                      'MD_218' ='V' 'MD_219' ='V' 'ME_039' ='V' 'ME_040' ='V' 'ME_041' ='V'
                      'ME_042' ='V' 'ME_043' ='V' 'ME_044' ='V' 'ME_045' ='V' 'ME_046' ='V'
                      'ME_047' ='V' 'ME_048' ='V' 'ME_049' ='V' 'MI_480' ='V' 'MI_481' ='V'
                      'MI_482' ='V' 'MI_483' ='V' 'MI_484' ='V' 'MI_485' ='V' 'MI_486' ='V'
                      'MI_487' ='V' 'MI_488' ='V' 'MI_489' ='V' 'MI_490' ='V' 'MI_491' ='V'
                      'MI_492' ='V' 'MI_493' ='V' 'MI_494' ='V' 'MI_495' ='V' 'MI_496' ='V'
                      'MI_497' ='V' 'MI_498' ='V' 'MI_499' ='V' 'MN_550' ='V' 'MN_551' ='V'
                      'MN_553' ='V' 'MN_554' ='V' 'MN_555' ='V' 'MN_556' ='V' 'MN_557' ='V'
                      'MN_558' ='V' 'MN_559' ='V' 'MN_560' ='V' 'MN_561' ='V' 'MN_562' ='V'
                      'MN_563' ='V' 'MN_564' ='V' 'MN_565' ='V' 'MN_566' ='V' 'MN_567' ='V'
                      'MO_630' ='V' 'MO_631' ='V' 'MO_633' ='V' 'MO_634' ='V' 'MO_635' ='V'
                      'MO_636' ='V' 'MO_637' ='V' 'MO_638' ='V' 'MO_639' ='V' 'MO_640' ='V'
                      'MO_641' ='V' 'MO_644' ='V' 'MO_645' ='V' 'MO_646' ='V' 'MO_647' ='V'
                      'MO_648' ='V' 'MO_650' ='V' 'MO_651' ='V' 'MO_652' ='V' 'MO_653' ='V'
                      'MO_654' ='V' 'MO_655' ='V' 'MO_656' ='V' 'MO_657' ='V' 'MO_658' ='V'
                      'MS_386' ='V' 'MS_387' ='V' 'MS_388' ='V' 'MS_389' ='V' 'MS_390' ='V'
                      'MS_391' ='V' 'MS_392' ='V' 'MS_393' ='V' 'MS_394' ='V' 'MS_395' ='V'
                      'MS_396' ='V' 'MS_397' ='V' 'MT_590' ='V' 'MT_591' ='V' 'MT_592' ='V'
                      'MT_593' ='V' 'MT_594' ='V' 'MT_595' ='V' 'MT_596' ='V' 'MT_597' ='V'
                      'MT_598' ='V' 'MT_599' ='V' 'NC_270' ='V' 'NC_271' ='V' 'NC_272' ='V'
                      'NC_273' ='V' 'NC_274' ='V' 'NC_275' ='V' 'NC_276' ='V' 'NC_277' ='V'
                      'NC_278' ='V' 'NC_279' ='V' 'NC_280' ='V' 'NC_281' ='V' 'NC_282' ='V'
                      'NC_283' ='V' 'NC_284' ='V' 'NC_285' ='V' 'NC_286' ='V' 'NC_287' ='V'
                      'NC_288' ='V' 'NC_289' ='V' 'ND_580' ='V' 'ND_581' ='V' 'ND_582' ='V'
                      'ND_583' ='V' 'ND_584' ='V' 'ND_585' ='V' 'ND_586' ='V' 'ND_587' ='V'
                      'ND_588' ='V' 'NE_680' ='V' 'NE_681' ='V' 'NE_683' ='V' 'NE_684' ='V'
                      'NE_685' ='V' 'NE_686' ='V' 'NE_687' ='V' 'NE_688' ='V' 'NE_689' ='V'
                      'NE_690' ='V' 'NE_691' ='V' 'NE_692' ='V' 'NE_693' ='V' 'NH_030' ='V'
                      'NH_031' ='V' 'NH_032' ='V' 'NH_033' ='V' 'NH_034' ='V' 'NH_035' ='V'
                      'NH_036' ='V' 'NH_037' ='V' 'NH_038' ='V' 'NJ_070' ='V' 'NJ_071' ='V'
                      'NJ_072' ='V' 'NJ_073' ='V' 'NJ_074' ='V' 'NJ_075' ='V' 'NJ_076' ='V'
                      'NJ_077' ='V' 'NJ_078' ='V' 'NJ_079' ='V' 'NJ_080' ='V' 'NJ_081' ='V'
                      'NJ_082' ='V' 'NJ_083' ='V' 'NJ_084' ='V' 'NJ_085' ='V' 'NJ_086' ='V'
                      'NJ_087' ='V' 'NJ_088' ='V' 'NJ_089' ='V' 'NM_870' ='V' 'NM_871' ='V'
                      'NM_873' ='V' 'NM_874' ='V' 'NM_875' ='V' 'NM_877' ='V' 'NM_878' ='V'
                      'NM_879' ='V' 'NM_880' ='V' 'NM_881' ='V' 'NM_882' ='V' 'NM_883' ='V'
                      'NM_884' ='V' 'NV_890' ='V' 'NV_891' ='V' 'NV_893' ='V' 'NV_894' ='V'
                      'NV_895' ='V' 'NV_897' ='V' 'NV_898' ='V' 'NY_063' ='V' 'NY_100' ='V'
                      'NY_101' ='V' 'NY_102' ='V' 'NY_103' ='V' 'NY_104' ='V' 'NY_105' ='V'
                      'NY_106' ='V' 'NY_107' ='V' 'NY_108' ='V' 'NY_109' ='V' 'NY_110' ='V'
                      'NY_111' ='V' 'NY_112' ='V' 'NY_113' ='V' 'NY_114' ='V' 'NY_115' ='V'
                      'NY_116' ='V' 'NY_117' ='V' 'NY_118' ='V' 'NY_119' ='V' 'NY_120' ='V'
                      'NY_121' ='V' 'NY_122' ='V' 'NY_123' ='V' 'NY_124' ='V' 'NY_125' ='V'
                      'NY_126' ='V' 'NY_127' ='V' 'NY_128' ='V' 'NY_129' ='V' 'NY_130' ='V'
                      'NY_131' ='V' 'NY_132' ='V' 'NY_133' ='V' 'NY_134' ='V' 'NY_135' ='V'
                      'NY_136' ='V' 'NY_137' ='V' 'NY_138' ='V' 'NY_139' ='V' 'NY_140' ='V'
                      'NY_141' ='V' 'NY_142' ='V' 'NY_143' ='V' 'NY_144' ='V' 'NY_145' ='V'
                      'NY_146' ='V' 'NY_147' ='V' 'NY_148' ='V' 'NY_149' ='V' 'OH_430' ='V'
                      'OH_431' ='V' 'OH_432' ='V' 'OH_433' ='V' 'OH_434' ='V' 'OH_435' ='V'
                      'OH_436' ='V' 'OH_437' ='V' 'OH_438' ='V' 'OH_439' ='V' 'OH_440' ='V'
                      'OH_441' ='V' 'OH_442' ='V' 'OH_443' ='V' 'OH_444' ='V' 'OH_445' ='V'
                      'OH_446' ='V' 'OH_447' ='V' 'OH_448' ='V' 'OH_449' ='V' 'OH_450' ='V'
                      'OH_451' ='V' 'OH_452' ='V' 'OH_453' ='V' 'OH_454' ='V' 'OH_455' ='V'
                      'OH_456' ='V' 'OH_457' ='V' 'OH_458' ='V' 'OK_730' ='V' 'OK_731' ='V'
                      'OK_734' ='V' 'OK_735' ='V' 'OK_736' ='V' 'OK_737' ='V' 'OK_738' ='V'
                      'OK_739' ='V' 'OK_740' ='V' 'OK_741' ='V' 'OK_743' ='V' 'OK_744' ='V'
                      'OK_745' ='V' 'OK_746' ='V' 'OK_747' ='V' 'OK_748' ='V' 'OK_749' ='V'
                      'OR_970' ='V' 'OR_971' ='V' 'OR_972' ='V' 'OR_973' ='V' 'OR_974' ='V'
                      'OR_975' ='V' 'OR_976' ='V' 'OR_977' ='V' 'OR_978' ='V' 'OR_979' ='V'
                      'PA_150' ='V' 'PA_151' ='V' 'PA_152' ='V' 'PA_153' ='V' 'PA_154' ='V'
                      'PA_155' ='V' 'PA_156' ='V' 'PA_157' ='V' 'PA_158' ='V' 'PA_159' ='V'
                      'PA_160' ='V' 'PA_161' ='V' 'PA_162' ='V' 'PA_163' ='V' 'PA_164' ='V'
                      'PA_165' ='V' 'PA_166' ='V' 'PA_167' ='V' 'PA_168' ='V' 'PA_169' ='V'
                      'PA_170' ='V' 'PA_171' ='V' 'PA_172' ='V' 'PA_173' ='V' 'PA_174' ='V'
                      'PA_175' ='V' 'PA_176' ='V' 'PA_177' ='V' 'PA_178' ='V' 'PA_179' ='V'
                      'PA_180' ='V' 'PA_181' ='V' 'PA_182' ='V' 'PA_183' ='V' 'PA_184' ='V'
                      'PA_185' ='V' 'PA_186' ='V' 'PA_187' ='V' 'PA_188' ='V' 'PA_189' ='V'
                      'PA_190' ='V' 'PA_191' ='V' 'PA_193' ='V' 'PA_194' ='V' 'PA_195' ='V'
                      'PA_196' ='V' 'RI_028' ='V' 'RI_029' ='V' 'SC_290' ='V' 'SC_291' ='V'
                      'SC_292' ='V' 'SC_293' ='V' 'SC_294' ='V' 'SC_295' ='V' 'SC_296' ='V'
                      'SC_297' ='V' 'SC_298' ='V' 'SC_299' ='V' 'SD_570' ='V' 'SD_571' ='V'
                      'SD_572' ='V' 'SD_573' ='V' 'SD_574' ='V' 'SD_575' ='V' 'SD_576' ='V'
                      'SD_577' ='V' 'TN_370' ='V' 'TN_371' ='V' 'TN_372' ='V' 'TN_373' ='V'
                      'TN_374' ='V' 'TN_376' ='V' 'TN_377' ='V' 'TN_378' ='V' 'TN_379' ='V'
                      'TN_380' ='V' 'TN_381' ='V' 'TN_382' ='V' 'TN_383' ='V' 'TN_384' ='V'
                      'TN_385' ='V' 'TX_750' ='V' 'TX_751' ='V' 'TX_752' ='V' 'TX_753' ='V'
                      'TX_754' ='V' 'TX_755' ='V' 'TX_756' ='V' 'TX_757' ='V' 'TX_758' ='V'
                      'TX_759' ='V' 'TX_760' ='V' 'TX_761' ='V' 'TX_762' ='V' 'TX_763' ='V'
                      'TX_764' ='V' 'TX_765' ='V' 'TX_766' ='V' 'TX_767' ='V' 'TX_768' ='V'
                      'TX_769' ='V' 'TX_770' ='V' 'TX_772' ='V' 'TX_773' ='V' 'TX_774' ='V'
                      'TX_775' ='V' 'TX_776' ='V' 'TX_777' ='V' 'TX_778' ='V' 'TX_779' ='V'
                      'TX_780' ='V' 'TX_781' ='V' 'TX_782' ='V' 'TX_783' ='V' 'TX_784' ='V'
                      'TX_785' ='V' 'TX_786' ='V' 'TX_787' ='V' 'TX_788' ='V' 'TX_789' ='V'
                      'TX_790' ='V' 'TX_791' ='V' 'TX_792' ='V' 'TX_793' ='V' 'TX_794' ='V'
                      'TX_795' ='V' 'TX_796' ='V' 'TX_797' ='V' 'TX_798' ='V' 'TX_799' ='V'
                      'TX_885' ='V' 'UT_840' ='V' 'UT_841' ='V' 'UT_843' ='V' 'UT_844' ='V'
                      'UT_845' ='V' 'UT_846' ='V' 'UT_847' ='V' 'VA_201' ='V' 'VA_220' ='V'
                      'VA_221' ='V' 'VA_222' ='V' 'VA_223' ='V' 'VA_224' ='V' 'VA_225' ='V'
                      'VA_226' ='V' 'VA_227' ='V' 'VA_228' ='V' 'VA_229' ='V' 'VA_230' ='V'
                      'VA_231' ='V' 'VA_232' ='V' 'VA_233' ='V' 'VA_234' ='V' 'VA_235' ='V'
                      'VA_236' ='V' 'VA_237' ='V' 'VA_238' ='V' 'VA_239' ='V' 'VA_240' ='V'
                      'VA_241' ='V' 'VA_242' ='V' 'VA_243' ='V' 'VA_244' ='V' 'VA_245' ='V'
                      'VA_246' ='V' 'VT_050' ='V' 'VT_051' ='V' 'VT_052' ='V' 'VT_053' ='V'
                      'VT_054' ='V' 'VT_056' ='V' 'VT_057' ='V' 'VT_058' ='V' 'VT_059' ='V'
                      'WA_980' ='V' 'WA_981' ='V' 'WA_982' ='V' 'WA_983' ='V' 'WA_984' ='V'
                      'WA_985' ='V' 'WA_986' ='V' 'WA_988' ='V' 'WA_989' ='V' 'WA_990' ='V'
                      'WA_991' ='V' 'WA_992' ='V' 'WA_993' ='V' 'WA_994' ='V' 'WI_530' ='V'
                      'WI_531' ='V' 'WI_532' ='V' 'WI_534' ='V' 'WI_535' ='V' 'WI_537' ='V'
                      'WI_538' ='V' 'WI_539' ='V' 'WI_540' ='V' 'WI_541' ='V' 'WI_542' ='V'
                      'WI_543' ='V' 'WI_544' ='V' 'WI_545' ='V' 'WI_546' ='V' 'WI_547' ='V'
                      'WI_548' ='V' 'WI_549' ='V' 'WV_247' ='V' 'WV_248' ='V' 'WV_249' ='V'
                      'WV_250' ='V' 'WV_251' ='V' 'WV_252' ='V' 'WV_253' ='V' 'WV_254' ='V'
                      'WV_255' ='V' 'WV_256' ='V' 'WV_257' ='V' 'WV_258' ='V' 'WV_259' ='V'
                      'WV_260' ='V' 'WV_261' ='V' 'WV_262' ='V' 'WV_263' ='V' 'WV_264' ='V'
                      'WV_265' ='V' 'WV_266' ='V' 'WV_267' ='V' 'WV_268' ='V' 'WY_820' ='V'
                      'WY_821' ='V' 'WY_822' ='V' 'WY_823' ='V' 'WY_824' ='V' 'WY_825' ='V'
                      'WY_826' ='V' 'WY_827' ='V' 'WY_828' ='V' 'WY_829' ='V' 'WY_830' ='V'
                      'WY_831' ='V' 'WY_834' ='V' other='I';
NOTE: Format $val_st_scf is already in the catalog and will be overwritten
MPRINT(AGGREGATION):  run;
NOTE: Procedure format step took :
      real time : 0.009
      cpu time  : 0.008


MPRINT(AGGREGATION):  *--- for matching*;
MPRINT(AGGREGATION):  ************;
MPRINT(AGGREGATION):  * DATA PREP FOR MODELING;
MPRINT(AGGREGATION):  ************;
MPRINT(AGGREGATION):  ***;
MPRINT(AGGREGATION):  * CACDIRECT MODELING RECODES;
MPRINT(AGGREGATION):  * LAST UPDATED MM 4/22/2014;
MPRINT(AGGREGATION):  * ADDED NON_ENHANCED PARAMTER WHICH CONTROLS WHETHER OR NOT TO CREATE
                      LEGACY RECODES USING NON ENHANCED VERSIONS OF VARIABLES;
MPRINT(AGGREGATION):  ***;
MPRINT(AGGREGATION):  *** IF CURRENT PRODUCTION DATA IS IN B THEN WRITE DATA FOR NEW QUARTER TO
                      A;
MPRINT(AGGREGATION):  libname _ALL_;
MPRINT(AGGREGATION):  libname base "/project/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/BASE_DEMO/A";
NOTE: Library base assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/BASE_DEMO/A

MPRINT(AGGREGATION):  libname for_rts
                      "/project/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/REAL_TIME/A";
NOTE: Library for_rts assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/REAL_TIME/A

MPRINT(AGGREGATION):  libname cen2010 "/project17/CENSUS/DATA/2010/FINAL";
NOTE: Library cen2010 assigned as follows:
      Engine:        SAS7BDAT
      Physical Name: /project17/CENSUS/DATA/2010/FINAL

MPRINT(AGGREGATION):  filename file_3
                      "/project/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/EXPORT/BUZZBOARD/buzzboard
                      _zip_level.csv";
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Define States and get state count
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data _NULL_;
MPRINT(AGGREGATION):  array x(*) AL AK AZ AR CA CO CT DE FL GA HI ID IL IN IA KS KY LA ME MD MA
                      MI MN MS MO MT NE NV NH NJ NM NY NC ND OH OK OR PA RI SC SD TN TX UT VT VA
                      WA WV WI WY DC;
MPRINT(AGGREGATION):  call symput("numstates",dim(x));
MPRINT(AGGREGATION):  run;

NOTE: Numeric values have been converted to character values at the places given by:
      (Line):(Column)
      4553:64   
NOTE: The data step took :
      real time : 0.007
      cpu time  : 0.003


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data = base.base_demo_AL (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_AL;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 3054699 observations were read from "BASE.base_demo_AL"
NOTE: Data set "WORK.base_demo_AL" has 3054699 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_AL" has decreased its size from 49271
      to 43054 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 31.484
      cpu time  : 37.384


MPRINT(AGGREGATION):  data base_demo_AL (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_AL;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 3054699 observations were read from "WORK.base_demo_AL"
NOTE: Data set "WORK.base_demo_AL" has 765 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_AL" has decreased its size from 111 to
      58 pages (a 48% reduction)
NOTE: The data step took :
      real time : 4.191
      cpu time  : 4.190


MPRINT(AGGREGATION):  proc sort data = base_demo_AL;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 765 observations were read from "WORK.base_demo_AL"
NOTE: Data set "WORK.base_demo_AL" has 765 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_AL" has decreased its size from 111 to
      58 pages (a 48% reduction)
NOTE: Procedure sort step took :
      real time : 0.009
      cpu time  : 0.012


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_AL out=census_xref_AL;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 979193 observations were read from "CEN2010.cac_census_xref_AL"
NOTE: Data set "WORK.census_xref_AL" has 979193 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_AL" has increased its size from 4099
      to 4798 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.411
      cpu time  : 0.671


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_AL out=census_AL;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 4007 observations were read from "CEN2010.cac_census_final_AL"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_AL" has 4007 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_AL" has decreased its size from 4026 to
      3521 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 0.317
      cpu time  : 0.315


MPRINT(AGGREGATION):  data cen_AL (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_AL(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_AL(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 4007 observations were read from "WORK.census_AL"
NOTE: 979193 observations were read from "WORK.census_xref_AL"
NOTE: Data set "WORK.cen_AL" has 979193 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_AL" has decreased its size from 15795 to
      14404 pages (a 9% reduction)
NOTE: The data step took :
      real time : 1.275
      cpu time  : 1.274


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_AL(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 797 observations were read from "WORK.cen_AL"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_AL" has 797 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_AL" has increased its size from 14 to 15
      pages (a 8% increase)
NOTE: Procedure sort step took :
      real time : 0.255
      cpu time  : 0.248


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_AL;
MPRINT(AGGREGATION):  merge cen_AL (in=a) base_demo_AL (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "AL";
MPRINT(AGGREGATION):  run;

NOTE: 797 observations were read from "WORK.cen_AL"
NOTE: 765 observations were read from "WORK.base_demo_AL"
NOTE: Data set "WORK.for_buzzboard_AL" has 760 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_AL" has decreased its size from
      128 to 69 pages (a 47% reduction)
NOTE: The data step took :
      real time : 0.009
      cpu time  : 0.008


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_AL base_demo_AL;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_AL" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_AL" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.030
      cpu time  : 0.006


MPRINT(AGGREGATION):  proc sort data = base.base_demo_AK (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_AK;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 419831 observations were read from "BASE.base_demo_AK"
NOTE: Data set "WORK.base_demo_AK" has 419831 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_AK" has decreased its size from 6773
      to 5879 pages (a 14% reduction)
NOTE: Procedure sort step took :
      real time : 3.672
      cpu time  : 4.641


MPRINT(AGGREGATION):  data base_demo_AK (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_AK;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 419831 observations were read from "WORK.base_demo_AK"
NOTE: Data set "WORK.base_demo_AK" has 268 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_AK" has decreased its size from 40 to
      17 pages (a 58% reduction)
NOTE: The data step took :
      real time : 0.651
      cpu time  : 0.649


MPRINT(AGGREGATION):  proc sort data = base_demo_AK;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 268 observations were read from "WORK.base_demo_AK"
NOTE: Data set "WORK.base_demo_AK" has 268 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_AK" has decreased its size from 40 to
      17 pages (a 58% reduction)
NOTE: Procedure sort step took :
      real time : 0.006
      cpu time  : 0.009


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_AK out=census_xref_AK;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 71589 observations were read from "CEN2010.cac_census_xref_AK"
NOTE: Data set "WORK.census_xref_AK" has 71589 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_AK" has increased its size from 301
      to 351 pages (a 17% increase)
NOTE: Procedure sort step took :
      real time : 0.066
      cpu time  : 0.061


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_AK out=census_AK;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 485 observations were read from "CEN2010.cac_census_final_AK"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_AK" has 485 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_AK" has decreased its size from 504 to
      495 pages (a 2% reduction)
NOTE: Procedure sort step took :
      real time : 0.060
      cpu time  : 0.050


MPRINT(AGGREGATION):  data cen_AK (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_AK(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_AK(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 485 observations were read from "WORK.census_AK"
NOTE: 71589 observations were read from "WORK.census_xref_AK"
NOTE: Data set "WORK.cen_AK" has 71589 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_AK" has decreased its size from 1156 to 1057
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.101
      cpu time  : 0.100


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_AK(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 268 observations were read from "WORK.cen_AK"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_AK" has 268 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_AK" has increased its size from 6 to 7 pages
      (a 17% increase)
NOTE: Procedure sort step took :
      real time : 0.022
      cpu time  : 0.025


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
3                                        The WPS System      10:48 Wednesday, July 29, 2015     

                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_AK;
MPRINT(AGGREGATION):  merge cen_AK (in=a) base_demo_AK (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "AK";
MPRINT(AGGREGATION):  run;

NOTE: 268 observations were read from "WORK.cen_AK"
NOTE: 268 observations were read from "WORK.base_demo_AK"
NOTE: Data set "WORK.for_buzzboard_AK" has 267 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_AK" has decreased its size from 46
      to 21 pages (a 55% reduction)
NOTE: The data step took :
      real time : 0.004
      cpu time  : 0.004


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_AK base_demo_AK;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_AK" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_AK" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_AZ (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_AZ;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 3950714 observations were read from "BASE.base_demo_AZ"
NOTE: Data set "WORK.base_demo_AZ" has 3950714 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_AZ" has decreased its size from 63723
      to 55708 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 42.836
      cpu time  : 51.443


MPRINT(AGGREGATION):  data base_demo_AZ (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_AZ;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 3950714 observations were read from "WORK.base_demo_AZ"
NOTE: Data set "WORK.base_demo_AZ" has 516 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_AZ" has decreased its size from 75 to
      40 pages (a 47% reduction)
NOTE: The data step took :
      real time : 5.496
      cpu time  : 5.496


MPRINT(AGGREGATION):  proc sort data = base_demo_AZ;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 516 observations were read from "WORK.base_demo_AZ"
NOTE: Data set "WORK.base_demo_AZ" has 516 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_AZ" has decreased its size from 75 to
      40 pages (a 47% reduction)
NOTE: Procedure sort step took :
      real time : 0.008
      cpu time  : 0.011


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_AZ out=census_xref_AZ;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 650900 observations were read from "CEN2010.cac_census_xref_AZ"
NOTE: Data set "WORK.census_xref_AZ" has 650900 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_AZ" has increased its size from 2725
      to 3191 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.285
      cpu time  : 0.457


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_AZ out=census_AZ;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 4086 observations were read from "CEN2010.cac_census_final_AZ"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_AZ" has 4086 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_AZ" has decreased its size from 4105 to
      3851 pages (a 7% reduction)
NOTE: Procedure sort step took :
      real time : 0.320
      cpu time  : 0.316


MPRINT(AGGREGATION):  data cen_AZ (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_AZ(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_AZ(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 4086 observations were read from "WORK.census_AZ"
NOTE: 650900 observations were read from "WORK.census_xref_AZ"
NOTE: Data set "WORK.cen_AZ" has 650900 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_AZ" has decreased its size from 10500 to
      9559 pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.859
      cpu time  : 0.859


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_AZ(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 518 observations were read from "WORK.cen_AZ"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_AZ" has 518 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_AZ" has increased its size from 10 to 11
      pages (a 10% increase)
NOTE: Procedure sort step took :
      real time : 0.166
      cpu time  : 0.170


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_AZ;
MPRINT(AGGREGATION):  merge cen_AZ (in=a) base_demo_AZ (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "AZ";
MPRINT(AGGREGATION):  run;

NOTE: 518 observations were read from "WORK.cen_AZ"
NOTE: 516 observations were read from "WORK.base_demo_AZ"
NOTE: Data set "WORK.for_buzzboard_AZ" has 508 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_AZ" has decreased its size from 86
      to 47 pages (a 46% reduction)
NOTE: The data step took :
      real time : 0.007
      cpu time  : 0.006


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_AZ base_demo_AZ;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_AZ" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_AZ" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_AR (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_AR;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 1798290 observations were read from "BASE.base_demo_AR"
NOTE: Data set "WORK.base_demo_AR" has 1798290 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_AR" has decreased its size from 29006
      to 25351 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 14.787
      cpu time  : 19.034


MPRINT(AGGREGATION):  data base_demo_AR (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_AR;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 1798290 observations were read from "WORK.base_demo_AR"
NOTE: Data set "WORK.base_demo_AR" has 689 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_AR" has decreased its size from 100 to
      46 pages (a 54% reduction)
NOTE: The data step took :
      real time : 2.629
      cpu time  : 2.629


MPRINT(AGGREGATION):  proc sort data = base_demo_AR;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 689 observations were read from "WORK.base_demo_AR"
NOTE: Data set "WORK.base_demo_AR" has 689 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_AR" has decreased its size from 100 to
      46 pages (a 54% reduction)
NOTE: Procedure sort step took :
      real time : 0.009
      cpu time  : 0.012


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_AR out=census_xref_AR;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 535455 observations were read from "CEN2010.cac_census_xref_AR"
NOTE: Data set "WORK.census_xref_AR" has 535455 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_AR" has increased its size from 2242
      to 2625 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.261
      cpu time  : 0.378


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_AR out=census_AR;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 2669 observations were read from "CEN2010.cac_census_final_AR"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_AR" has 2669 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_AR" has decreased its size from 2688 to
      2461 pages (a 9% reduction)
NOTE: Procedure sort step took :
      real time : 0.230
      cpu time  : 0.216


MPRINT(AGGREGATION):  data cen_AR (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_AR(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_AR(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 2669 observations were read from "WORK.census_AR"
NOTE: 535455 observations were read from "WORK.census_xref_AR"
NOTE: Data set "WORK.cen_AR" has 535455 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_AR" has decreased its size from 8638 to 7874
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.720
      cpu time  : 0.719


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_AR(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 695 observations were read from "WORK.cen_AR"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_AR" has 695 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_AR" has not changed its size of 13 pages
NOTE: Procedure sort step took :
      real time : 0.142
      cpu time  : 0.144


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_AR;
MPRINT(AGGREGATION):  merge cen_AR (in=a) base_demo_AR (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "AR";
MPRINT(AGGREGATION):  run;

NOTE: 695 observations were read from "WORK.cen_AR"
NOTE: 689 observations were read from "WORK.base_demo_AR"
NOTE: Data set "WORK.for_buzzboard_AR" has 687 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_AR" has decreased its size from
      116 to 56 pages (a 52% reduction)
NOTE: The data step took :
      real time : 0.008
      cpu time  : 0.008


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_AR base_demo_AR;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_AR" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_AR" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_CA (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_CA;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 20837915 observations were read from "BASE.base_demo_CA"
NOTE: Data set "WORK.base_demo_CA" has 20837915 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_CA" has decreased its size from 336097
      to 293962 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 3:22.647
      cpu time  : 4:10.430


MPRINT(AGGREGATION):  data base_demo_CA (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_CA;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 20837915 observations were read from "WORK.base_demo_CA"
NOTE: Data set "WORK.base_demo_CA" has 2384 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_CA" has decreased its size from 342 to
      185 pages (a 46% reduction)
NOTE: The data step took :
      real time : 31.362
      cpu time  : 30.072


MPRINT(AGGREGATION):  proc sort data = base_demo_CA;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 2384 observations were read from "WORK.base_demo_CA"
NOTE: Data set "WORK.base_demo_CA" has 2384 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_CA" has decreased its size from 342 to
      185 pages (a 46% reduction)
NOTE: Procedure sort step took :
      real time : 0.023
      cpu time  : 0.028


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_CA out=census_xref_CA;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 3137166 observations were read from "CEN2010.cac_census_xref_CA"
NOTE: Data set "WORK.census_xref_CA" has 3137166 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_CA" has increased its size from
      13128 to 15761 pages (a 21% increase)
NOTE: Procedure sort step took :
      real time : 1.321
      cpu time  : 2.409


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_CA out=census_CA;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 24560 observations were read from "CEN2010.cac_census_final_CA"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_CA" has 24560 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_CA" has decreased its size from 24579 to
      24163 pages (a 2% reduction)
NOTE: Procedure sort step took :
      real time : 1.723
      cpu time  : 1.834


MPRINT(AGGREGATION):  data cen_CA (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_CA(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_CA(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 24560 observations were read from "WORK.census_CA"
NOTE: 3137166 observations were read from "WORK.census_xref_CA"
NOTE: Data set "WORK.cen_CA" has 3137166 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_CA" has decreased its size from 50601 to
      46120 pages (a 9% reduction)
NOTE: The data step took :
      real time : 4.267
      cpu time  : 4.266


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_CA(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 2489 observations were read from "WORK.cen_CA"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_CA" has 2489 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_CA" has not changed its size of 42 pages
NOTE: Procedure sort step took :
      real time : 0.811
      cpu time  : 0.817


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_CA;
MPRINT(AGGREGATION):  merge cen_CA (in=a) base_demo_CA (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "CA";
MPRINT(AGGREGATION):  run;

NOTE: 2489 observations were read from "WORK.cen_CA"
NOTE: 2384 observations were read from "WORK.base_demo_CA"
NOTE: Data set "WORK.for_buzzboard_CA" has 2361 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_CA" has decreased its size from
      395 to 218 pages (a 45% reduction)
NOTE: The data step took :
      real time : 0.023
      cpu time  : 0.023


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_CA base_demo_CA;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_CA" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_CA" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_CO (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_CO;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 3694808 observations were read from "BASE.base_demo_CO"
NOTE: Data set "WORK.base_demo_CO" has 3694808 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_CO" has decreased its size from 59595
      to 52113 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 30.457
      cpu time  : 39.566


MPRINT(AGGREGATION):  data base_demo_CO (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_CO;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 3694808 observations were read from "WORK.base_demo_CO"
NOTE: Data set "WORK.base_demo_CO" has 598 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_CO" has decreased its size from 87 to
      44 pages (a 50% reduction)
NOTE: The data step took :
      real time : 5.311
      cpu time  : 5.310


MPRINT(AGGREGATION):  proc sort data = base_demo_CO;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 598 observations were read from "WORK.base_demo_CO"
NOTE: Data set "WORK.base_demo_CO" has 598 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_CO" has decreased its size from 87 to
      44 pages (a 50% reduction)
NOTE: Procedure sort step took :
      real time : 0.008
      cpu time  : 0.011


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_CO out=census_xref_CO;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 536715 observations were read from "CEN2010.cac_census_xref_CO"
NOTE: Data set "WORK.census_xref_CO" has 536715 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_CO" has increased its size from 2247
      to 2631 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.263
      cpu time  : 0.381


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_CO out=census_CO;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 3919 observations were read from "CEN2010.cac_census_final_CO"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_CO" has 3919 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_CO" has decreased its size from 3938 to
      3771 pages (a 5% reduction)
NOTE: Procedure sort step took :
      real time : 0.280
      cpu time  : 0.305


MPRINT(AGGREGATION):  data cen_CO (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_CO(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_CO(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 3919 observations were read from "WORK.census_CO"
NOTE: 536715 observations were read from "WORK.census_xref_CO"
NOTE: Data set "WORK.cen_CO" has 536715 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_CO" has decreased its size from 8658 to 7892
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.718
      cpu time  : 0.718


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_CO(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 638 observations were read from "WORK.cen_CO"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_CO" has 638 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_CO" has not changed its size of 12 pages
NOTE: Procedure sort step took :
      real time : 0.139
      cpu time  : 0.143


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_CO;
MPRINT(AGGREGATION):  merge cen_CO (in=a) base_demo_CO (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "CO";
MPRINT(AGGREGATION):  run;

NOTE: 638 observations were read from "WORK.cen_CO"
NOTE: 598 observations were read from "WORK.base_demo_CO"
NOTE: Data set "WORK.for_buzzboard_CO" has 596 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_CO" has decreased its size from
      101 to 53 pages (a 48% reduction)
NOTE: The data step took :
      real time : 0.007
      cpu time  : 0.007


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_CO base_demo_CO;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_CO" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_CO" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_CT (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_CT;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 2253295 observations were read from "BASE.base_demo_CT"
NOTE: Data set "WORK.base_demo_CT" has 2253295 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_CT" has decreased its size from 36345
      to 31773 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 19.628
      cpu time  : 24.391


MPRINT(AGGREGATION):  data base_demo_CT (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_CT;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 2253295 observations were read from "WORK.base_demo_CT"
NOTE: Data set "WORK.base_demo_CT" has 376 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_CT" has decreased its size from 55 to
      30 pages (a 46% reduction)
NOTE: The data step took :
      real time : 3.314
      cpu time  : 3.314


MPRINT(AGGREGATION):  proc sort data = base_demo_CT;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 376 observations were read from "WORK.base_demo_CT"
NOTE: Data set "WORK.base_demo_CT" has 376 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_CT" has decreased its size from 55 to
      30 pages (a 46% reduction)
NOTE: Procedure sort step took :
      real time : 0.007
      cpu time  : 0.009


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_CT out=census_xref_CT;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 323605 observations were read from "CEN2010.cac_census_xref_CT"
NOTE: Data set "WORK.census_xref_CT" has 323605 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_CT" has increased its size from 1355
      to 1586 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.159
      cpu time  : 0.236


4                                        The WPS System      10:48 Wednesday, July 29, 2015     

MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_CT out=census_CT;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 2853 observations were read from "CEN2010.cac_census_final_CT"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_CT" has 2853 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_CT" has decreased its size from 2872 to
      2818 pages (a 2% reduction)
NOTE: Procedure sort step took :
      real time : 0.219
      cpu time  : 0.236


MPRINT(AGGREGATION):  data cen_CT (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_CT(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_CT(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 2853 observations were read from "WORK.census_CT"
NOTE: 323605 observations were read from "WORK.census_xref_CT"
NOTE: Data set "WORK.cen_CT" has 323605 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_CT" has decreased its size from 5221 to 4766
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.456
      cpu time  : 0.455


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_CT(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 413 observations were read from "WORK.cen_CT"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_CT" has 413 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_CT" has increased its size from 8 to 9 pages
      (a 13% increase)
NOTE: Procedure sort step took :
      real time : 0.087
      cpu time  : 0.088


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_CT;
MPRINT(AGGREGATION):  merge cen_CT (in=a) base_demo_CT (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "CT";
MPRINT(AGGREGATION):  run;

NOTE: 413 observations were read from "WORK.cen_CT"
NOTE: 376 observations were read from "WORK.base_demo_CT"
NOTE: Data set "WORK.for_buzzboard_CT" has 372 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_CT" has decreased its size from 63
      to 35 pages (a 45% reduction)
NOTE: The data step took :
      real time : 0.005
      cpu time  : 0.005


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_CT base_demo_CT;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_CT" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_CT" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_DE (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_DE;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 568781 observations were read from "BASE.base_demo_DE"
NOTE: Data set "WORK.base_demo_DE" has 568781 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_DE" has decreased its size from 9175
      to 8021 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 4.968
      cpu time  : 6.083


MPRINT(AGGREGATION):  data base_demo_DE (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_DE;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 568781 observations were read from "WORK.base_demo_DE"
NOTE: Data set "WORK.base_demo_DE" has 80 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_DE" has decreased its size from 13 to
      9 pages (a 31% reduction)
NOTE: The data step took :
      real time : 0.830
      cpu time  : 0.829


MPRINT(AGGREGATION):  proc sort data = base_demo_DE;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 80 observations were read from "WORK.base_demo_DE"
NOTE: Data set "WORK.base_demo_DE" has 80 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_DE" has decreased its size from 13 to
      9 pages (a 31% reduction)
NOTE: Procedure sort step took :
      real time : 0.004
      cpu time  : 0.007


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_DE out=census_xref_DE;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 117577 observations were read from "CEN2010.cac_census_xref_DE"
NOTE: Data set "WORK.census_xref_DE" has 117577 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_DE" has increased its size from 493
      to 575 pages (a 17% increase)
NOTE: Procedure sort step took :
      real time : 0.080
      cpu time  : 0.094


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_DE out=census_DE;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 632 observations were read from "CEN2010.cac_census_final_DE"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_DE" has 632 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_DE" has decreased its size from 651 to
      622 pages (a 5% reduction)
NOTE: Procedure sort step took :
      real time : 0.054
      cpu time  : 0.059


MPRINT(AGGREGATION):  data cen_DE (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_DE(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_DE(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 632 observations were read from "WORK.census_DE"
NOTE: 117577 observations were read from "WORK.census_xref_DE"
NOTE: Data set "WORK.cen_DE" has 117577 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_DE" has decreased its size from 1898 to 1731
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.157
      cpu time  : 0.156


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_DE(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 86 observations were read from "WORK.cen_DE"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_DE" has 86 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_DE" has increased its size from 3 to 4 pages
      (a 34% increase)
NOTE: Procedure sort step took :
      real time : 0.033
      cpu time  : 0.036


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_DE;
MPRINT(AGGREGATION):  merge cen_DE (in=a) base_demo_DE (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "DE";
MPRINT(AGGREGATION):  run;

NOTE: 86 observations were read from "WORK.cen_DE"
NOTE: 80 observations were read from "WORK.base_demo_DE"
NOTE: Data set "WORK.for_buzzboard_DE" has 78 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_DE" has decreased its size from 14
      to 10 pages (a 29% reduction)
NOTE: The data step took :
      real time : 0.003
      cpu time  : 0.003


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_DE base_demo_DE;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_DE" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_DE" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_FL (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_FL;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 13914205 observations were read from "BASE.base_demo_FL"
NOTE: Data set "WORK.base_demo_FL" has 13914205 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_FL" has decreased its size from 224424
      to 196143 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 1:49.590
      cpu time  : 2:24.620


MPRINT(AGGREGATION):  data base_demo_FL (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_FL;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 13914205 observations were read from "WORK.base_demo_FL"
NOTE: Data set "WORK.base_demo_FL" has 1417 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_FL" has decreased its size from 204 to
      120 pages (a 42% reduction)
NOTE: The data step took :
      real time : 20.138
      cpu time  : 20.136


MPRINT(AGGREGATION):  proc sort data = base_demo_FL;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 1417 observations were read from "WORK.base_demo_FL"
NOTE: Data set "WORK.base_demo_FL" has 1417 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_FL" has decreased its size from 204 to
      120 pages (a 42% reduction)
NOTE: Procedure sort step took :
      real time : 0.015
      cpu time  : 0.020


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_FL out=census_xref_FL;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 2369646 observations were read from "CEN2010.cac_census_xref_FL"
NOTE: Data set "WORK.census_xref_FL" has 2369646 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_FL" has increased its size from 9916
      to 11730 pages (a 19% increase)
NOTE: Procedure sort step took :
      real time : 1.023
      cpu time  : 1.716


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_FL out=census_FL;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 12142 observations were read from "CEN2010.cac_census_final_FL"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_FL" has 12142 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_FL" has decreased its size from 12161 to
      11345 pages (a 7% reduction)
NOTE: Procedure sort step took :
      real time : 0.813
      cpu time  : 0.870


MPRINT(AGGREGATION):  data cen_FL (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_FL(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_FL(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 12142 observations were read from "WORK.census_FL"
NOTE: 2369646 observations were read from "WORK.census_xref_FL"
NOTE: Data set "WORK.cen_FL" has 2369646 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_FL" has decreased its size from 38222 to
      34848 pages (a 9% reduction)
NOTE: The data step took :
      real time : 3.122
      cpu time  : 3.123


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_FL(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 1459 observations were read from "WORK.cen_FL"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_FL" has 1459 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_FL" has increased its size from 25 to 26
      pages (a 4% increase)
NOTE: Procedure sort step took :
      real time : 0.602
      cpu time  : 0.606


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_FL;
MPRINT(AGGREGATION):  merge cen_FL (in=a) base_demo_FL (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "FL";
MPRINT(AGGREGATION):  run;

NOTE: 1459 observations were read from "WORK.cen_FL"
NOTE: 1417 observations were read from "WORK.base_demo_FL"
NOTE: Data set "WORK.for_buzzboard_FL" has 1410 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_FL" has decreased its size from
      236 to 141 pages (a 41% reduction)
NOTE: The data step took :
      real time : 0.015
      cpu time  : 0.015


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_FL base_demo_FL;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_FL" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_FL" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_GA (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_GA;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 6018814 observations were read from "BASE.base_demo_GA"
NOTE: Data set "WORK.base_demo_GA" has 6018814 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_GA" has decreased its size from 97079
      to 84966 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 0:48.679
      cpu time  : 1:03.278


MPRINT(AGGREGATION):  data base_demo_GA (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_GA;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 6018814 observations were read from "WORK.base_demo_GA"
NOTE: Data set "WORK.base_demo_GA" has 899 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_GA" has decreased its size from 130 to
      71 pages (a 46% reduction)
NOTE: The data step took :
      real time : 8.296
      cpu time  : 8.294


MPRINT(AGGREGATION):  proc sort data = base_demo_GA;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 899 observations were read from "WORK.base_demo_GA"
NOTE: Data set "WORK.base_demo_GA" has 899 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_GA" has decreased its size from 130 to
      71 pages (a 46% reduction)
NOTE: Procedure sort step took :
      real time : 0.012
      cpu time  : 0.014


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_GA out=census_xref_GA;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 1613367 observations were read from "CEN2010.cac_census_xref_GA"
NOTE: Data set "WORK.census_xref_GA" has 1613367 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_GA" has increased its size from 6752
      to 7909 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.692
      cpu time  : 1.146


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_GA out=census_GA;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 6183 observations were read from "CEN2010.cac_census_final_GA"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_GA" has 6183 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_GA" has decreased its size from 6202 to
      5900 pages (a 5% reduction)
NOTE: Procedure sort step took :
      real time : 0.446
      cpu time  : 0.479


MPRINT(AGGREGATION):  data cen_GA (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_GA(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_GA(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 6183 observations were read from "WORK.census_GA"
NOTE: 1613367 observations were read from "WORK.census_xref_GA"
NOTE: Data set "WORK.cen_GA" has 1613367 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_GA" has decreased its size from 26024 to
      23730 pages (a 9% reduction)
NOTE: The data step took :
      real time : 2.093
      cpu time  : 2.094


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_GA(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 932 observations were read from "WORK.cen_GA"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_GA" has 932 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_GA" has not changed its size of 17 pages
NOTE: Procedure sort step took :
      real time : 0.410
      cpu time  : 0.413


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_GA;
MPRINT(AGGREGATION):  merge cen_GA (in=a) base_demo_GA (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "GA";
MPRINT(AGGREGATION):  run;

NOTE: 932 observations were read from "WORK.cen_GA"
NOTE: 899 observations were read from "WORK.base_demo_GA"
NOTE: Data set "WORK.for_buzzboard_GA" has 894 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_GA" has decreased its size from
      150 to 83 pages (a 45% reduction)
NOTE: The data step took :
      real time : 0.010
      cpu time  : 0.010


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_GA base_demo_GA;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_GA" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_GA" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_HI (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_HI;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 602735 observations were read from "BASE.base_demo_HI"
NOTE: Data set "WORK.base_demo_HI" has 602735 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_HI" has decreased its size from 9723
      to 8503 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 4.993
      cpu time  : 6.088


MPRINT(AGGREGATION):  data base_demo_HI (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_HI;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 602735 observations were read from "WORK.base_demo_HI"
NOTE: Data set "WORK.base_demo_HI" has 128 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_HI" has decreased its size from 20 to
      12 pages (a 40% reduction)
NOTE: The data step took :
      real time : 0.882
      cpu time  : 0.882


MPRINT(AGGREGATION):  proc sort data = base_demo_HI;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 128 observations were read from "WORK.base_demo_HI"
NOTE: Data set "WORK.base_demo_HI" has 128 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_HI" has decreased its size from 20 to
      12 pages (a 40% reduction)
NOTE: Procedure sort step took :
      real time : 0.005
      cpu time  : 0.008


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_HI out=census_xref_HI;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 97524 observations were read from "CEN2010.cac_census_xref_HI"
NOTE: Data set "WORK.census_xref_HI" has 97524 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_HI" has increased its size from 410
      to 478 pages (a 17% increase)
NOTE: Procedure sort step took :
      real time : 0.065
      cpu time  : 0.074


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_HI out=census_HI;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 849 observations were read from "CEN2010.cac_census_final_HI"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_HI" has 849 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_HI" has decreased its size from 868 to
      838 pages (a 4% reduction)
NOTE: Procedure sort step took :
      real time : 0.071
      cpu time  : 0.079


MPRINT(AGGREGATION):  data cen_HI (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_HI(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_HI(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 849 observations were read from "WORK.census_HI"
NOTE: 97524 observations were read from "WORK.census_xref_HI"
NOTE: Data set "WORK.cen_HI" has 97524 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_HI" has decreased its size from 1574 to 1432
      pages (a 10% reduction)
NOTE: The data step took :
      real time : 0.135
      cpu time  : 0.134


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_HI(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 132 observations were read from "WORK.cen_HI"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_HI" has 132 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_HI" has increased its size from 4 to 5 pages
      (a 25% increase)
NOTE: Procedure sort step took :
      real time : 0.028
      cpu time  : 0.029


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_HI;
MPRINT(AGGREGATION):  merge cen_HI (in=a) base_demo_HI (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "HI";
MPRINT(AGGREGATION):  run;

NOTE: 132 observations were read from "WORK.cen_HI"
NOTE: 128 observations were read from "WORK.base_demo_HI"
NOTE: Data set "WORK.for_buzzboard_HI" has 128 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_HI" has decreased its size from 23
      to 13 pages (a 44% reduction)
NOTE: The data step took :
      real time : 0.003
      cpu time  : 0.003


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_HI base_demo_HI;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_HI" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_HI" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_ID (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_ID;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 972797 observations were read from "BASE.base_demo_ID"
NOTE: Data set "WORK.base_demo_ID" has 972797 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_ID" has decreased its size from 15692
      to 13712 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 8.492
      cpu time  : 10.264


MPRINT(AGGREGATION):  data base_demo_ID (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_ID;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
5                                        The WPS System      10:48 Wednesday, July 29, 2015     

MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 972797 observations were read from "WORK.base_demo_ID"
NOTE: Data set "WORK.base_demo_ID" has 304 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_ID" has decreased its size from 45 to
      22 pages (a 52% reduction)
NOTE: The data step took :
      real time : 1.421
      cpu time  : 1.420


MPRINT(AGGREGATION):  proc sort data = base_demo_ID;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 304 observations were read from "WORK.base_demo_ID"
NOTE: Data set "WORK.base_demo_ID" has 304 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_ID" has decreased its size from 45 to
      22 pages (a 52% reduction)
NOTE: Procedure sort step took :
      real time : 0.007
      cpu time  : 0.009


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_ID out=census_xref_ID;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 187921 observations were read from "CEN2010.cac_census_xref_ID"
NOTE: Data set "WORK.census_xref_ID" has 187921 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_ID" has increased its size from 788
      to 921 pages (a 17% increase)
NOTE: Procedure sort step took :
      real time : 0.099
      cpu time  : 0.139


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_ID out=census_ID;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 1206 observations were read from "CEN2010.cac_census_final_ID"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_ID" has 1206 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_ID" has decreased its size from 1225 to
      1176 pages (a 4% reduction)
NOTE: Procedure sort step took :
      real time : 0.093
      cpu time  : 0.100


MPRINT(AGGREGATION):  data cen_ID (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_ID(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_ID(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 1206 observations were read from "WORK.census_ID"
NOTE: 187921 observations were read from "WORK.census_xref_ID"
NOTE: Data set "WORK.cen_ID" has 187921 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_ID" has decreased its size from 3032 to 2764
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.252
      cpu time  : 0.251


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_ID(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 315 observations were read from "WORK.cen_ID"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_ID" has 315 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_ID" has not changed its size of 7 pages
NOTE: Procedure sort step took :
      real time : 0.051
      cpu time  : 0.052


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_ID;
MPRINT(AGGREGATION):  merge cen_ID (in=a) base_demo_ID (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "ID";
MPRINT(AGGREGATION):  run;

NOTE: 315 observations were read from "WORK.cen_ID"
NOTE: 304 observations were read from "WORK.base_demo_ID"
NOTE: Data set "WORK.for_buzzboard_ID" has 302 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_ID" has decreased its size from 52
      to 26 pages (a 50% reduction)
NOTE: The data step took :
      real time : 0.004
      cpu time  : 0.004


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_ID base_demo_ID;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_ID" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_ID" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_IL (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_IL;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 7261347 observations were read from "BASE.base_demo_IL"
NOTE: Data set "WORK.base_demo_IL" has 7261347 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_IL" has decreased its size from 117120
      to 102444 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 1:02.243
      cpu time  : 1:19.684


MPRINT(AGGREGATION):  data base_demo_IL (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_IL;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 7261347 observations were read from "WORK.base_demo_IL"
NOTE: Data set "WORK.base_demo_IL" has 1489 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_IL" has decreased its size from 214 to
      108 pages (a 50% reduction)
NOTE: The data step took :
      real time : 10.522
      cpu time  : 10.520


MPRINT(AGGREGATION):  proc sort data = base_demo_IL;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 1489 observations were read from "WORK.base_demo_IL"
NOTE: Data set "WORK.base_demo_IL" has 1489 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_IL" has decreased its size from 214 to
      108 pages (a 50% reduction)
NOTE: Procedure sort step took :
      real time : 0.015
      cpu time  : 0.019


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_IL out=census_xref_IL;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 1561910 observations were read from "CEN2010.cac_census_xref_IL"
NOTE: Data set "WORK.census_xref_IL" has 1561910 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_IL" has increased its size from 6537
      to 7715 pages (a 19% increase)
NOTE: Procedure sort step took :
      real time : 0.657
      cpu time  : 1.148


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_IL out=census_IL;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 10905 observations were read from "CEN2010.cac_census_final_IL"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_IL" has 10905 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_IL" has decreased its size from 10924 to
      10045 pages (a 9% reduction)
NOTE: Procedure sort step took :
      real time : 0.744
      cpu time  : 0.800


MPRINT(AGGREGATION):  data cen_IL (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_IL(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_IL(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 10905 observations were read from "WORK.census_IL"
NOTE: 1561910 observations were read from "WORK.census_xref_IL"
NOTE: Data set "WORK.cen_IL" has 1561910 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_IL" has decreased its size from 25194 to
      22973 pages (a 9% reduction)
NOTE: The data step took :
      real time : 2.020
      cpu time  : 2.020


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_IL(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 1549 observations were read from "WORK.cen_IL"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_IL" has 1549 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_IL" has not changed its size of 26 pages
NOTE: Procedure sort step took :
      real time : 0.411
      cpu time  : 0.416


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_IL;
MPRINT(AGGREGATION):  merge cen_IL (in=a) base_demo_IL (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "IL";
MPRINT(AGGREGATION):  run;

NOTE: 1549 observations were read from "WORK.cen_IL"
NOTE: 1489 observations were read from "WORK.base_demo_IL"
NOTE: Data set "WORK.for_buzzboard_IL" has 1481 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_IL" has decreased its size from
      248 to 129 pages (a 48% reduction)
NOTE: The data step took :
      real time : 0.015
      cpu time  : 0.014


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_IL base_demo_IL;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_IL" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_IL" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_IN (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_IN;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 3949207 observations were read from "BASE.base_demo_IN"
NOTE: Data set "WORK.base_demo_IN" has 3949207 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_IN" has decreased its size from 63698
      to 55677 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 33.773
      cpu time  : 43.139


MPRINT(AGGREGATION):  data base_demo_IN (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_IN;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 3949207 observations were read from "WORK.base_demo_IN"
NOTE: Data set "WORK.base_demo_IN" has 933 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_IN" has decreased its size from 135 to
      70 pages (a 49% reduction)
NOTE: The data step took :
      real time : 5.454
      cpu time  : 5.453


MPRINT(AGGREGATION):  proc sort data = base_demo_IN;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 933 observations were read from "WORK.base_demo_IN"
NOTE: Data set "WORK.base_demo_IN" has 933 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_IN" has decreased its size from 135 to
      70 pages (a 49% reduction)
NOTE: Procedure sort step took :
      real time : 0.012
      cpu time  : 0.015


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_IN out=census_xref_IN;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 978694 observations were read from "CEN2010.cac_census_xref_IN"
NOTE: Data set "WORK.census_xref_IN" has 978694 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_IN" has increased its size from 4096
      to 4799 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.431
      cpu time  : 0.712


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_IN out=census_IN;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 5515 observations were read from "CEN2010.cac_census_final_IN"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_IN" has 5515 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_IN" has decreased its size from 5534 to
      4840 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 0.376
      cpu time  : 0.408


MPRINT(AGGREGATION):  data cen_IN (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_IN(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_IN(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 5515 observations were read from "WORK.census_IN"
NOTE: 978694 observations were read from "WORK.census_xref_IN"
NOTE: Data set "WORK.cen_IN" has 978694 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_IN" has decreased its size from 15787 to
      14401 pages (a 9% reduction)
NOTE: The data step took :
      real time : 1.223
      cpu time  : 1.222


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_IN(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 968 observations were read from "WORK.cen_IN"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_IN" has 968 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_IN" has not changed its size of 17 pages
NOTE: Procedure sort step took :
      real time : 0.237
      cpu time  : 0.240


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_IN;
MPRINT(AGGREGATION):  merge cen_IN (in=a) base_demo_IN (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "IN";
MPRINT(AGGREGATION):  run;

NOTE: 968 observations were read from "WORK.cen_IN"
NOTE: 933 observations were read from "WORK.base_demo_IN"
NOTE: Data set "WORK.for_buzzboard_IN" has 929 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_IN" has decreased its size from
      156 to 83 pages (a 47% reduction)
NOTE: The data step took :
      real time : 0.010
      cpu time  : 0.009


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_IN base_demo_IN;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_IN" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_IN" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_IA (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_IA;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 1880061 observations were read from "BASE.base_demo_IA"
NOTE: Data set "WORK.base_demo_IA" has 1880061 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_IA" has decreased its size from 30325
      to 26504 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 15.580
      cpu time  : 19.827


MPRINT(AGGREGATION):  data base_demo_IA (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_IA;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 1880061 observations were read from "WORK.base_demo_IA"
NOTE: Data set "WORK.base_demo_IA" has 1003 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_IA" has decreased its size from 145 to
      65 pages (a 56% reduction)
NOTE: The data step took :
      real time : 2.598
      cpu time  : 2.598


MPRINT(AGGREGATION):  proc sort data = base_demo_IA;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 1003 observations were read from "WORK.base_demo_IA"
NOTE: Data set "WORK.base_demo_IA" has 1003 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_IA" has decreased its size from 145 to
      65 pages (a 56% reduction)
NOTE: Procedure sort step took :
      real time : 0.011
      cpu time  : 0.016


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_IA out=census_xref_IA;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 492645 observations were read from "CEN2010.cac_census_xref_IA"
NOTE: Data set "WORK.census_xref_IA" has 492645 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_IA" has increased its size from 2063
      to 2416 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.236
      cpu time  : 0.357


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_IA out=census_IA;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 3544 observations were read from "CEN2010.cac_census_final_IA"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_IA" has 3544 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_IA" has decreased its size from 3563 to
      3315 pages (a 7% reduction)
NOTE: Procedure sort step took :
      real time : 0.254
      cpu time  : 0.275


MPRINT(AGGREGATION):  data cen_IA (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_IA(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_IA(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 3544 observations were read from "WORK.census_IA"
NOTE: 492645 observations were read from "WORK.census_xref_IA"
NOTE: Data set "WORK.cen_IA" has 492645 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_IA" has decreased its size from 7947 to 7256
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.660
      cpu time  : 0.660


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_IA(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 1029 observations were read from "WORK.cen_IA"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_IA" has 1029 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_IA" has not changed its size of 18 pages
NOTE: Procedure sort step took :
      real time : 0.126
      cpu time  : 0.129


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_IA;
MPRINT(AGGREGATION):  merge cen_IA (in=a) base_demo_IA (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "IA";
MPRINT(AGGREGATION):  run;

NOTE: 1029 observations were read from "WORK.cen_IA"
NOTE: 1003 observations were read from "WORK.base_demo_IA"
NOTE: Data set "WORK.for_buzzboard_IA" has 1001 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_IA" has decreased its size from
      168 to 79 pages (a 53% reduction)
NOTE: The data step took :
      real time : 0.010
      cpu time  : 0.010


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_IA base_demo_IA;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_IA" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_IA" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_KS (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_KS;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 1347676 observations were read from "BASE.base_demo_KS"
NOTE: Data set "WORK.base_demo_KS" has 1347676 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_KS" has decreased its size from 21738
      to 18982 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 11.582
      cpu time  : 13.772


MPRINT(AGGREGATION):  data base_demo_KS (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_KS;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 1347676 observations were read from "WORK.base_demo_KS"
NOTE: Data set "WORK.base_demo_KS" has 732 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_KS" has decreased its size from 106 to
      47 pages (a 56% reduction)
NOTE: The data step took :
      real time : 1.965
      cpu time  : 1.964


MPRINT(AGGREGATION):  proc sort data = base_demo_KS;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 732 observations were read from "WORK.base_demo_KS"
NOTE: Data set "WORK.base_demo_KS" has 732 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_KS" has decreased its size from 106 to
      47 pages (a 56% reduction)
NOTE: Procedure sort step took :
      real time : 0.008
      cpu time  : 0.012


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_KS out=census_xref_KS;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 433494 observations were read from "CEN2010.cac_census_xref_KS"
NOTE: Data set "WORK.census_xref_KS" has 433494 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_KS" has increased its size from 1815
      to 2126 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.202
      cpu time  : 0.309


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_KS out=census_KS;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 3034 observations were read from "CEN2010.cac_census_final_KS"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_KS" has 3034 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_KS" has decreased its size from 3053 to
      2893 pages (a 6% reduction)
NOTE: Procedure sort step took :
      real time : 0.227
      cpu time  : 0.243


MPRINT(AGGREGATION):  data cen_KS (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_KS(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_KS(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 3034 observations were read from "WORK.census_KS"
NOTE: 433494 observations were read from "WORK.census_xref_KS"
NOTE: Data set "WORK.cen_KS" has 433494 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_KS" has decreased its size from 6993 to 6364
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.593
      cpu time  : 0.593


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_KS(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 742 observations were read from "WORK.cen_KS"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_KS" has 742 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_KS" has increased its size from 13 to 14
      pages (a 8% increase)
NOTE: Procedure sort step took :
      real time : 0.115
      cpu time  : 0.116


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_KS;
MPRINT(AGGREGATION):  merge cen_KS (in=a) base_demo_KS (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "KS";
MPRINT(AGGREGATION):  run;

NOTE: 742 observations were read from "WORK.cen_KS"
NOTE: 732 observations were read from "WORK.base_demo_KS"
NOTE: Data set "WORK.for_buzzboard_KS" has 730 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_KS" has decreased its size from
      123 to 56 pages (a 55% reduction)
NOTE: The data step took :
      real time : 0.008
      cpu time  : 0.008


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_KS base_demo_KS;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_KS" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_KS" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_KY (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_KY;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 2664501 observations were read from "BASE.base_demo_KY"
NOTE: Data set "WORK.base_demo_KY" has 2664501 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_KY" has decreased its size from 42977
      to 37537 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 38.856
      cpu time  : 28.248

6                                        The WPS System      10:48 Wednesday, July 29, 2015     


MPRINT(AGGREGATION):  data base_demo_KY (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_KY;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 2664501 observations were read from "WORK.base_demo_KY"
NOTE: Data set "WORK.base_demo_KY" has 911 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_KY" has decreased its size from 132 to
      60 pages (a 55% reduction)
NOTE: The data step took :
      real time : 3.859
      cpu time  : 3.858


MPRINT(AGGREGATION):  proc sort data = base_demo_KY;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 911 observations were read from "WORK.base_demo_KY"
NOTE: Data set "WORK.base_demo_KY" has 911 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_KY" has decreased its size from 132 to
      60 pages (a 55% reduction)
NOTE: Procedure sort step took :
      real time : 0.010
      cpu time  : 0.011


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_KY out=census_xref_KY;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 673430 observations were read from "CEN2010.cac_census_xref_KY"
NOTE: Data set "WORK.census_xref_KY" has 673430 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_KY" has increased its size from 2819
      to 3303 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.294
      cpu time  : 0.471


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_KY out=census_KY;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 3982 observations were read from "CEN2010.cac_census_final_KY"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_KY" has 3982 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_KY" has decreased its size from 4001 to
      3302 pages (a 18% reduction)
NOTE: Procedure sort step took :
      real time : 0.287
      cpu time  : 0.306


MPRINT(AGGREGATION):  data cen_KY (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_KY(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_KY(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 3982 observations were read from "WORK.census_KY"
NOTE: 673430 observations were read from "WORK.census_xref_KY"
NOTE: Data set "WORK.cen_KY" has 673430 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_KY" has decreased its size from 10863 to
      9897 pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.916
      cpu time  : 0.916


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_KY(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 932 observations were read from "WORK.cen_KY"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_KY" has 932 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_KY" has not changed its size of 17 pages
NOTE: Procedure sort step took :
      real time : 0.170
      cpu time  : 0.172


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_KY;
MPRINT(AGGREGATION):  merge cen_KY (in=a) base_demo_KY (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "KY";
MPRINT(AGGREGATION):  run;

NOTE: 932 observations were read from "WORK.cen_KY"
NOTE: 911 observations were read from "WORK.base_demo_KY"
NOTE: Data set "WORK.for_buzzboard_KY" has 908 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_KY" has decreased its size from
      153 to 73 pages (a 53% reduction)
NOTE: The data step took :
      real time : 0.010
      cpu time  : 0.009


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_KY base_demo_KY;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_KY" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_KY" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.000


MPRINT(AGGREGATION):  proc sort data = base.base_demo_LA (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_LA;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 2740171 observations were read from "BASE.base_demo_LA"
NOTE: Data set "WORK.base_demo_LA" has 2740171 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_LA" has decreased its size from 44198
      to 38628 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 23.059
      cpu time  : 28.692


MPRINT(AGGREGATION):  data base_demo_LA (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_LA;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 2740171 observations were read from "WORK.base_demo_LA"
NOTE: Data set "WORK.base_demo_LA" has 677 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_LA" has decreased its size from 98 to
      52 pages (a 47% reduction)
NOTE: The data step took :
      real time : 4.048
      cpu time  : 4.046


MPRINT(AGGREGATION):  proc sort data = base_demo_LA;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 677 observations were read from "WORK.base_demo_LA"
NOTE: Data set "WORK.base_demo_LA" has 677 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_LA" has decreased its size from 98 to
      52 pages (a 47% reduction)
NOTE: Procedure sort step took :
      real time : 0.009
      cpu time  : 0.012


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_LA out=census_xref_LA;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 711203 observations were read from "CEN2010.cac_census_xref_LA"
NOTE: Data set "WORK.census_xref_LA" has 711203 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_LA" has increased its size from 2977
      to 3485 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.338
      cpu time  : 0.511


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_LA out=census_LA;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 3925 observations were read from "CEN2010.cac_census_final_LA"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_LA" has 3925 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_LA" has decreased its size from 3944 to
      3474 pages (a 12% reduction)
NOTE: Procedure sort step took :
      real time : 0.318
      cpu time  : 0.311


MPRINT(AGGREGATION):  data cen_LA (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_LA(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_LA(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 3925 observations were read from "WORK.census_LA"
NOTE: 711203 observations were read from "WORK.census_xref_LA"
NOTE: Data set "WORK.cen_LA" has 711203 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_LA" has decreased its size from 11473 to
      10447 pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.951
      cpu time  : 0.951


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_LA(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 702 observations were read from "WORK.cen_LA"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_LA" has 702 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_LA" has not changed its size of 13 pages
NOTE: Procedure sort step took :
      real time : 0.185
      cpu time  : 0.188


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_LA;
MPRINT(AGGREGATION):  merge cen_LA (in=a) base_demo_LA (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "LA";
MPRINT(AGGREGATION):  run;

NOTE: 702 observations were read from "WORK.cen_LA"
NOTE: 677 observations were read from "WORK.base_demo_LA"
NOTE: Data set "WORK.for_buzzboard_LA" has 675 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_LA" has decreased its size from
      114 to 62 pages (a 46% reduction)
NOTE: The data step took :
      real time : 0.009
      cpu time  : 0.008


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_LA base_demo_LA;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_LA" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_LA" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_ME (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_ME;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 876513 observations were read from "BASE.base_demo_ME"
NOTE: Data set "WORK.base_demo_ME" has 876513 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_ME" has decreased its size from 14139
      to 12355 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 7.663
      cpu time  : 9.443


MPRINT(AGGREGATION):  data base_demo_ME (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_ME;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 876513 observations were read from "WORK.base_demo_ME"
NOTE: Data set "WORK.base_demo_ME" has 475 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_ME" has decreased its size from 69 to
      34 pages (a 51% reduction)
NOTE: The data step took :
      real time : 1.309
      cpu time  : 1.308


MPRINT(AGGREGATION):  proc sort data = base_demo_ME;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 475 observations were read from "WORK.base_demo_ME"
NOTE: Data set "WORK.base_demo_ME" has 475 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_ME" has decreased its size from 69 to
      34 pages (a 51% reduction)
NOTE: Procedure sort step took :
      real time : 0.009
      cpu time  : 0.011


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_ME out=census_xref_ME;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 252850 observations were read from "CEN2010.cac_census_xref_ME"
NOTE: Data set "WORK.census_xref_ME" has 252850 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_ME" has increased its size from 1059
      to 1239 pages (a 17% increase)
NOTE: Procedure sort step took :
      real time : 0.136
      cpu time  : 0.187


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_ME out=census_ME;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 1454 observations were read from "CEN2010.cac_census_final_ME"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_ME" has 1454 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_ME" has decreased its size from 1473 to
      1370 pages (a 7% reduction)
NOTE: Procedure sort step took :
      real time : 0.125
      cpu time  : 0.124


MPRINT(AGGREGATION):  data cen_ME (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_ME(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_ME(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 1454 observations were read from "WORK.census_ME"
NOTE: 252850 observations were read from "WORK.census_xref_ME"
NOTE: Data set "WORK.cen_ME" has 252850 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_ME" has decreased its size from 4080 to 3718
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.326
      cpu time  : 0.325


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_ME(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 481 observations were read from "WORK.cen_ME"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_ME" has 481 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_ME" has increased its size from 9 to 10
      pages (a 12% increase)
NOTE: Procedure sort step took :
      real time : 0.065
      cpu time  : 0.067


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_ME;
MPRINT(AGGREGATION):  merge cen_ME (in=a) base_demo_ME (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "ME";
MPRINT(AGGREGATION):  run;

NOTE: 481 observations were read from "WORK.cen_ME"
NOTE: 475 observations were read from "WORK.base_demo_ME"
NOTE: Data set "WORK.for_buzzboard_ME" has 472 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_ME" has decreased its size from 80
      to 41 pages (a 49% reduction)
NOTE: The data step took :
      real time : 0.006
      cpu time  : 0.005


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_ME base_demo_ME;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_ME" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_ME" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_MD (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_MD;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 3462672 observations were read from "BASE.base_demo_MD"
NOTE: Data set "WORK.base_demo_MD" has 3462672 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MD" has decreased its size from 55851
      to 48950 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 28.611
      cpu time  : 35.261


MPRINT(AGGREGATION):  data base_demo_MD (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_MD;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 3462672 observations were read from "WORK.base_demo_MD"
NOTE: Data set "WORK.base_demo_MD" has 560 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MD" has decreased its size from 81 to
      43 pages (a 47% reduction)
NOTE: The data step took :
      real time : 4.962
      cpu time  : 4.962


MPRINT(AGGREGATION):  proc sort data = base_demo_MD;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 560 observations were read from "WORK.base_demo_MD"
NOTE: Data set "WORK.base_demo_MD" has 560 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MD" has decreased its size from 81 to
      43 pages (a 47% reduction)
NOTE: Procedure sort step took :
      real time : 0.009
      cpu time  : 0.011


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_MD out=census_xref_MD;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 521071 observations were read from "CEN2010.cac_census_xref_MD"
NOTE: Data set "WORK.census_xref_MD" has 521071 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_MD" has increased its size from 2182
      to 2555 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.247
      cpu time  : 0.376


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_MD out=census_MD;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 4324 observations were read from "CEN2010.cac_census_final_MD"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_MD" has 4324 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_MD" has decreased its size from 4343 to
      4037 pages (a 8% reduction)
NOTE: Procedure sort step took :
      real time : 0.353
      cpu time  : 0.349


MPRINT(AGGREGATION):  data cen_MD (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_MD(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_MD(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 4324 observations were read from "WORK.census_MD"
NOTE: 521071 observations were read from "WORK.census_xref_MD"
NOTE: Data set "WORK.cen_MD" has 521071 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_MD" has decreased its size from 8406 to 7671
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.720
      cpu time  : 0.720


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_MD(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 590 observations were read from "WORK.cen_MD"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_MD" has 590 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_MD" has increased its size from 11 to 12
      pages (a 10% increase)
NOTE: Procedure sort step took :
      real time : 0.137
      cpu time  : 0.140


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_MD;
MPRINT(AGGREGATION):  merge cen_MD (in=a) base_demo_MD (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "MD";
MPRINT(AGGREGATION):  run;

NOTE: 590 observations were read from "WORK.cen_MD"
NOTE: 560 observations were read from "WORK.base_demo_MD"
NOTE: Data set "WORK.for_buzzboard_MD" has 557 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_MD" has decreased its size from 94
      to 51 pages (a 46% reduction)
NOTE: The data step took :
      real time : 0.007
      cpu time  : 0.007


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_MD base_demo_MD;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_MD" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_MD" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.000


MPRINT(AGGREGATION):  proc sort data = base.base_demo_MA (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_MA;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 4355275 observations were read from "BASE.base_demo_MA"
NOTE: Data set "WORK.base_demo_MA" has 4355275 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MA" has decreased its size from 70248
      to 61451 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 38.854
      cpu time  : 45.430


MPRINT(AGGREGATION):  data base_demo_MA (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_MA;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 4355275 observations were read from "WORK.base_demo_MA"
NOTE: Data set "WORK.base_demo_MA" has 648 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MA" has decreased its size from 94 to
      54 pages (a 43% reduction)
NOTE: The data step took :
      real time : 6.378
      cpu time  : 6.379


MPRINT(AGGREGATION):  proc sort data = base_demo_MA;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 648 observations were read from "WORK.base_demo_MA"
NOTE: Data set "WORK.base_demo_MA" has 648 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MA" has decreased its size from 94 to
      54 pages (a 43% reduction)
NOTE: Procedure sort step took :
      real time : 0.008
      cpu time  : 0.010


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_MA out=census_xref_MA;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 649844 observations were read from "CEN2010.cac_census_xref_MA"
NOTE: Data set "WORK.census_xref_MA" has 649844 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_MA" has increased its size from 2721
      to 3186 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.307
      cpu time  : 0.465


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_MA out=census_MA;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 5483 observations were read from "CEN2010.cac_census_final_MA"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_MA" has 5483 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_MA" has decreased its size from 5502 to
      5274 pages (a 5% reduction)
NOTE: Procedure sort step took :
      real time : 0.426
      cpu time  : 0.440


MPRINT(AGGREGATION):  data cen_MA (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_MA(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_MA(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 5483 observations were read from "WORK.census_MA"
NOTE: 649844 observations were read from "WORK.census_xref_MA"
NOTE: Data set "WORK.cen_MA" has 649844 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_MA" has decreased its size from 10483 to
      9564 pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.892
      cpu time  : 0.891


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_MA(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 681 observations were read from "WORK.cen_MA"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_MA" has 681 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_MA" has increased its size from 12 to 13
      pages (a 9% increase)
NOTE: Procedure sort step took :
      real time : 0.164
      cpu time  : 0.168


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_MA;
MPRINT(AGGREGATION):  merge cen_MA (in=a) base_demo_MA (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "MA";
MPRINT(AGGREGATION):  run;
7                                        The WPS System      10:48 Wednesday, July 29, 2015     


NOTE: 681 observations were read from "WORK.cen_MA"
NOTE: 648 observations were read from "WORK.base_demo_MA"
NOTE: Data set "WORK.for_buzzboard_MA" has 645 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_MA" has decreased its size from
      109 to 63 pages (a 43% reduction)
NOTE: The data step took :
      real time : 0.008
      cpu time  : 0.008


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_MA base_demo_MA;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_MA" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_MA" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_MI (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_MI;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 6657859 observations were read from "BASE.base_demo_MI"
NOTE: Data set "WORK.base_demo_MI" has 6657859 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MI" has decreased its size from 107386
      to 93842 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 0:57.105
      cpu time  : 1:12.031


MPRINT(AGGREGATION):  data base_demo_MI (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_MI;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 6657859 observations were read from "WORK.base_demo_MI"
NOTE: Data set "WORK.base_demo_MI" has 1101 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MI" has decreased its size from 159 to
      85 pages (a 47% reduction)
NOTE: The data step took :
      real time : 10.468
      cpu time  : 9.824


MPRINT(AGGREGATION):  proc sort data = base_demo_MI;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 1101 observations were read from "WORK.base_demo_MI"
NOTE: Data set "WORK.base_demo_MI" has 1101 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MI" has decreased its size from 159 to
      85 pages (a 47% reduction)
NOTE: Procedure sort step took :
      real time : 0.013
      cpu time  : 0.016


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_MI out=census_xref_MI;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 1227114 observations were read from "CEN2010.cac_census_xref_MI"
NOTE: Data set "WORK.census_xref_MI" has 1227114 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_MI" has increased its size from 5136
      to 6025 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.543
      cpu time  : 0.894


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_MI out=census_MI;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 9061 observations were read from "CEN2010.cac_census_final_MI"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_MI" has 9061 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_MI" has decreased its size from 9080 to
      8022 pages (a 12% reduction)
NOTE: Procedure sort step took :
      real time : 0.672
      cpu time  : 0.695


MPRINT(AGGREGATION):  data cen_MI (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_MI(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_MI(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 9061 observations were read from "WORK.census_MI"
NOTE: 1227114 observations were read from "WORK.census_xref_MI"
NOTE: Data set "WORK.cen_MI" has 1227114 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_MI" has decreased its size from 19794 to
      18032 pages (a 9% reduction)
NOTE: The data step took :
      real time : 1.598
      cpu time  : 1.594


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_MI(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 1147 observations were read from "WORK.cen_MI"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_MI" has 1147 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_MI" has not changed its size of 20 pages
NOTE: Procedure sort step took :
      real time : 0.289
      cpu time  : 0.292


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_MI;
MPRINT(AGGREGATION):  merge cen_MI (in=a) base_demo_MI (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "MI";
MPRINT(AGGREGATION):  run;

NOTE: 1147 observations were read from "WORK.cen_MI"
NOTE: 1101 observations were read from "WORK.base_demo_MI"
NOTE: Data set "WORK.for_buzzboard_MI" has 1095 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_MI" has decreased its size from
      184 to 100 pages (a 46% reduction)
NOTE: The data step took :
      real time : 0.012
      cpu time  : 0.011


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_MI base_demo_MI;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_MI" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_MI" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_MN (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_MN;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 3486226 observations were read from "BASE.base_demo_MN"
NOTE: Data set "WORK.base_demo_MN" has 3486226 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MN" has decreased its size from 56231
      to 49150 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 28.179
      cpu time  : 36.434


MPRINT(AGGREGATION):  data base_demo_MN (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_MN;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 3486226 observations were read from "WORK.base_demo_MN"
NOTE: Data set "WORK.base_demo_MN" has 951 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MN" has decreased its size from 137 to
      64 pages (a 54% reduction)
NOTE: The data step took :
      real time : 5.107
      cpu time  : 5.106


MPRINT(AGGREGATION):  proc sort data = base_demo_MN;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 951 observations were read from "WORK.base_demo_MN"
NOTE: Data set "WORK.base_demo_MN" has 951 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MN" has decreased its size from 137 to
      64 pages (a 54% reduction)
NOTE: Procedure sort step took :
      real time : 0.011
      cpu time  : 0.013


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_MN out=census_xref_MN;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 751564 observations were read from "CEN2010.cac_census_xref_MN"
NOTE: Data set "WORK.census_xref_MN" has 751564 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_MN" has increased its size from 3146
      to 3685 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.341
      cpu time  : 0.540


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_MN out=census_MN;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 4956 observations were read from "CEN2010.cac_census_final_MN"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_MN" has 4956 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_MN" has decreased its size from 4975 to
      4816 pages (a 4% reduction)
NOTE: Procedure sort step took :
      real time : 0.376
      cpu time  : 0.394


MPRINT(AGGREGATION):  data cen_MN (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_MN(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_MN(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 4956 observations were read from "WORK.census_MN"
NOTE: 751564 observations were read from "WORK.census_xref_MN"
NOTE: Data set "WORK.cen_MN" has 751564 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_MN" has decreased its size from 12123 to
      11068 pages (a 9% reduction)
NOTE: The data step took :
      real time : 5.477
      cpu time  : 1.022


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_MN(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 948 observations were read from "WORK.cen_MN"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_MN" has 948 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_MN" has not changed its size of 17 pages
NOTE: Procedure sort step took :
      real time : 0.189
      cpu time  : 0.191


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_MN;
MPRINT(AGGREGATION):  merge cen_MN (in=a) base_demo_MN (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "MN";
MPRINT(AGGREGATION):  run;

NOTE: 948 observations were read from "WORK.cen_MN"
NOTE: 951 observations were read from "WORK.base_demo_MN"
NOTE: Data set "WORK.for_buzzboard_MN" has 926 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_MN" has decreased its size from
      156 to 77 pages (a 51% reduction)
NOTE: The data step took :
      real time : 0.010
      cpu time  : 0.009


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_MN base_demo_MN;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_MN" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_MN" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_MS (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_MS;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 1615911 observations were read from "BASE.base_demo_MS"
NOTE: Data set "WORK.base_demo_MS" has 1615911 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MS" has decreased its size from 26065
      to 22782 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 13.667
      cpu time  : 16.592


MPRINT(AGGREGATION):  data base_demo_MS (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_MS;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 1615911 observations were read from "WORK.base_demo_MS"
NOTE: Data set "WORK.base_demo_MS" has 515 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MS" has decreased its size from 75 to
      36 pages (a 52% reduction)
NOTE: The data step took :
      real time : 2.357
      cpu time  : 2.357


MPRINT(AGGREGATION):  proc sort data = base_demo_MS;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 515 observations were read from "WORK.base_demo_MS"
NOTE: Data set "WORK.base_demo_MS" has 515 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MS" has decreased its size from 75 to
      36 pages (a 52% reduction)
NOTE: Procedure sort step took :
      real time : 0.008
      cpu time  : 0.010


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_MS out=census_xref_MS;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 519960 observations were read from "CEN2010.cac_census_xref_MS"
NOTE: Data set "WORK.census_xref_MS" has 519960 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_MS" has increased its size from 2177
      to 2547 pages (a 17% increase)
NOTE: Procedure sort step took :
      real time : 0.235
      cpu time  : 0.369


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_MS out=census_MS;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 2521 observations were read from "CEN2010.cac_census_final_MS"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_MS" has 2521 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_MS" has decreased its size from 2540 to
      2233 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 0.214
      cpu time  : 0.200


MPRINT(AGGREGATION):  data cen_MS (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_MS(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_MS(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 2521 observations were read from "WORK.census_MS"
NOTE: 519960 observations were read from "WORK.census_xref_MS"
NOTE: Data set "WORK.cen_MS" has 519960 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_MS" has decreased its size from 8388 to 7642
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.702
      cpu time  : 0.701


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_MS(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 526 observations were read from "WORK.cen_MS"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_MS" has 526 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_MS" has increased its size from 10 to 11
      pages (a 10% increase)
NOTE: Procedure sort step took :
      real time : 0.135
      cpu time  : 0.137


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_MS;
MPRINT(AGGREGATION):  merge cen_MS (in=a) base_demo_MS (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "MS";
MPRINT(AGGREGATION):  run;

NOTE: 526 observations were read from "WORK.cen_MS"
NOTE: 515 observations were read from "WORK.base_demo_MS"
NOTE: Data set "WORK.for_buzzboard_MS" has 515 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_MS" has decreased its size from 87
      to 44 pages (a 50% reduction)
NOTE: The data step took :
      real time : 0.007
      cpu time  : 0.006


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_MS base_demo_MS;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_MS" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_MS" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.000


MPRINT(AGGREGATION):  proc sort data = base.base_demo_MO (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_MO;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 3663268 observations were read from "BASE.base_demo_MO"
NOTE: Data set "WORK.base_demo_MO" has 3663268 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MO" has decreased its size from 59086
      to 51653 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 30.877
      cpu time  : 39.392


MPRINT(AGGREGATION):  data base_demo_MO (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_MO;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 3663268 observations were read from "WORK.base_demo_MO"
NOTE: Data set "WORK.base_demo_MO" has 1107 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MO" has decreased its size from 160 to
      75 pages (a 54% reduction)
NOTE: The data step took :
      real time : 5.054
      cpu time  : 5.053


MPRINT(AGGREGATION):  proc sort data = base_demo_MO;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 1107 observations were read from "WORK.base_demo_MO"
NOTE: Data set "WORK.base_demo_MO" has 1107 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MO" has decreased its size from 160 to
      75 pages (a 54% reduction)
NOTE: Procedure sort step took :
      real time : 0.011
      cpu time  : 0.014


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_MO out=census_xref_MO;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 884869 observations were read from "CEN2010.cac_census_xref_MO"
NOTE: Data set "WORK.census_xref_MO" has 884869 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_MO" has increased its size from 3704
      to 4340 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.376
      cpu time  : 0.603


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_MO out=census_MO;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 5348 observations were read from "CEN2010.cac_census_final_MO"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_MO" has 5348 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_MO" has decreased its size from 5367 to
      4896 pages (a 9% reduction)
NOTE: Procedure sort step took :
      real time : 0.395
      cpu time  : 0.392


MPRINT(AGGREGATION):  data cen_MO (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_MO(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_MO(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 5348 observations were read from "WORK.census_MO"
NOTE: 884869 observations were read from "WORK.census_xref_MO"
NOTE: Data set "WORK.cen_MO" has 884869 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_MO" has decreased its size from 14274 to
      13008 pages (a 9% reduction)
NOTE: The data step took :
      real time : 1.109
      cpu time  : 1.108


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_MO(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 1132 observations were read from "WORK.cen_MO"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_MO" has 1132 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_MO" has not changed its size of 20 pages
NOTE: Procedure sort step took :
      real time : 0.208
      cpu time  : 0.211


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_MO;
MPRINT(AGGREGATION):  merge cen_MO (in=a) base_demo_MO (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "MO";
MPRINT(AGGREGATION):  run;

NOTE: 1132 observations were read from "WORK.cen_MO"
NOTE: 1107 observations were read from "WORK.base_demo_MO"
NOTE: Data set "WORK.for_buzzboard_MO" has 1101 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_MO" has decreased its size from
      185 to 91 pages (a 51% reduction)
NOTE: The data step took :
      real time : 0.010
      cpu time  : 0.010


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_MO base_demo_MO;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_MO" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_MO" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_MT (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_MT;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 650438 observations were read from "BASE.base_demo_MT"
NOTE: Data set "WORK.base_demo_MT" has 650438 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MT" has decreased its size from 10492
      to 9155 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 5.244
      cpu time  : 6.322


MPRINT(AGGREGATION):  data base_demo_MT (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_MT;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 650438 observations were read from "WORK.base_demo_MT"
NOTE: Data set "WORK.base_demo_MT" has 392 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MT" has decreased its size from 57 to
      24 pages (a 58% reduction)
NOTE: The data step took :
      real time : 0.900
      cpu time  : 0.900


MPRINT(AGGREGATION):  proc sort data = base_demo_MT;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 392 observations were read from "WORK.base_demo_MT"
NOTE: Data set "WORK.base_demo_MT" has 392 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_MT" has decreased its size from 57 to
      24 pages (a 58% reduction)
NOTE: Procedure sort step took :
      real time : 0.006
      cpu time  : 0.007


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_MT out=census_xref_MT;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 139613 observations were read from "CEN2010.cac_census_xref_MT"
NOTE: Data set "WORK.census_xref_MT" has 139613 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_MT" has increased its size from 586
      to 685 pages (a 17% increase)
NOTE: Procedure sort step took :
      real time : 0.079
      cpu time  : 0.104


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_MT out=census_MT;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 1104 observations were read from "CEN2010.cac_census_final_MT"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_MT" has 1104 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_MT" has decreased its size from 1123 to
      1024 pages (a 9% reduction)
NOTE: Procedure sort step took :
      real time : 0.155
      cpu time  : 0.089

8                                        The WPS System      10:48 Wednesday, July 29, 2015     


MPRINT(AGGREGATION):  data cen_MT (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_MT(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_MT(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 1104 observations were read from "WORK.census_MT"
NOTE: 139613 observations were read from "WORK.census_xref_MT"
NOTE: Data set "WORK.cen_MT" has 139613 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_MT" has decreased its size from 2253 to 2055
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.180
      cpu time  : 0.179


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_MT(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 399 observations were read from "WORK.cen_MT"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_MT" has 399 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_MT" has increased its size from 8 to 9 pages
      (a 13% increase)
NOTE: Procedure sort step took :
      real time : 0.037
      cpu time  : 0.039


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_MT;
MPRINT(AGGREGATION):  merge cen_MT (in=a) base_demo_MT (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "MT";
MPRINT(AGGREGATION):  run;

NOTE: 399 observations were read from "WORK.cen_MT"
NOTE: 392 observations were read from "WORK.base_demo_MT"
NOTE: Data set "WORK.for_buzzboard_MT" has 392 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_MT" has decreased its size from 67
      to 29 pages (a 57% reduction)
NOTE: The data step took :
      real time : 0.004
      cpu time  : 0.004


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_MT base_demo_MT;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_MT" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_MT" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_NE (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_NE;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 1036742 observations were read from "BASE.base_demo_NE"
NOTE: Data set "WORK.base_demo_NE" has 1036742 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NE" has decreased its size from 16723
      to 14617 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 8.516
      cpu time  : 10.601


MPRINT(AGGREGATION):  data base_demo_NE (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_NE;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 1036742 observations were read from "WORK.base_demo_NE"
NOTE: Data set "WORK.base_demo_NE" has 606 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NE" has decreased its size from 88 to
      39 pages (a 56% reduction)
NOTE: The data step took :
      real time : 1.505
      cpu time  : 1.505


MPRINT(AGGREGATION):  proc sort data = base_demo_NE;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 606 observations were read from "WORK.base_demo_NE"
NOTE: Data set "WORK.base_demo_NE" has 606 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NE" has decreased its size from 88 to
      39 pages (a 56% reduction)
NOTE: Procedure sort step took :
      real time : 0.007
      cpu time  : 0.009


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_NE out=census_xref_NE;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 308812 observations were read from "CEN2010.cac_census_xref_NE"
NOTE: Data set "WORK.census_xref_NE" has 308812 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_NE" has increased its size from 1294
      to 1515 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.146
      cpu time  : 0.216


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_NE out=census_NE;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 2198 observations were read from "CEN2010.cac_census_final_NE"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_NE" has 2198 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_NE" has decreased its size from 2217 to
      2108 pages (a 5% reduction)
NOTE: Procedure sort step took :
      real time : 0.202
      cpu time  : 0.174


MPRINT(AGGREGATION):  data cen_NE (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_NE(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_NE(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 2198 observations were read from "WORK.census_NE"
NOTE: 308812 observations were read from "WORK.census_xref_NE"
NOTE: Data set "WORK.cen_NE" has 308812 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_NE" has decreased its size from 4982 to 4538
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.416
      cpu time  : 0.416


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_NE(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 617 observations were read from "WORK.cen_NE"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_NE" has 617 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_NE" has increased its size from 11 to 12
      pages (a 10% increase)
NOTE: Procedure sort step took :
      real time : 0.081
      cpu time  : 0.085


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_NE;
MPRINT(AGGREGATION):  merge cen_NE (in=a) base_demo_NE (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "NE";
MPRINT(AGGREGATION):  run;

NOTE: 617 observations were read from "WORK.cen_NE"
NOTE: 606 observations were read from "WORK.base_demo_NE"
NOTE: Data set "WORK.for_buzzboard_NE" has 605 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_NE" has decreased its size from
      102 to 47 pages (a 54% reduction)
NOTE: The data step took :
      real time : 0.007
      cpu time  : 0.007


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_NE base_demo_NE;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_NE" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_NE" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_NV (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_NV;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 1694378 observations were read from "BASE.base_demo_NV"
NOTE: Data set "WORK.base_demo_NV" has 1694378 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NV" has decreased its size from 27330
      to 23890 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 13.947
      cpu time  : 17.145


MPRINT(AGGREGATION):  data base_demo_NV (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_NV;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 1694378 observations were read from "WORK.base_demo_NV"
NOTE: Data set "WORK.base_demo_NV" has 228 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NV" has decreased its size from 34 to
      19 pages (a 45% reduction)
NOTE: The data step took :
      real time : 2.446
      cpu time  : 2.445


MPRINT(AGGREGATION):  proc sort data = base_demo_NV;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 228 observations were read from "WORK.base_demo_NV"
NOTE: Data set "WORK.base_demo_NV" has 228 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NV" has decreased its size from 34 to
      19 pages (a 45% reduction)
NOTE: Procedure sort step took :
      real time : 0.006
      cpu time  : 0.007


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_NV out=census_xref_NV;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 238211 observations were read from "CEN2010.cac_census_xref_NV"
NOTE: Data set "WORK.census_xref_NV" has 238211 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_NV" has increased its size from 998
      to 1168 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.121
      cpu time  : 0.170


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_NV out=census_NV;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 1833 observations were read from "CEN2010.cac_census_final_NV"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_NV" has 1833 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_NV" has decreased its size from 1852 to
      1768 pages (a 5% reduction)
NOTE: Procedure sort step took :
      real time : 0.179
      cpu time  : 0.151


MPRINT(AGGREGATION):  data cen_NV (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_NV(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_NV(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 1833 observations were read from "WORK.census_NV"
NOTE: 238211 observations were read from "WORK.census_xref_NV"
NOTE: Data set "WORK.cen_NV" has 238211 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_NV" has decreased its size from 3844 to 3499
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.322
      cpu time  : 0.322


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_NV(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 248 observations were read from "WORK.cen_NV"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_NV" has 248 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_NV" has increased its size from 5 to 6 pages
      (a 20% increase)
NOTE: Procedure sort step took :
      real time : 0.063
      cpu time  : 0.065


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_NV;
MPRINT(AGGREGATION):  merge cen_NV (in=a) base_demo_NV (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "NV";
MPRINT(AGGREGATION):  run;

NOTE: 248 observations were read from "WORK.cen_NV"
NOTE: 228 observations were read from "WORK.base_demo_NV"
NOTE: Data set "WORK.for_buzzboard_NV" has 227 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_NV" has decreased its size from 39
      to 23 pages (a 42% reduction)
NOTE: The data step took :
      real time : 0.004
      cpu time  : 0.004


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_NV base_demo_NV;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_NV" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_NV" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_NH (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_NH;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 830842 observations were read from "BASE.base_demo_NH"
NOTE: Data set "WORK.base_demo_NH" has 830842 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NH" has decreased its size from 13402
      to 11714 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 7.042
      cpu time  : 8.419


MPRINT(AGGREGATION):  data base_demo_NH (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_NH;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 830842 observations were read from "WORK.base_demo_NH"
NOTE: Data set "WORK.base_demo_NH" has 274 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NH" has decreased its size from 41 to
      22 pages (a 47% reduction)
NOTE: The data step took :
      real time : 1.226
      cpu time  : 1.226


MPRINT(AGGREGATION):  proc sort data = base_demo_NH;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 274 observations were read from "WORK.base_demo_NH"
NOTE: Data set "WORK.base_demo_NH" has 274 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NH" has decreased its size from 41 to
      22 pages (a 47% reduction)
NOTE: Procedure sort step took :
      real time : 0.006
      cpu time  : 0.009


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_NH out=census_xref_NH;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 154888 observations were read from "CEN2010.cac_census_xref_NH"
NOTE: Data set "WORK.census_xref_NH" has 154888 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_NH" has increased its size from 650
      to 758 pages (a 17% increase)
NOTE: Procedure sort step took :
      real time : 0.092
      cpu time  : 0.114


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_NH out=census_NH;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 1161 observations were read from "CEN2010.cac_census_final_NH"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_NH" has 1161 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_NH" has decreased its size from 1180 to
      1125 pages (a 5% reduction)
NOTE: Procedure sort step took :
      real time : 0.102
      cpu time  : 0.098


MPRINT(AGGREGATION):  data cen_NH (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_NH(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_NH(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 1161 observations were read from "WORK.census_NH"
NOTE: 154888 observations were read from "WORK.census_xref_NH"
NOTE: Data set "WORK.cen_NH" has 154888 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_NH" has decreased its size from 2500 to 2283
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.212
      cpu time  : 0.211


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_NH(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 279 observations were read from "WORK.cen_NH"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_NH" has 279 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_NH" has increased its size from 6 to 7 pages
      (a 17% increase)
NOTE: Procedure sort step took :
      real time : 0.045
      cpu time  : 0.046


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_NH;
MPRINT(AGGREGATION):  merge cen_NH (in=a) base_demo_NH (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "NH";
MPRINT(AGGREGATION):  run;

NOTE: 279 observations were read from "WORK.cen_NH"
NOTE: 274 observations were read from "WORK.base_demo_NH"
NOTE: Data set "WORK.for_buzzboard_NH" has 273 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_NH" has decreased its size from 47
      to 26 pages (a 45% reduction)
NOTE: The data step took :
      real time : 0.005
      cpu time  : 0.004


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_NH base_demo_NH;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_NH" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_NH" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_NJ (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_NJ;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 4886824 observations were read from "BASE.base_demo_NJ"
NOTE: Data set "WORK.base_demo_NJ" has 4886824 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NJ" has decreased its size from 78821
      to 68944 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 41.365
      cpu time  : 52.253


MPRINT(AGGREGATION):  data base_demo_NJ (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_NJ;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 4886824 observations were read from "WORK.base_demo_NJ"
NOTE: Data set "WORK.base_demo_NJ" has 694 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NJ" has decreased its size from 101 to
      57 pages (a 44% reduction)
NOTE: The data step took :
      real time : 7.105
      cpu time  : 7.103


MPRINT(AGGREGATION):  proc sort data = base_demo_NJ;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 694 observations were read from "WORK.base_demo_NJ"
NOTE: Data set "WORK.base_demo_NJ" has 694 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NJ" has decreased its size from 101 to
      57 pages (a 44% reduction)
NOTE: Procedure sort step took :
      real time : 0.009
      cpu time  : 0.011


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_NJ out=census_xref_NJ;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 737913 observations were read from "CEN2010.cac_census_xref_NJ"
NOTE: Data set "WORK.census_xref_NJ" has 737913 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_NJ" has increased its size from 3089
      to 3618 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.341
      cpu time  : 0.529


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_NJ out=census_NJ;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 6851 observations were read from "CEN2010.cac_census_final_NJ"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_NJ" has 6851 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_NJ" has decreased its size from 6870 to
      6687 pages (a 3% reduction)
NOTE: Procedure sort step took :
      real time : 0.508
      cpu time  : 0.530


MPRINT(AGGREGATION):  data cen_NJ (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_NJ(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_NJ(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 6851 observations were read from "WORK.census_NJ"
NOTE: 737913 observations were read from "WORK.census_xref_NJ"
NOTE: Data set "WORK.cen_NJ" has 737913 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_NJ" has decreased its size from 11903 to
      10871 pages (a 9% reduction)
NOTE: The data step took :
      real time : 1.002
      cpu time  : 1.002


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_NJ(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 711 observations were read from "WORK.cen_NJ"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_NJ" has 711 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_NJ" has not changed its size of 13 pages
NOTE: Procedure sort step took :
      real time : 0.184
      cpu time  : 0.186


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_NJ;
MPRINT(AGGREGATION):  merge cen_NJ (in=a) base_demo_NJ (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "NJ";
MPRINT(AGGREGATION):  run;

NOTE: 711 observations were read from "WORK.cen_NJ"
NOTE: 694 observations were read from "WORK.base_demo_NJ"
NOTE: Data set "WORK.for_buzzboard_NJ" has 691 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_NJ" has decreased its size from
      117 to 66 pages (a 44% reduction)
NOTE: The data step took :
      real time : 0.008
      cpu time  : 0.008


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_NJ base_demo_NJ;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_NJ" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_NJ" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_NM (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_NM;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 1110662 observations were read from "BASE.base_demo_NM"
NOTE: Data set "WORK.base_demo_NM" has 1110662 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NM" has decreased its size from 17915
      to 15660 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 9.380
      cpu time  : 11.222


MPRINT(AGGREGATION):  data base_demo_NM (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_NM;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 1110662 observations were read from "WORK.base_demo_NM"
9                                        The WPS System      10:48 Wednesday, July 29, 2015     

NOTE: Data set "WORK.base_demo_NM" has 416 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NM" has decreased its size from 61 to
      28 pages (a 55% reduction)
NOTE: The data step took :
      real time : 1.606
      cpu time  : 1.605


MPRINT(AGGREGATION):  proc sort data = base_demo_NM;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 416 observations were read from "WORK.base_demo_NM"
NOTE: Data set "WORK.base_demo_NM" has 416 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NM" has decreased its size from 61 to
      28 pages (a 55% reduction)
NOTE: Procedure sort step took :
      real time : 0.009
      cpu time  : 0.011


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_NM out=census_xref_NM;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 205360 observations were read from "CEN2010.cac_census_xref_NM"
NOTE: Data set "WORK.census_xref_NM" has 205360 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_NM" has increased its size from 861
      to 1006 pages (a 17% increase)
NOTE: Procedure sort step took :
      real time : 0.105
      cpu time  : 0.150


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_NM out=census_NM;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 1545 observations were read from "CEN2010.cac_census_final_NM"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_NM" has 1545 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_NM" has decreased its size from 1564 to
      1510 pages (a 4% reduction)
NOTE: Procedure sort step took :
      real time : 0.132
      cpu time  : 0.130


MPRINT(AGGREGATION):  data cen_NM (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_NM(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_NM(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 1545 observations were read from "WORK.census_NM"
NOTE: 205360 observations were read from "WORK.census_xref_NM"
NOTE: Data set "WORK.cen_NM" has 205360 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_NM" has decreased its size from 3314 to 3019
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.278
      cpu time  : 0.277


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_NM(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 421 observations were read from "WORK.cen_NM"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_NM" has 421 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_NM" has increased its size from 8 to 9 pages
      (a 13% increase)
NOTE: Procedure sort step took :
      real time : 0.058
      cpu time  : 0.061


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_NM;
MPRINT(AGGREGATION):  merge cen_NM (in=a) base_demo_NM (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "NM";
MPRINT(AGGREGATION):  run;

NOTE: 421 observations were read from "WORK.cen_NM"
NOTE: 416 observations were read from "WORK.base_demo_NM"
NOTE: Data set "WORK.for_buzzboard_NM" has 414 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_NM" has decreased its size from 70
      to 33 pages (a 53% reduction)
NOTE: The data step took :
      real time : 0.005
      cpu time  : 0.005


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_NM base_demo_NM;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_NM" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_NM" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_NY (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_NY;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 11158244 observations were read from "BASE.base_demo_NY"
NOTE: Data set "WORK.base_demo_NY" has 11158244 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NY" has decreased its size from 179973
      to 157482 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 1:33.695
      cpu time  : 2:08.389


MPRINT(AGGREGATION):  data base_demo_NY (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_NY;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 11158244 observations were read from "WORK.base_demo_NY"
NOTE: Data set "WORK.base_demo_NY" has 2014 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NY" has decreased its size from 289 to
      149 pages (a 49% reduction)
NOTE: The data step took :
      real time : 15.452
      cpu time  : 15.450


MPRINT(AGGREGATION):  proc sort data = base_demo_NY;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 2014 observations were read from "WORK.base_demo_NY"
NOTE: Data set "WORK.base_demo_NY" has 2014 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NY" has decreased its size from 289 to
      149 pages (a 49% reduction)
NOTE: Procedure sort step took :
      real time : 0.020
      cpu time  : 0.024


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_NY out=census_xref_NY;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 1712254 observations were read from "CEN2010.cac_census_xref_NY"
NOTE: Data set "WORK.census_xref_NY" has 1712254 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_NY" has increased its size from 7166
      to 8513 pages (a 19% increase)
NOTE: Procedure sort step took :
      real time : 0.724
      cpu time  : 1.246


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_NY out=census_NY;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 16693 observations were read from "CEN2010.cac_census_final_NY"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_NY" has 16693 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_NY" has decreased its size from 16712 to
      15991 pages (a 5% reduction)
NOTE: Procedure sort step took :
      real time : 1.200
      cpu time  : 1.246


MPRINT(AGGREGATION):  data cen_NY (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_NY(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_NY(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 16693 observations were read from "WORK.census_NY"
NOTE: 1712254 observations were read from "WORK.census_xref_NY"
NOTE: Data set "WORK.cen_NY" has 1712254 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_NY" has decreased its size from 27618 to
      25164 pages (a 9% reduction)
NOTE: The data step took :
      real time : 2.392
      cpu time  : 2.392


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_NY(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 2095 observations were read from "WORK.cen_NY"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_NY" has 2095 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_NY" has not changed its size of 35 pages
NOTE: Procedure sort step took :
      real time : 0.424
      cpu time  : 0.428


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_NY;
MPRINT(AGGREGATION):  merge cen_NY (in=a) base_demo_NY (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "NY";
MPRINT(AGGREGATION):  run;

NOTE: 2095 observations were read from "WORK.cen_NY"
NOTE: 2014 observations were read from "WORK.base_demo_NY"
NOTE: Data set "WORK.for_buzzboard_NY" has 1999 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_NY" has decreased its size from
      335 to 177 pages (a 48% reduction)
NOTE: The data step took :
      real time : 0.019
      cpu time  : 0.018


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_NY base_demo_NY;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_NY" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_NY" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_NC (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_NC;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 5921623 observations were read from "BASE.base_demo_NC"
NOTE: Data set "WORK.base_demo_NC" has 5921623 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NC" has decreased its size from 95512
      to 83501 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 0:49.462
      cpu time  : 1:02.510


MPRINT(AGGREGATION):  data base_demo_NC (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_NC;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 5921623 observations were read from "WORK.base_demo_NC"
NOTE: Data set "WORK.base_demo_NC" has 1023 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NC" has decreased its size from 148 to
      80 pages (a 46% reduction)
NOTE: The data step took :
      real time : 8.771
      cpu time  : 8.771


MPRINT(AGGREGATION):  proc sort data = base_demo_NC;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 1023 observations were read from "WORK.base_demo_NC"
NOTE: Data set "WORK.base_demo_NC" has 1023 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_NC" has decreased its size from 148 to
      80 pages (a 46% reduction)
NOTE: Procedure sort step took :
      real time : 0.045
      cpu time  : 0.047


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_NC out=census_xref_NC;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 1450904 observations were read from "CEN2010.cac_census_xref_NC"
NOTE: Data set "WORK.census_xref_NC" has 1450904 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_NC" has increased its size from 6072
      to 7114 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.621
      cpu time  : 1.058


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_NC out=census_NC;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 6859 observations were read from "CEN2010.cac_census_final_NC"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_NC" has 6859 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_NC" has decreased its size from 6878 to
      6522 pages (a 6% reduction)
NOTE: Procedure sort step took :
      real time : 0.496
      cpu time  : 0.515


MPRINT(AGGREGATION):  data cen_NC (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_NC(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_NC(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 6859 observations were read from "WORK.census_NC"
NOTE: 1450904 observations were read from "WORK.census_xref_NC"
NOTE: Data set "WORK.cen_NC" has 1450904 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_NC" has decreased its size from 23403 to
      21331 pages (a 9% reduction)
NOTE: The data step took :
      real time : 1.814
      cpu time  : 1.814


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_NC(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 1055 observations were read from "WORK.cen_NC"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_NC" has 1055 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_NC" has not changed its size of 19 pages
NOTE: Procedure sort step took :
      real time : 0.343
      cpu time  : 0.346


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_NC;
MPRINT(AGGREGATION):  merge cen_NC (in=a) base_demo_NC (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "NC";
MPRINT(AGGREGATION):  run;

NOTE: 1055 observations were read from "WORK.cen_NC"
NOTE: 1023 observations were read from "WORK.base_demo_NC"
NOTE: Data set "WORK.for_buzzboard_NC" has 1015 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_NC" has decreased its size from
      171 to 95 pages (a 45% reduction)
NOTE: The data step took :
      real time : 0.011
      cpu time  : 0.011


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_NC base_demo_NC;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_NC" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_NC" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_ND (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_ND;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 438310 observations were read from "BASE.base_demo_ND"
NOTE: Data set "WORK.base_demo_ND" has 438310 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_ND" has decreased its size from 7071
      to 6182 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 3.716
      cpu time  : 4.606


MPRINT(AGGREGATION):  data base_demo_ND (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_ND;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 438310 observations were read from "WORK.base_demo_ND"
NOTE: Data set "WORK.base_demo_ND" has 398 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_ND" has decreased its size from 58 to
      24 pages (a 59% reduction)
NOTE: The data step took :
      real time : 0.640
      cpu time  : 0.639


MPRINT(AGGREGATION):  proc sort data = base_demo_ND;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 398 observations were read from "WORK.base_demo_ND"
NOTE: Data set "WORK.base_demo_ND" has 398 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_ND" has decreased its size from 58 to
      24 pages (a 59% reduction)
NOTE: Procedure sort step took :
      real time : 0.006
      cpu time  : 0.007


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_ND out=census_xref_ND;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 119365 observations were read from "CEN2010.cac_census_xref_ND"
NOTE: Data set "WORK.census_xref_ND" has 119365 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_ND" has increased its size from 501
      to 586 pages (a 17% increase)
NOTE: Procedure sort step took :
      real time : 0.079
      cpu time  : 0.092


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_ND out=census_ND;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 942 observations were read from "CEN2010.cac_census_final_ND"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_ND" has 942 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_ND" has decreased its size from 961 to
      895 pages (a 7% reduction)
NOTE: Procedure sort step took :
      real time : 0.089
      cpu time  : 0.080


MPRINT(AGGREGATION):  data cen_ND (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_ND(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_ND(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 942 observations were read from "WORK.census_ND"
NOTE: 119365 observations were read from "WORK.census_xref_ND"
NOTE: Data set "WORK.cen_ND" has 119365 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_ND" has decreased its size from 1927 to 1754
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.156
      cpu time  : 0.155


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_ND(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 405 observations were read from "WORK.cen_ND"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_ND" has 405 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_ND" has increased its size from 8 to 9 pages
      (a 13% increase)
NOTE: Procedure sort step took :
      real time : 0.032
      cpu time  : 0.035


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_ND;
MPRINT(AGGREGATION):  merge cen_ND (in=a) base_demo_ND (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "ND";
MPRINT(AGGREGATION):  run;

NOTE: 405 observations were read from "WORK.cen_ND"
NOTE: 398 observations were read from "WORK.base_demo_ND"
NOTE: Data set "WORK.for_buzzboard_ND" has 397 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_ND" has decreased its size from 68
      to 29 pages (a 58% reduction)
NOTE: The data step took :
      real time : 0.004
      cpu time  : 0.004


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_ND base_demo_ND;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_ND" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_ND" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_OH (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_OH;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 8134949 observations were read from "BASE.base_demo_OH"
NOTE: Data set "WORK.base_demo_OH" has 8134949 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_OH" has decreased its size from 131210
      to 114627 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 1:12.103
      cpu time  : 1:26.024


MPRINT(AGGREGATION):  data base_demo_OH (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_OH;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 8134949 observations were read from "WORK.base_demo_OH"
NOTE: Data set "WORK.base_demo_OH" has 1335 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_OH" has decreased its size from 192 to
      104 pages (a 46% reduction)
NOTE: The data step took :
      real time : 11.227
      cpu time  : 11.226


MPRINT(AGGREGATION):  proc sort data = base_demo_OH;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 1335 observations were read from "WORK.base_demo_OH"
NOTE: Data set "WORK.base_demo_OH" has 1335 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_OH" has decreased its size from 192 to
      104 pages (a 46% reduction)
NOTE: Procedure sort step took :
      real time : 0.013
      cpu time  : 0.017


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_OH out=census_xref_OH;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 1394328 observations were read from "CEN2010.cac_census_xref_OH"
NOTE: Data set "WORK.census_xref_OH" has 1394328 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_OH" has increased its size from 5836
      to 6875 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.589
      cpu time  : 1.006


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_OH out=census_OH;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 10293 observations were read from "CEN2010.cac_census_final_OH"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_OH" has 10293 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_OH" has decreased its size from 10312 to
      8937 pages (a 14% reduction)
NOTE: Procedure sort step took :
      real time : 0.708
      cpu time  : 0.755


MPRINT(AGGREGATION):  data cen_OH (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_OH(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_OH(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 10293 observations were read from "WORK.census_OH"
NOTE: 1394328 observations were read from "WORK.census_xref_OH"
NOTE: Data set "WORK.cen_OH" has 1394328 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_OH" has decreased its size from 22491 to
      20500 pages (a 9% reduction)
NOTE: The data step took :
      real time : 1.865
      cpu time  : 1.865


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_OH(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 1396 observations were read from "WORK.cen_OH"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_OH" has 1396 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_OH" has not changed its size of 24 pages
NOTE: Procedure sort step took :
      real time : 0.346
      cpu time  : 0.349


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_OH;
MPRINT(AGGREGATION):  merge cen_OH (in=a) base_demo_OH (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "OH";
MPRINT(AGGREGATION):  run;

NOTE: 1396 observations were read from "WORK.cen_OH"
NOTE: 1335 observations were read from "WORK.base_demo_OH"
NOTE: Data set "WORK.for_buzzboard_OH" has 1330 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_OH" has decreased its size from
      223 to 123 pages (a 45% reduction)
NOTE: The data step took :
      real time : 0.015
      cpu time  : 0.014


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_OH base_demo_OH;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_OH" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_OH" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.002


MPRINT(AGGREGATION):  proc sort data = base.base_demo_OK (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_OK;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 2238384 observations were read from "BASE.base_demo_OK"
NOTE: Data set "WORK.base_demo_OK" has 2238384 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_OK" has decreased its size from 36104
      to 31549 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 17.916
      cpu time  : 22.997


MPRINT(AGGREGATION):  data base_demo_OK (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_OK;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
10                                       The WPS System      10:48 Wednesday, July 29, 2015     

                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 2238384 observations were read from "WORK.base_demo_OK"
NOTE: Data set "WORK.base_demo_OK" has 741 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_OK" has decreased its size from 107 to
      51 pages (a 53% reduction)
NOTE: The data step took :
      real time : 3.227
      cpu time  : 3.227


MPRINT(AGGREGATION):  proc sort data = base_demo_OK;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 741 observations were read from "WORK.base_demo_OK"
NOTE: Data set "WORK.base_demo_OK" has 741 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_OK" has decreased its size from 107 to
      51 pages (a 53% reduction)
NOTE: Procedure sort step took :
      real time : 0.009
      cpu time  : 0.013


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_OK out=census_xref_OK;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 629210 observations were read from "CEN2010.cac_census_xref_OK"
NOTE: Data set "WORK.census_xref_OK" has 629210 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_OK" has increased its size from 2634
      to 3085 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.286
      cpu time  : 0.443


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_OK out=census_OK;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 3352 observations were read from "CEN2010.cac_census_final_OK"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_OK" has 3352 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_OK" has decreased its size from 3371 to
      3158 pages (a 7% reduction)
NOTE: Procedure sort step took :
      real time : 0.242
      cpu time  : 0.259


MPRINT(AGGREGATION):  data cen_OK (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_OK(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_OK(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 3352 observations were read from "WORK.census_OK"
NOTE: 629210 observations were read from "WORK.census_xref_OK"
NOTE: Data set "WORK.cen_OK" has 629210 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_OK" has decreased its size from 10150 to
      9255 pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.831
      cpu time  : 0.830


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_OK(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 749 observations were read from "WORK.cen_OK"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_OK" has 749 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_OK" has not changed its size of 14 pages
NOTE: Procedure sort step took :
      real time : 0.165
      cpu time  : 0.167


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_OK;
MPRINT(AGGREGATION):  merge cen_OK (in=a) base_demo_OK (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "OK";
MPRINT(AGGREGATION):  run;

NOTE: 749 observations were read from "WORK.cen_OK"
NOTE: 741 observations were read from "WORK.base_demo_OK"
NOTE: Data set "WORK.for_buzzboard_OK" has 738 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_OK" has decreased its size from
      124 to 61 pages (a 51% reduction)
NOTE: The data step took :
      real time : 0.008
      cpu time  : 0.007


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_OK base_demo_OK;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_OK" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_OK" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_OR (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_OR;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 2701000 observations were read from "BASE.base_demo_OR"
NOTE: Data set "WORK.base_demo_OR" has 2701000 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_OR" has decreased its size from 43566
      to 38076 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 21.176
      cpu time  : 27.623


MPRINT(AGGREGATION):  data base_demo_OR (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_OR;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 2701000 observations were read from "WORK.base_demo_OR"
NOTE: Data set "WORK.base_demo_OR" has 465 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_OR" has decreased its size from 68 to
      34 pages (a 50% reduction)
NOTE: The data step took :
      real time : 3.899
      cpu time  : 3.899


MPRINT(AGGREGATION):  proc sort data = base_demo_OR;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 465 observations were read from "WORK.base_demo_OR"
NOTE: Data set "WORK.base_demo_OR" has 465 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_OR" has decreased its size from 68 to
      34 pages (a 50% reduction)
NOTE: Procedure sort step took :
      real time : 0.008
      cpu time  : 0.010


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_OR out=census_xref_OR;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 514351 observations were read from "CEN2010.cac_census_xref_OR"
NOTE: Data set "WORK.census_xref_OR" has 514351 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_OR" has increased its size from 2154
      to 2522 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.239
      cpu time  : 0.370


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_OR out=census_OR;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 3015 observations were read from "CEN2010.cac_census_final_OR"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_OR" has 3015 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_OR" has decreased its size from 3034 to
      2953 pages (a 3% reduction)
NOTE: Procedure sort step took :
      real time : 0.224
      cpu time  : 0.245


MPRINT(AGGREGATION):  data cen_OR (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_OR(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_OR(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 3015 observations were read from "WORK.census_OR"
NOTE: 514351 observations were read from "WORK.census_xref_OR"
NOTE: Data set "WORK.cen_OR" has 514351 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_OR" has decreased its size from 8297 to 7565
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.684
      cpu time  : 0.684


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_OR(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 470 observations were read from "WORK.cen_OR"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_OR" has 470 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_OR" has increased its size from 9 to 10
      pages (a 12% increase)
NOTE: Procedure sort step took :
      real time : 0.134
      cpu time  : 0.137


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_OR;
MPRINT(AGGREGATION):  merge cen_OR (in=a) base_demo_OR (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "OR";
MPRINT(AGGREGATION):  run;

NOTE: 470 observations were read from "WORK.cen_OR"
NOTE: 465 observations were read from "WORK.base_demo_OR"
NOTE: Data set "WORK.for_buzzboard_OR" has 463 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_OR" has decreased its size from 79
      to 41 pages (a 49% reduction)
NOTE: The data step took :
      real time : 0.006
      cpu time  : 0.005


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_OR base_demo_OR;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_OR" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_OR" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_PA (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_PA;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 7692816 observations were read from "BASE.base_demo_PA"
NOTE: Data set "WORK.base_demo_PA" has 7692816 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_PA" has decreased its size from 124079
      to 108441 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 1:02.753
      cpu time  : 1:22.208


MPRINT(AGGREGATION):  data base_demo_PA (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_PA;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 7692816 observations were read from "WORK.base_demo_PA"
NOTE: Data set "WORK.base_demo_PA" has 2030 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_PA" has decreased its size from 291 to
      148 pages (a 50% reduction)
NOTE: The data step took :
      real time : 11.090
      cpu time  : 11.089


MPRINT(AGGREGATION):  proc sort data = base_demo_PA;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 2030 observations were read from "WORK.base_demo_PA"
NOTE: Data set "WORK.base_demo_PA" has 2030 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_PA" has decreased its size from 291 to
      148 pages (a 50% reduction)
NOTE: Procedure sort step took :
      real time : 0.021
      cpu time  : 0.027


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_PA out=census_xref_PA;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 1600287 observations were read from "CEN2010.cac_census_xref_PA"
NOTE: Data set "WORK.census_xref_PA" has 1600287 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_PA" has increased its size from 6697
      to 7895 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.684
      cpu time  : 1.145


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_PA out=census_PA;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 11129 observations were read from "CEN2010.cac_census_final_PA"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_PA" has 11129 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_PA" has decreased its size from 11148 to
      10395 pages (a 7% reduction)
NOTE: Procedure sort step took :
      real time : 0.769
      cpu time  : 0.822


MPRINT(AGGREGATION):  data cen_PA (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_PA(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_PA(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 11129 observations were read from "WORK.census_PA"
NOTE: 1600287 observations were read from "WORK.census_xref_PA"
NOTE: Data set "WORK.cen_PA" has 1600287 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_PA" has decreased its size from 25813 to
      23537 pages (a 9% reduction)
NOTE: The data step took :
      real time : 2.118
      cpu time  : 2.118


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_PA(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 2133 observations were read from "WORK.cen_PA"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_PA" has 2133 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_PA" has not changed its size of 36 pages
NOTE: Procedure sort step took :
      real time : 0.396
      cpu time  : 0.400


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_PA;
MPRINT(AGGREGATION):  merge cen_PA (in=a) base_demo_PA (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "PA";
MPRINT(AGGREGATION):  run;

NOTE: 2133 observations were read from "WORK.cen_PA"
NOTE: 2030 observations were read from "WORK.base_demo_PA"
NOTE: Data set "WORK.for_buzzboard_PA" has 2017 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_PA" has decreased its size from
      338 to 176 pages (a 48% reduction)
NOTE: The data step took :
      real time : 0.019
      cpu time  : 0.019


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_PA base_demo_PA;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_PA" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_PA" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_RI (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_RI;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 718870 observations were read from "BASE.base_demo_RI"
NOTE: Data set "WORK.base_demo_RI" has 718870 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_RI" has decreased its size from 11596
      to 10137 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 6.014
      cpu time  : 7.547


MPRINT(AGGREGATION):  data base_demo_RI (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_RI;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 718870 observations were read from "WORK.base_demo_RI"
NOTE: Data set "WORK.base_demo_RI" has 87 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_RI" has decreased its size from 14 to
      10 pages (a 29% reduction)
NOTE: The data step took :
      real time : 1.047
      cpu time  : 1.047


MPRINT(AGGREGATION):  proc sort data = base_demo_RI;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 87 observations were read from "WORK.base_demo_RI"
NOTE: Data set "WORK.base_demo_RI" has 87 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_RI" has decreased its size from 14 to
      10 pages (a 29% reduction)
NOTE: Procedure sort step took :
      real time : 0.005
      cpu time  : 0.008


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_RI out=census_xref_RI;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 119244 observations were read from "CEN2010.cac_census_xref_RI"
NOTE: Data set "WORK.census_xref_RI" has 119244 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_RI" has increased its size from 500
      to 584 pages (a 17% increase)
NOTE: Procedure sort step took :
      real time : 0.089
      cpu time  : 0.100


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_RI out=census_RI;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 884 observations were read from "CEN2010.cac_census_final_RI"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_RI" has 884 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_RI" has decreased its size from 903 to
      877 pages (a 3% reduction)
NOTE: Procedure sort step took :
      real time : 0.073
      cpu time  : 0.081


MPRINT(AGGREGATION):  data cen_RI (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_RI(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_RI(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 884 observations were read from "WORK.census_RI"
NOTE: 119244 observations were read from "WORK.census_xref_RI"
NOTE: Data set "WORK.cen_RI" has 119244 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_RI" has decreased its size from 1925 to 1754
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.162
      cpu time  : 0.162


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_RI(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 90 observations were read from "WORK.cen_RI"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_RI" has 90 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_RI" has increased its size from 3 to 4 pages
      (a 34% increase)
NOTE: Procedure sort step took :
      real time : 0.034
      cpu time  : 0.036


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_RI;
MPRINT(AGGREGATION):  merge cen_RI (in=a) base_demo_RI (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "RI";
MPRINT(AGGREGATION):  run;

NOTE: 90 observations were read from "WORK.cen_RI"
NOTE: 87 observations were read from "WORK.base_demo_RI"
NOTE: Data set "WORK.for_buzzboard_RI" has 87 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_RI" has decreased its size from 16
      to 11 pages (a 32% reduction)
NOTE: The data step took :
      real time : 0.003
      cpu time  : 0.004


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_RI base_demo_RI;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_RI" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_RI" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_SC (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_SC;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 2760132 observations were read from "BASE.base_demo_SC"
NOTE: Data set "WORK.base_demo_SC" has 2760132 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_SC" has decreased its size from 44520
      to 38919 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 22.283
      cpu time  : 29.037


MPRINT(AGGREGATION):  data base_demo_SC (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_SC;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 2760132 observations were read from "WORK.base_demo_SC"
NOTE: Data set "WORK.base_demo_SC" has 503 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_SC" has decreased its size from 73 to
      42 pages (a 43% reduction)
NOTE: The data step took :
      real time : 4.016
      cpu time  : 4.016


MPRINT(AGGREGATION):  proc sort data = base_demo_SC;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 503 observations were read from "WORK.base_demo_SC"
NOTE: Data set "WORK.base_demo_SC" has 503 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_SC" has decreased its size from 73 to
      42 pages (a 43% reduction)
NOTE: Procedure sort step took :
      real time : 0.008
      cpu time  : 0.011


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_SC out=census_xref_SC;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 708745 observations were read from "CEN2010.cac_census_xref_SC"
NOTE: Data set "WORK.census_xref_SC" has 708745 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_SC" has increased its size from 2967
      to 3474 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.326
      cpu time  : 0.495


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_SC out=census_SC;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 3409 observations were read from "CEN2010.cac_census_final_SC"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_SC" has 3409 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_SC" has decreased its size from 3428 to
      3149 pages (a 9% reduction)
NOTE: Procedure sort step took :
      real time : 0.247
      cpu time  : 0.263


MPRINT(AGGREGATION):  data cen_SC (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_SC(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_SC(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 3409 observations were read from "WORK.census_SC"
NOTE: 708745 observations were read from "WORK.census_xref_SC"
NOTE: Data set "WORK.cen_SC" has 708745 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_SC" has decreased its size from 11433 to
      10429 pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.924
      cpu time  : 0.923


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_SC(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 526 observations were read from "WORK.cen_SC"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_SC" has 526 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_SC" has increased its size from 10 to 11
      pages (a 10% increase)
NOTE: Procedure sort step took :
      real time : 0.183
      cpu time  : 0.187


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_SC;
MPRINT(AGGREGATION):  merge cen_SC (in=a) base_demo_SC (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "SC";
MPRINT(AGGREGATION):  run;

NOTE: 526 observations were read from "WORK.cen_SC"
NOTE: 503 observations were read from "WORK.base_demo_SC"
NOTE: Data set "WORK.for_buzzboard_SC" has 501 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_SC" has decreased its size from 85
      to 50 pages (a 42% reduction)
NOTE: The data step took :
      real time : 0.007
      cpu time  : 0.006


11                                       The WPS System      10:48 Wednesday, July 29, 2015     

MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_SC base_demo_SC;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_SC" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_SC" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_SD (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_SD;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 481940 observations were read from "BASE.base_demo_SD"
NOTE: Data set "WORK.base_demo_SD" has 481940 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_SD" has decreased its size from 7775
      to 6797 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 3.939
      cpu time  : 5.033


MPRINT(AGGREGATION):  data base_demo_SD (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_SD;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 481940 observations were read from "WORK.base_demo_SD"
NOTE: Data set "WORK.base_demo_SD" has 377 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_SD" has decreased its size from 55 to
      23 pages (a 59% reduction)
NOTE: The data step took :
      real time : 0.705
      cpu time  : 0.704


MPRINT(AGGREGATION):  proc sort data = base_demo_SD;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 377 observations were read from "WORK.base_demo_SD"
NOTE: Data set "WORK.base_demo_SD" has 377 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_SD" has decreased its size from 55 to
      23 pages (a 59% reduction)
NOTE: Procedure sort step took :
      real time : 0.006
      cpu time  : 0.009


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_SD out=census_xref_SD;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 135139 observations were read from "CEN2010.cac_census_xref_SD"
NOTE: Data set "WORK.census_xref_SD" has 135139 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_SD" has increased its size from 567
      to 663 pages (a 17% increase)
NOTE: Procedure sort step took :
      real time : 0.090
      cpu time  : 0.109


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_SD out=census_SD;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 965 observations were read from "CEN2010.cac_census_final_SD"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_SD" has 965 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_SD" has decreased its size from 984 to
      915 pages (a 8% reduction)
NOTE: Procedure sort step took :
      real time : 0.072
      cpu time  : 0.081


MPRINT(AGGREGATION):  data cen_SD (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_SD(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_SD(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 965 observations were read from "WORK.census_SD"
NOTE: 135139 observations were read from "WORK.census_xref_SD"
NOTE: Data set "WORK.cen_SD" has 135139 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_SD" has decreased its size from 2181 to 1990
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.173
      cpu time  : 0.173


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_SD(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 383 observations were read from "WORK.cen_SD"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_SD" has 383 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_SD" has not changed its size of 8 pages
NOTE: Procedure sort step took :
      real time : 0.035
      cpu time  : 0.037


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_SD;
MPRINT(AGGREGATION):  merge cen_SD (in=a) base_demo_SD (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "SD";
MPRINT(AGGREGATION):  run;

NOTE: 383 observations were read from "WORK.cen_SD"
NOTE: 377 observations were read from "WORK.base_demo_SD"
NOTE: Data set "WORK.for_buzzboard_SD" has 377 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_SD" has decreased its size from 64
      to 28 pages (a 57% reduction)
NOTE: The data step took :
      real time : 0.004
      cpu time  : 0.004


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_SD base_demo_SD;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_SD" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_SD" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.000


MPRINT(AGGREGATION):  proc sort data = base.base_demo_TN (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_TN;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 3881481 observations were read from "BASE.base_demo_TN"
NOTE: Data set "WORK.base_demo_TN" has 3881481 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_TN" has decreased its size from 62606
      to 54727 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 30.829
      cpu time  : 40.336


MPRINT(AGGREGATION):  data base_demo_TN (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_TN;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 3881481 observations were read from "WORK.base_demo_TN"
NOTE: Data set "WORK.base_demo_TN" has 743 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_TN" has decreased its size from 108 to
      58 pages (a 47% reduction)
NOTE: The data step took :
      real time : 5.596
      cpu time  : 5.593


MPRINT(AGGREGATION):  proc sort data = base_demo_TN;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 743 observations were read from "WORK.base_demo_TN"
NOTE: Data set "WORK.base_demo_TN" has 743 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_TN" has decreased its size from 108 to
      58 pages (a 47% reduction)
NOTE: Procedure sort step took :
      real time : 0.010
      cpu time  : 0.014


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_TN out=census_xref_TN;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 985370 observations were read from "CEN2010.cac_census_xref_TN"
NOTE: Data set "WORK.census_xref_TN" has 985370 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_TN" has increased its size from 4124
      to 4829 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.425
      cpu time  : 0.693


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_TN out=census_TN;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 4711 observations were read from "CEN2010.cac_census_final_TN"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_TN" has 4711 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_TN" has decreased its size from 4730 to
      4287 pages (a 10% reduction)
NOTE: Procedure sort step took :
      real time : 0.334
      cpu time  : 0.363


MPRINT(AGGREGATION):  data cen_TN (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_TN(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_TN(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 4711 observations were read from "WORK.census_TN"
NOTE: 985370 observations were read from "WORK.census_xref_TN"
NOTE: Data set "WORK.cen_TN" has 985370 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_TN" has decreased its size from 15895 to
      14470 pages (a 9% reduction)
NOTE: The data step took :
      real time : 1.278
      cpu time  : 1.277


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_TN(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 775 observations were read from "WORK.cen_TN"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_TN" has 775 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_TN" has increased its size from 14 to 15
      pages (a 8% increase)
NOTE: Procedure sort step took :
      real time : 0.246
      cpu time  : 0.249


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_TN;
MPRINT(AGGREGATION):  merge cen_TN (in=a) base_demo_TN (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "TN";
MPRINT(AGGREGATION):  run;

NOTE: 775 observations were read from "WORK.cen_TN"
NOTE: 743 observations were read from "WORK.base_demo_TN"
NOTE: Data set "WORK.for_buzzboard_TN" has 738 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_TN" has decreased its size from
      124 to 69 pages (a 45% reduction)
NOTE: The data step took :
      real time : 0.009
      cpu time  : 0.008


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_TN base_demo_TN;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_TN" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_TN" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_TX (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_TX;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 14737883 observations were read from "BASE.base_demo_TX"
NOTE: Data set "WORK.base_demo_TX" has 14737883 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_TX" has decreased its size from 237709
      to 207885 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 3:25.297
      cpu time  : 3:44.602


MPRINT(AGGREGATION):  data base_demo_TX (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_TX;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 14737883 observations were read from "WORK.base_demo_TX"
NOTE: Data set "WORK.base_demo_TX" has 2425 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_TX" has decreased its size from 348 to
      178 pages (a 49% reduction)
NOTE: The data step took :
      real time : 20.204
      cpu time  : 20.198


MPRINT(AGGREGATION):  proc sort data = base_demo_TX;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 2425 observations were read from "WORK.base_demo_TX"
NOTE: Data set "WORK.base_demo_TX" has 2425 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_TX" has decreased its size from 348 to
      178 pages (a 49% reduction)
NOTE: Procedure sort step took :
      real time : 0.021
      cpu time  : 0.026


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_TX out=census_xref_TX;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 3289355 observations were read from "CEN2010.cac_census_xref_TX"
NOTE: Data set "WORK.census_xref_TX" has 3289355 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_TX" has increased its size from
      13764 to 16374 pages (a 19% increase)
NOTE: Procedure sort step took :
      real time : 1.333
      cpu time  : 2.446


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_TX out=census_TX;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 17120 observations were read from "CEN2010.cac_census_final_TX"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_TX" has 17120 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_TX" has decreased its size from 17139 to
      16290 pages (a 5% reduction)
NOTE: Procedure sort step took :
      real time : 1.182
      cpu time  : 1.255


MPRINT(AGGREGATION):  data cen_TX (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_TX(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_TX(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 17120 observations were read from "WORK.census_TX"
NOTE: 3289355 observations were read from "WORK.census_xref_TX"
NOTE: Data set "WORK.cen_TX" has 3289355 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_TX" has decreased its size from 53056 to
      48334 pages (a 9% reduction)
NOTE: The data step took :
      real time : 4.296
      cpu time  : 4.295


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_TX(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 2479 observations were read from "WORK.cen_TX"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_TX" has 2479 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_TX" has not changed its size of 41 pages
NOTE: Procedure sort step took :
      real time : 0.803
      cpu time  : 0.808


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_TX;
MPRINT(AGGREGATION):  merge cen_TX (in=a) base_demo_TX (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "TX";
MPRINT(AGGREGATION):  run;

NOTE: 2479 observations were read from "WORK.cen_TX"
NOTE: 2425 observations were read from "WORK.base_demo_TX"
NOTE: Data set "WORK.for_buzzboard_TX" has 2400 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_TX" has decreased its size from
      401 to 212 pages (a 48% reduction)
NOTE: The data step took :
      real time : 0.023
      cpu time  : 0.023


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_TX base_demo_TX;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_TX" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_TX" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_UT (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_UT;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 1456301 observations were read from "BASE.base_demo_UT"
NOTE: Data set "WORK.base_demo_UT" has 1456301 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_UT" has decreased its size from 23490
      to 20538 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 12.347
      cpu time  : 15.276


MPRINT(AGGREGATION):  data base_demo_UT (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_UT;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 1456301 observations were read from "WORK.base_demo_UT"
NOTE: Data set "WORK.base_demo_UT" has 326 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_UT" has decreased its size from 48 to
      25 pages (a 48% reduction)
NOTE: The data step took :
      real time : 2.121
      cpu time  : 2.120


MPRINT(AGGREGATION):  proc sort data = base_demo_UT;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 326 observations were read from "WORK.base_demo_UT"
NOTE: Data set "WORK.base_demo_UT" has 326 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_UT" has decreased its size from 48 to
      25 pages (a 48% reduction)
NOTE: Procedure sort step took :
      real time : 0.007
      cpu time  : 0.010


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_UT out=census_xref_UT;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 267388 observations were read from "CEN2010.cac_census_xref_UT"
NOTE: Data set "WORK.census_xref_UT" has 267388 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_UT" has increased its size from 1120
      to 1311 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.137
      cpu time  : 0.199


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_UT out=census_UT;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 1791 observations were read from "CEN2010.cac_census_final_UT"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_UT" has 1791 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_UT" has decreased its size from 1810 to
      1716 pages (a 6% reduction)
NOTE: Procedure sort step took :
      real time : 0.134
      cpu time  : 0.144


MPRINT(AGGREGATION):  data cen_UT (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_UT(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_UT(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 1791 observations were read from "WORK.census_UT"
NOTE: 267388 observations were read from "WORK.census_xref_UT"
NOTE: Data set "WORK.cen_UT" has 267388 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_UT" has decreased its size from 4314 to 3926
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.358
      cpu time  : 0.357


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_UT(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 340 observations were read from "WORK.cen_UT"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_UT" has 340 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_UT" has increased its size from 7 to 8 pages
      (a 15% increase)
NOTE: Procedure sort step took :
      real time : 0.071
      cpu time  : 0.074


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_UT;
MPRINT(AGGREGATION):  merge cen_UT (in=a) base_demo_UT (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "UT";
MPRINT(AGGREGATION):  run;

NOTE: 340 observations were read from "WORK.cen_UT"
NOTE: 326 observations were read from "WORK.base_demo_UT"
NOTE: Data set "WORK.for_buzzboard_UT" has 326 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_UT" has decreased its size from 56
      to 30 pages (a 47% reduction)
NOTE: The data step took :
      real time : 0.005
      cpu time  : 0.004


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_UT base_demo_UT;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_UT" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_UT" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.000


MPRINT(AGGREGATION):  proc sort data = base.base_demo_VT (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_VT;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 442921 observations were read from "BASE.base_demo_VT"
NOTE: Data set "WORK.base_demo_VT" has 442921 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_VT" has decreased its size from 7145
      to 6247 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 3.688
      cpu time  : 4.401


MPRINT(AGGREGATION):  data base_demo_VT (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_VT;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 442921 observations were read from "WORK.base_demo_VT"
NOTE: Data set "WORK.base_demo_VT" has 298 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_VT" has decreased its size from 44 to
      21 pages (a 53% reduction)
NOTE: The data step took :
      real time : 0.649
      cpu time  : 0.649


MPRINT(AGGREGATION):  proc sort data = base_demo_VT;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 298 observations were read from "WORK.base_demo_VT"
NOTE: Data set "WORK.base_demo_VT" has 298 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_VT" has decreased its size from 44 to
      21 pages (a 53% reduction)
NOTE: Procedure sort step took :
      real time : 0.006
      cpu time  : 0.007


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_VT out=census_xref_VT;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 134332 observations were read from "CEN2010.cac_census_xref_VT"
NOTE: Data set "WORK.census_xref_VT" has 134332 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_VT" has increased its size from 564
      to 658 pages (a 17% increase)
NOTE: Procedure sort step took :
      real time : 0.087
      cpu time  : 0.105


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_VT out=census_VT;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 769 observations were read from "CEN2010.cac_census_final_VT"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_VT" has 769 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_VT" has decreased its size from 788 to
      767 pages (a 3% reduction)
NOTE: Procedure sort step took :
      real time : 0.066
      cpu time  : 0.071


MPRINT(AGGREGATION):  data cen_VT (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_VT(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_VT(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
12                                       The WPS System      10:48 Wednesday, July 29, 2015     

MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 769 observations were read from "WORK.census_VT"
NOTE: 134332 observations were read from "WORK.census_xref_VT"
NOTE: Data set "WORK.cen_VT" has 134332 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_VT" has decreased its size from 2168 to 1978
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.179
      cpu time  : 0.178


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_VT(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 307 observations were read from "WORK.cen_VT"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_VT" has 307 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_VT" has increased its size from 6 to 7 pages
      (a 17% increase)
NOTE: Procedure sort step took :
      real time : 0.037
      cpu time  : 0.038


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_VT;
MPRINT(AGGREGATION):  merge cen_VT (in=a) base_demo_VT (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "VT";
MPRINT(AGGREGATION):  run;

NOTE: 307 observations were read from "WORK.cen_VT"
NOTE: 298 observations were read from "WORK.base_demo_VT"
NOTE: Data set "WORK.for_buzzboard_VT" has 298 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_VT" has decreased its size from 51
      to 25 pages (a 51% reduction)
NOTE: The data step took :
      real time : 0.004
      cpu time  : 0.003


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_VT base_demo_VT;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_VT" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_VT" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_VA (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_VA;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 4845810 observations were read from "BASE.base_demo_VA"
NOTE: Data set "WORK.base_demo_VA" has 4845810 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_VA" has decreased its size from 78160
      to 68346 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 39.594
      cpu time  : 50.849


MPRINT(AGGREGATION):  data base_demo_VA (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_VA;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 4845810 observations were read from "WORK.base_demo_VA"
NOTE: Data set "WORK.base_demo_VA" has 1114 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_VA" has decreased its size from 161 to
      80 pages (a 51% reduction)
NOTE: The data step took :
      real time : 7.141
      cpu time  : 7.139


MPRINT(AGGREGATION):  proc sort data = base_demo_VA;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 1114 observations were read from "WORK.base_demo_VA"
NOTE: Data set "WORK.base_demo_VA" has 1114 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_VA" has decreased its size from 161 to
      80 pages (a 51% reduction)
NOTE: Procedure sort step took :
      real time : 0.012
      cpu time  : 0.016


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_VA out=census_xref_VA;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 1018930 observations were read from "CEN2010.cac_census_xref_VA"
NOTE: Data set "WORK.census_xref_VA" has 1018930 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_VA" has increased its size from 4265
      to 4996 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.435
      cpu time  : 0.701


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_VA out=census_VA;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 6089 observations were read from "CEN2010.cac_census_final_VA"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_VA" has 6089 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_VA" has decreased its size from 6108 to
      5782 pages (a 6% reduction)
NOTE: Procedure sort step took :
      real time : 0.431
      cpu time  : 0.465


MPRINT(AGGREGATION):  data cen_VA (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_VA(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_VA(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 6089 observations were read from "WORK.census_VA"
NOTE: 1018930 observations were read from "WORK.census_xref_VA"
NOTE: Data set "WORK.cen_VA" has 1018930 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_VA" has decreased its size from 16436 to
      14984 pages (a 9% reduction)
NOTE: The data step took :
      real time : 1.346
      cpu time  : 1.346


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_VA(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 1167 observations were read from "WORK.cen_VA"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_VA" has 1167 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_VA" has increased its size from 20 to 21
      pages (a 5% increase)
NOTE: Procedure sort step took :
      real time : 0.261
      cpu time  : 0.263


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_VA;
MPRINT(AGGREGATION):  merge cen_VA (in=a) base_demo_VA (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "VA";
MPRINT(AGGREGATION):  run;

NOTE: 1167 observations were read from "WORK.cen_VA"
NOTE: 1114 observations were read from "WORK.base_demo_VA"
NOTE: Data set "WORK.for_buzzboard_VA" has 1099 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_VA" has decreased its size from
      185 to 95 pages (a 49% reduction)
NOTE: The data step took :
      real time : 0.012
      cpu time  : 0.011


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_VA base_demo_VA;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_VA" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_VA" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_WA (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_WA;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 4265436 observations were read from "BASE.base_demo_WA"
NOTE: Data set "WORK.base_demo_WA" has 4265436 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_WA" has decreased its size from 68799
      to 60149 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 35.265
      cpu time  : 44.014


MPRINT(AGGREGATION):  data base_demo_WA (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_WA;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 4265436 observations were read from "WORK.base_demo_WA"
NOTE: Data set "WORK.base_demo_WA" has 688 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_WA" has decreased its size from 100 to
      52 pages (a 48% reduction)
NOTE: The data step took :
      real time : 6.222
      cpu time  : 6.213


MPRINT(AGGREGATION):  proc sort data = base_demo_WA;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 688 observations were read from "WORK.base_demo_WA"
NOTE: Data set "WORK.base_demo_WA" has 688 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_WA" has decreased its size from 100 to
      52 pages (a 48% reduction)
NOTE: Procedure sort step took :
      real time : 0.009
      cpu time  : 0.011


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_WA out=census_xref_WA;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 790587 observations were read from "CEN2010.cac_census_xref_WA"
NOTE: Data set "WORK.census_xref_WA" has 790587 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_WA" has increased its size from 3309
      to 3877 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.359
      cpu time  : 0.563


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_WA out=census_WA;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 5294 observations were read from "CEN2010.cac_census_final_WA"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_WA" has 5294 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_WA" has decreased its size from 5313 to
      5226 pages (a 2% reduction)
NOTE: Procedure sort step took :
      real time : 0.393
      cpu time  : 0.421


MPRINT(AGGREGATION):  data cen_WA (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_WA(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_WA(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 5294 observations were read from "WORK.census_WA"
NOTE: 790587 observations were read from "WORK.census_xref_WA"
NOTE: Data set "WORK.cen_WA" has 790587 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_WA" has decreased its size from 12753 to
      11643 pages (a 9% reduction)
NOTE: The data step took :
      real time : 1.084
      cpu time  : 1.083


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_WA(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 712 observations were read from "WORK.cen_WA"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_WA" has 712 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_WA" has increased its size from 13 to 14
      pages (a 8% increase)
NOTE: Procedure sort step took :
      real time : 0.204
      cpu time  : 0.206


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_WA;
MPRINT(AGGREGATION):  merge cen_WA (in=a) base_demo_WA (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "WA";
MPRINT(AGGREGATION):  run;

NOTE: 712 observations were read from "WORK.cen_WA"
NOTE: 688 observations were read from "WORK.base_demo_WA"
NOTE: Data set "WORK.for_buzzboard_WA" has 685 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_WA" has decreased its size from
      116 to 62 pages (a 47% reduction)
NOTE: The data step took :
      real time : 0.008
      cpu time  : 0.008


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_WA base_demo_WA;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_WA" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_WA" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.000


MPRINT(AGGREGATION):  proc sort data = base.base_demo_WV (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_WV;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 1125821 observations were read from "BASE.base_demo_WV"
NOTE: Data set "WORK.base_demo_WV" has 1125821 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_WV" has decreased its size from 18160
      to 15873 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 9.238
      cpu time  : 11.737


MPRINT(AGGREGATION):  data base_demo_WV (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_WV;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 1125821 observations were read from "WORK.base_demo_WV"
NOTE: Data set "WORK.base_demo_WV" has 835 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_WV" has decreased its size from 121 to
      52 pages (a 58% reduction)
NOTE: The data step took :
      real time : 1.634
      cpu time  : 1.633


MPRINT(AGGREGATION):  proc sort data = base_demo_WV;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 835 observations were read from "WORK.base_demo_WV"
NOTE: Data set "WORK.base_demo_WV" has 835 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_WV" has decreased its size from 121 to
      52 pages (a 58% reduction)
NOTE: Procedure sort step took :
      real time : 0.009
      cpu time  : 0.011


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_WV out=census_xref_WV;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 279295 observations were read from "CEN2010.cac_census_xref_WV"
NOTE: Data set "WORK.census_xref_WV" has 279295 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_WV" has increased its size from 1170
      to 1370 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.140
      cpu time  : 0.201


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_WV out=census_WV;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 1921 observations were read from "CEN2010.cac_census_final_WV"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_WV" has 1921 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_WV" has decreased its size from 1940 to
      1517 pages (a 22% reduction)
NOTE: Procedure sort step took :
      real time : 0.138
      cpu time  : 0.148


MPRINT(AGGREGATION):  data cen_WV (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_WV(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_WV(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 1921 observations were read from "WORK.census_WV"
NOTE: 279295 observations were read from "WORK.census_xref_WV"
NOTE: Data set "WORK.cen_WV" has 279295 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_WV" has decreased its size from 4506 to 4113
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.373
      cpu time  : 0.373


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_WV(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 841 observations were read from "WORK.cen_WV"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_WV" has 841 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_WV" has increased its size from 15 to 16
      pages (a 7% increase)
NOTE: Procedure sort step took :
      real time : 0.074
      cpu time  : 0.077


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_WV;
MPRINT(AGGREGATION):  merge cen_WV (in=a) base_demo_WV (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "WV";
MPRINT(AGGREGATION):  run;

NOTE: 841 observations were read from "WORK.cen_WV"
NOTE: 835 observations were read from "WORK.base_demo_WV"
NOTE: Data set "WORK.for_buzzboard_WV" has 834 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_WV" has decreased its size from
      140 to 64 pages (a 55% reduction)
NOTE: The data step took :
      real time : 0.009
      cpu time  : 0.008


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_WV base_demo_WV;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_WV" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_WV" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_WI (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_WI;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 3704916 observations were read from "BASE.base_demo_WI"
NOTE: Data set "WORK.base_demo_WI" has 3704916 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_WI" has decreased its size from 59758
      to 52225 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 30.095
      cpu time  : 38.677


MPRINT(AGGREGATION):  data base_demo_WI (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_WI;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 3704916 observations were read from "WORK.base_demo_WI"
NOTE: Data set "WORK.base_demo_WI" has 854 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_WI" has decreased its size from 123 to
      63 pages (a 49% reduction)
NOTE: The data step took :
      real time : 5.342
      cpu time  : 5.342


MPRINT(AGGREGATION):  proc sort data = base_demo_WI;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 854 observations were read from "WORK.base_demo_WI"
NOTE: Data set "WORK.base_demo_WI" has 854 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_WI" has decreased its size from 123 to
      63 pages (a 49% reduction)
NOTE: Procedure sort step took :
      real time : 0.010
      cpu time  : 0.013


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_WI out=census_xref_WI;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 844326 observations were read from "CEN2010.cac_census_xref_WI"
NOTE: Data set "WORK.census_xref_WI" has 844326 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_WI" has increased its size from 3534
      to 4141 pages (a 18% increase)
NOTE: Procedure sort step took :
      real time : 0.364
      cpu time  : 0.592


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_WI out=census_WI;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 5218 observations were read from "CEN2010.cac_census_final_WI"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_WI" has 5218 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_WI" has decreased its size from 5237 to
      5028 pages (a 4% reduction)
NOTE: Procedure sort step took :
      real time : 0.374
      cpu time  : 0.403


MPRINT(AGGREGATION):  data cen_WI (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_WI(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_WI(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 5218 observations were read from "WORK.census_WI"
NOTE: 844326 observations were read from "WORK.census_xref_WI"
NOTE: Data set "WORK.cen_WI" has 844326 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_WI" has decreased its size from 13620 to
      12432 pages (a 9% reduction)
NOTE: The data step took :
      real time : 1.115
      cpu time  : 1.115


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_WI(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 882 observations were read from "WORK.cen_WI"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_WI" has 882 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_WI" has not changed its size of 16 pages
NOTE: Procedure sort step took :
      real time : 0.211
      cpu time  : 0.214


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_WI;
MPRINT(AGGREGATION):  merge cen_WI (in=a) base_demo_WI (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "WI";
MPRINT(AGGREGATION):  run;

NOTE: 882 observations were read from "WORK.cen_WI"
NOTE: 854 observations were read from "WORK.base_demo_WI"
NOTE: Data set "WORK.for_buzzboard_WI" has 853 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_WI" has decreased its size from
      144 to 75 pages (a 48% reduction)
NOTE: The data step took :
      real time : 0.009
      cpu time  : 0.008


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_WI base_demo_WI;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_WI" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_WI" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_WY (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_WY;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 355949 observations were read from "BASE.base_demo_WY"
NOTE: Data set "WORK.base_demo_WY" has 355949 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_WY" has decreased its size from 5743
      to 5020 pages (a 13% reduction)
NOTE: Procedure sort step took :
      real time : 2.888
      cpu time  : 3.550


MPRINT(AGGREGATION):  data base_demo_WY (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_WY;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 355949 observations were read from "WORK.base_demo_WY"
NOTE: Data set "WORK.base_demo_WY" has 191 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_WY" has decreased its size from 29 to
      13 pages (a 56% reduction)
NOTE: The data step took :
      real time : 0.522
      cpu time  : 0.522


MPRINT(AGGREGATION):  proc sort data = base_demo_WY;
MPRINT(AGGREGATION):  by matching_field ;
13                                       The WPS System      10:48 Wednesday, July 29, 2015     

MPRINT(AGGREGATION):  run;
NOTE: 191 observations were read from "WORK.base_demo_WY"
NOTE: Data set "WORK.base_demo_WY" has 191 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_WY" has decreased its size from 29 to
      13 pages (a 56% reduction)
NOTE: Procedure sort step took :
      real time : 0.005
      cpu time  : 0.007


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_WY out=census_xref_WY;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 71579 observations were read from "CEN2010.cac_census_xref_WY"
NOTE: Data set "WORK.census_xref_WY" has 71579 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_WY" has increased its size from 301
      to 352 pages (a 17% increase)
NOTE: Procedure sort step took :
      real time : 0.059
      cpu time  : 0.061


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_WY out=census_WY;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 545 observations were read from "CEN2010.cac_census_final_WY"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_WY" has 545 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_WY" has decreased its size from 564 to
      540 pages (a 5% reduction)
NOTE: Procedure sort step took :
      real time : 0.046
      cpu time  : 0.050


MPRINT(AGGREGATION):  data cen_WY (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_WY(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_WY(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 545 observations were read from "WORK.census_WY"
NOTE: 71579 observations were read from "WORK.census_xref_WY"
NOTE: Data set "WORK.cen_WY" has 71579 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_WY" has decreased its size from 1156 to 1056
      pages (a 9% reduction)
NOTE: The data step took :
      real time : 0.098
      cpu time  : 0.098


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_WY(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 194 observations were read from "WORK.cen_WY"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_WY" has 194 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_WY" has not changed its size of 5 pages
NOTE: Procedure sort step took :
      real time : 0.020
      cpu time  : 0.022


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_WY;
MPRINT(AGGREGATION):  merge cen_WY (in=a) base_demo_WY (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "WY";
MPRINT(AGGREGATION):  run;

NOTE: 194 observations were read from "WORK.cen_WY"
NOTE: 191 observations were read from "WORK.base_demo_WY"
NOTE: Data set "WORK.for_buzzboard_WY" has 190 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_WY" has decreased its size from 33
      to 15 pages (a 55% reduction)
NOTE: The data step took :
      real time : 0.003
      cpu time  : 0.003


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_WY base_demo_WY;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_WY" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_WY" (memtype=DATA)
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab ConsumerIntellibase Data!!!!
                      --------------------------------------------------------------------------
                      -----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.000
      cpu time  : 0.001


MPRINT(AGGREGATION):  proc sort data = base.base_demo_DC (obs=max keep=cac_addr_zip
                      cac_census_2010_county_code cac_census_2010_tract_block_grp cac_silh
                      cac_addr_latitude cac_addr_longitude cac_silh_dig_inf
                      cac_silh_buy_style_group cac_silh_social cac_silh_soc_inf ) out =
                      base_demo_DC;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  run;
NOTE: 392274 observations were read from "BASE.base_demo_DC"
NOTE: Data set "WORK.base_demo_DC" has 392274 observation(s) and 10 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_DC" has decreased its size from 6328
      to 5583 pages (a 12% reduction)
NOTE: Procedure sort step took :
      real time : 3.076
      cpu time  : 3.835


MPRINT(AGGREGATION):  data base_demo_DC (keep=matching_field avg_lat avg_lon silh_:
                      cac_silh_buy_style_group_3-cac_silh_buy_style_group_5 avg_cac_silh_social
                      avg_cac_silh_dig_inf sum_cac_silh_social sum_cac_silh_dig_inf counts_hh
                      sum_cac_silh_soc_inf avg_cac_silh_soc_inf);
MPRINT(AGGREGATION):  set base_demo_DC;
MPRINT(AGGREGATION):  by cac_addr_zip;
MPRINT(AGGREGATION):  *array silh(59) _temporary_ (1-59);
MPRINT(AGGREGATION):  array silh_counts (59) silh_1-silh_59 ;
MPRINT(AGGREGATION):  array buy_style(7) cac_silh_buy_style_group_1-cac_silh_buy_style_group_7;
MPRINT(AGGREGATION):  retain silh_: sum_lat sum_lon counter tot_hh sum_cac_silh_social
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf;
MPRINT(AGGREGATION):  if first.cac_addr_zip then do;
MPRINT(AGGREGATION):  sum_lat=0;
MPRINT(AGGREGATION):  sum_lon=0;
MPRINT(AGGREGATION):  sum_cac_silh_social=0;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf=0;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf=0;
MPRINT(AGGREGATION):  counter = 0;
MPRINT(AGGREGATION):  counts_hh=0;
MPRINT(AGGREGATION):  do p=1 to 59;
MPRINT(AGGREGATION):  silh_counts(p)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  do q=1 to 7;
MPRINT(AGGREGATION):  buy_style(q)=0;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  if cac_addr_latitude not in (0 .) and cac_addr_longitude not in(0 .) then
                      counter+1;
MPRINT(AGGREGATION):  counts_hh+1;
MPRINT(AGGREGATION):  sum_lat+cac_addr_latitude;
MPRINT(AGGREGATION):  sum_lon+cac_addr_longitude;
MPRINT(AGGREGATION):  sum_cac_silh_social+cac_silh_social;
MPRINT(AGGREGATION):  sum_cac_silh_dig_inf+cac_silh_dig_inf;
MPRINT(AGGREGATION):  sum_cac_silh_soc_inf+cac_silh_soc_inf;
MPRINT(AGGREGATION):  silh_counts(put(CAC_SILH,silh_value.)+0)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=1 then buy_style(1)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=2 then buy_style(2)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=3 then buy_style(3)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=4 then buy_style(4)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=5 then buy_style(5)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=6 then buy_style(6)+1;
MPRINT(AGGREGATION):  if cac_silh_buy_style_group=7 then buy_style(7)+1;
MPRINT(AGGREGATION):  if last.cac_addr_zip then do;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  avg_lat=sum_lat/counter;
MPRINT(AGGREGATION):  avg_lon=sum_lon/counter;
MPRINT(AGGREGATION):  avg_cac_silh_social=round(sum_cac_silh_social/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_dig_inf=round(sum_cac_silh_dig_inf/counts_hh,.01);
MPRINT(AGGREGATION):  avg_cac_silh_soc_inf=round(sum_cac_silh_soc_inf/counts_hh,.01);
MPRINT(AGGREGATION):  output;
MPRINT(AGGREGATION):  end;
MPRINT(AGGREGATION):  drop p q;
MPRINT(AGGREGATION):  run;
NOTE: Variable "tot_hh" may not be initialized

NOTE: Character values have been converted to numeric values at the places given by:
      (Line):(Column)
      4553:223   
NOTE: 392274 observations were read from "WORK.base_demo_DC"
NOTE: Data set "WORK.base_demo_DC" has 47 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_DC" has decreased its size from 8 to 5
      pages (a 38% reduction)
NOTE: The data step took :
      real time : 0.568
      cpu time  : 0.568


MPRINT(AGGREGATION):  proc sort data = base_demo_DC;
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 47 observations were read from "WORK.base_demo_DC"
NOTE: Data set "WORK.base_demo_DC" has 47 observation(s) and 72 variable(s)
NOTE: Specifying compression for data set "WORK.base_demo_DC" has decreased its size from 8 to 5
      pages (a 38% reduction)
NOTE: Procedure sort step took :
      real time : 0.005
      cpu time  : 0.010


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Grab Census Data!!!!
                      --------------------------------------------------------------------------
                      ------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc sort data=cen2010.cac_census_xref_DC out=census_xref_DC;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 66860 observations were read from "CEN2010.cac_census_xref_DC"
NOTE: Data set "WORK.census_xref_DC" has 66860 observation(s) and 3 variable(s)
NOTE: Specifying compression for data set "WORK.census_xref_DC" has increased its size from 281
      to 325 pages (a 16% increase)
NOTE: Procedure sort step took :
      real time : 0.058
      cpu time  : 0.058


MPRINT(AGGREGATION):  proc sort NODUPKEY data=cen2010.cac_census_final_DC out=census_DC;
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  run;
NOTE: 475 observations were read from "CEN2010.cac_census_final_DC"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.census_DC" has 475 observation(s) and 758 variable(s)
NOTE: Specifying compression for data set "WORK.census_DC" has decreased its size from 494 to
      460 pages (a 7% reduction)
NOTE: Procedure sort step took :
      real time : 0.043
      cpu time  : 0.047


MPRINT(AGGREGATION):  data cen_DC (drop = cac_census_id cac_addr_zip cen_hsevac_4 cen_hhrel_4
                      cen_hsevac_4 cen_hhrel_4 county tract blkgrp cen_hsevac_4 cen_hhrel_4
                      rename = (cen_popage_2 = median_age cen_hhinc_2=median_income));
MPRINT(AGGREGATION):  merge census_DC(in=a keep= cac_census_id county blkgrp tract cen_count_pop
                      cen_count_fam cen_count_hh cen_popage_2 cen_hhinc_2 cen_hsevac_4
                      cen_hhrel_4) census_xref_DC(in=b);
MPRINT(AGGREGATION):  by cac_census_id;
MPRINT(AGGREGATION):  matching_field =cac_addr_zip;
MPRINT(AGGREGATION):  with_children = cen_hhrel_4;
MPRINT(AGGREGATION):  owner_occupied = cen_hsevac_4;
MPRINT(AGGREGATION):  run;

NOTE: 475 observations were read from "WORK.census_DC"
NOTE: 66860 observations were read from "WORK.census_xref_DC"
NOTE: Data set "WORK.cen_DC" has 66860 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_DC" has decreased its size from 1080 to 975
      pages (a 10% reduction)
NOTE: The data step took :
      real time : 0.093
      cpu time  : 0.093


MPRINT(AGGREGATION):  proc sort NODUPKEY data = cen_DC(where=(CAC_ADDR_ZIP4=""));
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  run;
NOTE: 195 observations were read from "WORK.cen_DC"
NOTE: No observations with duplicate sort keys were found
NOTE: Data set "WORK.cen_DC" has 195 observation(s) and 9 variable(s)
NOTE: Specifying compression for data set "WORK.cen_DC" has not changed its size of 5 pages
NOTE: Procedure sort step took :
      real time : 0.020
      cpu time  : 0.022


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Put intellibase rollup and cen together
                      --------------------------------------------------------------------------
                      -----------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  data for_buzzboard_DC;
MPRINT(AGGREGATION):  merge cen_DC (in=a) base_demo_DC (in=b);
MPRINT(AGGREGATION):  by matching_field ;
MPRINT(AGGREGATION):  if a and b;
MPRINT(AGGREGATION):  state = "DC";
MPRINT(AGGREGATION):  run;

NOTE: 195 observations were read from "WORK.cen_DC"
NOTE: 47 observations were read from "WORK.base_demo_DC"
NOTE: Data set "WORK.for_buzzboard_DC" has 45 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "WORK.for_buzzboard_DC" has decreased its size from 9
      to 6 pages (a 34% reduction)
NOTE: The data step took :
      real time : 0.002
      cpu time  : 0.003


MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Dump the Junk
                      --------------------------------------------------------------------------
                      -------------------------------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  proc datasets NOLIST library = work;
MPRINT(AGGREGATION):  delete cen_DC base_demo_DC;
MPRINT(AGGREGATION):  run;
NOTE: Deleting "WORK.cen_DC" (memtype=DATA)
NOTE: Deleting "WORK.base_demo_DC" (memtype=DATA)
MPRINT(AGGREGATION):  *numstates loop;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
MPRINT(AGGREGATION):  *------ Stack the States and do some Diags
                      --------------------------------------------------------------------------
                      ----------------*;
MPRINT(AGGREGATION):  *-------------------------------------------------------------------------
                      -----------------------------------------------------------*;
NOTE: Procedure datasets step took :
      real time : 0.001
      cpu time  : 0.001


MPRINT(AGGREGATION):  data for_rts.buzzboard_zip_level;
MPRINT(AGGREGATION):  set for_buzzboard_AL for_buzzboard_AK for_buzzboard_AZ for_buzzboard_AR
                      for_buzzboard_CA for_buzzboard_CO for_buzzboard_CT for_buzzboard_DE
                      for_buzzboard_FL for_buzzboard_GA for_buzzboard_HI for_buzzboard_ID
                      for_buzzboard_IL for_buzzboard_IN for_buzzboard_IA for_buzzboard_KS
                      for_buzzboard_KY for_buzzboard_LA for_buzzboard_ME for_buzzboard_MD
                      for_buzzboard_MA for_buzzboard_MI for_buzzboard_MN for_buzzboard_MS
                      for_buzzboard_MO for_buzzboard_MT for_buzzboard_NE for_buzzboard_NV
                      for_buzzboard_NH for_buzzboard_NJ for_buzzboard_NM for_buzzboard_NY
                      for_buzzboard_NC for_buzzboard_ND for_buzzboard_OH for_buzzboard_OK
                      for_buzzboard_OR for_buzzboard_PA for_buzzboard_RI for_buzzboard_SC
                      for_buzzboard_SD for_buzzboard_TN for_buzzboard_TX for_buzzboard_UT
                      for_buzzboard_VT for_buzzboard_VA for_buzzboard_WA for_buzzboard_WV
                      for_buzzboard_WI for_buzzboard_WY for_buzzboard_DC ;
MPRINT(AGGREGATION):  if matching_field="" then delete;
MPRINT(AGGREGATION):  run;

NOTE: 760 observations were read from "WORK.for_buzzboard_AL"
NOTE: 267 observations were read from "WORK.for_buzzboard_AK"
NOTE: 508 observations were read from "WORK.for_buzzboard_AZ"
NOTE: 687 observations were read from "WORK.for_buzzboard_AR"
NOTE: 2361 observations were read from "WORK.for_buzzboard_CA"
NOTE: 596 observations were read from "WORK.for_buzzboard_CO"
NOTE: 372 observations were read from "WORK.for_buzzboard_CT"
NOTE: 78 observations were read from "WORK.for_buzzboard_DE"
NOTE: 1410 observations were read from "WORK.for_buzzboard_FL"
NOTE: 894 observations were read from "WORK.for_buzzboard_GA"
NOTE: 128 observations were read from "WORK.for_buzzboard_HI"
NOTE: 302 observations were read from "WORK.for_buzzboard_ID"
NOTE: 1481 observations were read from "WORK.for_buzzboard_IL"
NOTE: 929 observations were read from "WORK.for_buzzboard_IN"
NOTE: 1001 observations were read from "WORK.for_buzzboard_IA"
NOTE: 730 observations were read from "WORK.for_buzzboard_KS"
NOTE: 908 observations were read from "WORK.for_buzzboard_KY"
NOTE: 675 observations were read from "WORK.for_buzzboard_LA"
NOTE: 472 observations were read from "WORK.for_buzzboard_ME"
NOTE: 557 observations were read from "WORK.for_buzzboard_MD"
NOTE: 645 observations were read from "WORK.for_buzzboard_MA"
NOTE: 1095 observations were read from "WORK.for_buzzboard_MI"
NOTE: 926 observations were read from "WORK.for_buzzboard_MN"
NOTE: 515 observations were read from "WORK.for_buzzboard_MS"
NOTE: 1101 observations were read from "WORK.for_buzzboard_MO"
NOTE: 392 observations were read from "WORK.for_buzzboard_MT"
NOTE: 605 observations were read from "WORK.for_buzzboard_NE"
NOTE: 227 observations were read from "WORK.for_buzzboard_NV"
NOTE: 273 observations were read from "WORK.for_buzzboard_NH"
NOTE: 691 observations were read from "WORK.for_buzzboard_NJ"
NOTE: 414 observations were read from "WORK.for_buzzboard_NM"
NOTE: 1999 observations were read from "WORK.for_buzzboard_NY"
NOTE: 1015 observations were read from "WORK.for_buzzboard_NC"
NOTE: 397 observations were read from "WORK.for_buzzboard_ND"
NOTE: 1330 observations were read from "WORK.for_buzzboard_OH"
NOTE: 738 observations were read from "WORK.for_buzzboard_OK"
NOTE: 463 observations were read from "WORK.for_buzzboard_OR"
NOTE: 2017 observations were read from "WORK.for_buzzboard_PA"
NOTE: 87 observations were read from "WORK.for_buzzboard_RI"
NOTE: 501 observations were read from "WORK.for_buzzboard_SC"
NOTE: 377 observations were read from "WORK.for_buzzboard_SD"
NOTE: 738 observations were read from "WORK.for_buzzboard_TN"
NOTE: 2400 observations were read from "WORK.for_buzzboard_TX"
NOTE: 326 observations were read from "WORK.for_buzzboard_UT"
NOTE: 298 observations were read from "WORK.for_buzzboard_VT"
NOTE: 1099 observations were read from "WORK.for_buzzboard_VA"
NOTE: 685 observations were read from "WORK.for_buzzboard_WA"
NOTE: 834 observations were read from "WORK.for_buzzboard_WV"
NOTE: 853 observations were read from "WORK.for_buzzboard_WI"
NOTE: 190 observations were read from "WORK.for_buzzboard_WY"
NOTE: 45 observations were read from "WORK.for_buzzboard_DC"
NOTE: Data set "FOR_RTS.buzzboard_zip_level" has 38392 observation(s) and 81 variable(s)
NOTE: Specifying compression for data set "FOR_RTS.buzzboard_zip_level" has decreased its size
      from 2022 to 986 pages (a 52% reduction)
NOTE: The data step took :
      real time : 0.287
      cpu time  : 0.280


MPRINT(AGGREGATION):  title '--------------------  for_rts.buzzboard_zip_level
                      --------------------------------------';
MPRINT(AGGREGATION):  proc means data = for_rts.buzzboard_zip_level ;
MPRINT(AGGREGATION):  run;
NOTE: 38392 observations were read from "FOR_RTS.buzzboard_zip_level"
NOTE: Procedure means step took :
      real time : 0.221
      cpu time  : 0.220


MPRINT(AGGREGATION):  proc freq data = for_rts.buzzboard_zip_level ;
MPRINT(AGGREGATION):  table state;
MPRINT(AGGREGATION):  run;
NOTE: 38392 observations were read from "FOR_RTS.buzzboard_zip_level"
NOTE: Procedure freq step took :
      real time : 0.087
      cpu time  : 0.086


MPRINT(AGGREGATION):  proc print data = for_rts.buzzboard_zip_level (obs=100);
MPRINT(AGGREGATION):  run;
NOTE: 100 observations were read from "FOR_RTS.buzzboard_zip_level"
NOTE: Procedure print step took :
      real time : 0.012
      cpu time  : 0.012


MPRINT(AGGREGATION):  data _null_;
MPRINT(AGGREGATION):  set for_rts.buzzboard_zip_level;
MPRINT(AGGREGATION):  file file_3 dsd dlm=',' lrecl=20000;
MPRINT(AGGREGATION):  put CAC_ADDR_ZIP4 CEN_COUNT_FAM CEN_COUNT_HH CEN_COUNT_POP
                      avg_cac_silh_dig_inf avg_cac_silh_soc_inf avg_cac_silh_social avg_lat
                      avg_lon cac_silh_buy_style_group_3 cac_silh_buy_style_group_4
                      cac_silh_buy_style_group_5 counts_hh matching_field median_age
                      median_income owner_occupied silh_1 silh_2 silh_3 silh_4 silh_5 silh_6
                      silh_7 silh_8 silh_9 silh_10 silh_11 silh_12 silh_13 silh_14 silh_15
                      silh_16 silh_17 silh_18 silh_19 silh_20 silh_21 silh_22 silh_23 silh_24
                      silh_25 silh_26 silh_27 silh_28 silh_29 silh_30 silh_31 silh_32 silh_33
                      silh_34 silh_35 silh_36 silh_37 silh_38 silh_39 silh_40 silh_41 silh_42
                      silh_43 silh_44 silh_45 silh_46 silh_47 silh_48 silh_49 silh_50 silh_51
                      silh_52 silh_53 silh_54 silh_55 silh_56 silh_57 silh_58 silh_59 state
                      sum_cac_silh_dig_inf sum_cac_silh_soc_inf sum_cac_silh_social
                      with_children;
MPRINT(AGGREGATION):  run;

NOTE: The file file_3 is:
      File
      Name=/project/CACDIRECT/DATA/DEVELOPMENT/1240_Z2_HH/EXPORT/BUZZBOARD/buzzboard_zip_level.c
      sv,
      Access Permissions=-rw-rw-rw-,Number of Links=1,
      Owner Name=intellibase,Group Name=intellibase,
      File Size=0,Last Modified=Jul 29 2015,
      Created=Jul 29 2015,Lrecl=20000, Recfm=V

NOTE: 38392 records were written to file file_3
      The minimum record length was 178
      The maximum record length was 389
NOTE: 38392 observations were read from "FOR_RTS.buzzboard_zip_level"
NOTE: The data step took :
      real time : 1.243
      cpu time  : 1.242



NOTE: Submitted statements took :
      real time : 35:00.167
      cpu time  : 41:46.331
