/********** Recodes *****************/

M_INC_UNDER_15_ENH=((CAC_DEMO_INCOME_ENH='1'));
M_INC_15_20_ENH=((CAC_DEMO_INCOME_ENH='2'));
M_INC_20_30_ENH=((CAC_DEMO_INCOME_ENH='3'));
M_INC_30_40_ENH=((CAC_DEMO_INCOME_ENH='4'));
M_INC_40_50_ENH=((CAC_DEMO_INCOME_ENH='5'));
M_INC_50_75_ENH=((CAC_DEMO_INCOME_ENH='6'));
M_INC_75_100_ENH=((CAC_DEMO_INCOME_ENH='7'));
M_INC_100_125_ENH=((CAC_DEMO_INCOME_ENH='8'));
M_INC_125_150_ENH=((CAC_DEMO_INCOME_ENH='9'));
M_INC_150_PLUS_ENH=(strip(CAC_DEMO_INCOME_ENH)in ('A','B','C','D'));

M_INC_20_25=((CAC_DEMO_INCOME_NARROW_ENH='2'));
M_INC_25_30=((CAC_DEMO_INCOME_NARROW_ENH='3'));
M_INC_30_35=((CAC_DEMO_INCOME_NARROW_ENH='4'));
M_INC_35_40=((CAC_DEMO_INCOME_NARROW_ENH='5'));
M_INC_40_45=((CAC_DEMO_INCOME_NARROW_ENH='6'));
M_INC_45_50=((CAC_DEMO_INCOME_NARROW_ENH='7'));
M_INC_50_55=((CAC_DEMO_INCOME_NARROW_ENH='8'));
M_INC_55_60=((CAC_DEMO_INCOME_NARROW_ENH='9'));
M_INC_60_65=((CAC_DEMO_INCOME_NARROW_ENH='A'));
M_INC_65_70=((CAC_DEMO_INCOME_NARROW_ENH='B'));
M_INC_70_75=((CAC_DEMO_INCOME_NARROW_ENH='C'));
M_INC_75_80=((CAC_DEMO_INCOME_NARROW_ENH='D'));
M_INC_80_85=((CAC_DEMO_INCOME_NARROW_ENH='E'));
M_INC_85_90=((CAC_DEMO_INCOME_NARROW_ENH='F'));
M_INC_90_95=((CAC_DEMO_INCOME_NARROW_ENH='G'));
M_INC_95_100=((CAC_DEMO_INCOME_NARROW_ENH='H'));
M_INC_100_105=((CAC_DEMO_INCOME_NARROW_ENH='I'));
M_INC_105_110=((CAC_DEMO_INCOME_NARROW_ENH='J'));
M_INC_110_115=((CAC_DEMO_INCOME_NARROW_ENH='K'));
M_INC_115_120=((CAC_DEMO_INCOME_NARROW_ENH='L'));
M_INC_120_125=((CAC_DEMO_INCOME_NARROW_ENH='M'));
M_INC_125_130=((CAC_DEMO_INCOME_NARROW_ENH='N'));
M_INC_130_135=((CAC_DEMO_INCOME_NARROW_ENH='O'));
M_INC_135_140=((CAC_DEMO_INCOME_NARROW_ENH='P'));
M_INC_140_145=((CAC_DEMO_INCOME_NARROW_ENH='Q'));
M_INC_145_150=((CAC_DEMO_INCOME_NARROW_ENH='R'));
M_INC_150_160=((CAC_DEMO_INCOME_NARROW_ENH='S'));
M_INC_160_170=((CAC_DEMO_INCOME_NARROW_ENH='T'));
M_INC_170_175=((CAC_DEMO_INCOME_NARROW_ENH='U'));
M_INC_175_190=((CAC_DEMO_INCOME_NARROW_ENH='V'));
M_INC_190_200=((CAC_DEMO_INCOME_NARROW_ENH='W'));
M_INC_200_225=((CAC_DEMO_INCOME_NARROW_ENH='X'));
M_INC_225_250=((CAC_DEMO_INCOME_NARROW_ENH='Y'));
M_INC_250_PLUS=((CAC_DEMO_INCOME_NARROW_ENH='Z'));


   M_INCOME = M_INC_UNDER_15_ENH*7.5 + M_INC_15_20_ENH*17.5 + M_INC_20_25*22.5 + M_INC_25_30*27.5 + M_INC_30_35*32.5 +
              M_INC_35_40*37.5 + M_INC_40_45*42.5 + M_INC_45_50*47.5 + M_INC_50_55*52.5 + M_INC_55_60*57.5 + 
              M_INC_60_65*62.5 + M_INC_65_70*67.5 + M_INC_70_75*72.5 + M_INC_75_80*77.5 + M_INC_80_85*82.5 + 
              M_INC_85_90*87.5 + M_INC_90_95*92.5 + M_INC_95_100*97.5 + M_INC_100_105*102.5 + M_INC_105_110*107.5 + 
              M_INC_110_115*112.5 + M_INC_115_120*117.5 + M_INC_120_125*122.5 + M_INC_125_130*127.5 + M_INC_130_135*132.5 + 
              M_INC_135_140*137.5 + M_INC_140_145*142.5 + M_INC_145_150*147.5 + M_INC_150_PLUS_ENH*250; 
   if M_INCOME = 0 then M_INCOME = .;



M_GEO_CAC_INT_37=GEO_CAC_INT_37;
  M_HOH_AGE_25_34_ENH=((CAC_DEMO_AGE_ENH=2));
  M_HOH_AGE_35_44_ENH=((CAC_DEMO_AGE_ENH=3)); 
M_HOH_AGE_25_44_ENH=(M_HOH_AGE_25_34_ENH=1 OR M_HOH_AGE_35_44_ENH=1);

M_GEO_CAC_INT_101=GEO_CAC_INT_101;
M_CAC_ECOM_5=((CAC_SILH_ECOM=5));
M_GEO_CAC_INT_17=GEO_CAC_INT_17;
M_GEO_CAC_INT_27=GEO_CAC_INT_27;
M_CAC_DIGINF_1=((CAC_SILH_DIG_INF=1));
M_FAM_COMP_01_ENH=((CAC_DEMO_HH_TYPE_ENH=1));
M_GEO_CAC_INT_21=GEO_CAC_INT_21;
M_INC_OVER_100_ENH =(M_INC_100_125_ENH=1 OR M_INC_125_150_ENH=1 OR M_INC_150_PLUS_ENH);
M_LIKELY_OWNER=((CAC_HOME_OWN=3));
M_KNOWN_OWNER=((CAC_HOME_OWN=4));
M_HOME_OWNER = (M_LIKELY_OWNER = 1 or M_KNOWN_OWNER = 1);
M_NUM_PERS_6PLUS_ENH=(sum(of CAC_DEMO_NUM_ADULTS CAC_DEMO_NUM_KIDS_ENH) ge 6);
M_GEO_CAC_INT_42=GEO_CAC_INT_42;
M_CAC_ECOM_4=((CAC_SILH_ECOM=4));


/**** Missfill *****/


attrib _miss53_ length=3 label='M_GEO_CAC_INT_37 missing';
_miss53_ = 0;
if nmiss(M_GEO_CAC_INT_37) GT 0 then do;
   _miss53_ = 1;
   _miss_ = _miss_ + 1;
   M_GEO_CAC_INT_37 = 0.1650301578 ;
end;

attrib _miss4_ length=3 label='M_GEO_CAC_INT_101 missing';
_miss4_ = 0;
if nmiss(M_GEO_CAC_INT_101) GT 0 then do;
   _miss4_ = 1;
   _miss_ = _miss_ + 1;
   M_GEO_CAC_INT_101 = 0.0239656266 ;
end;

attrib _miss31_ length=3 label='M_GEO_CAC_INT_17 missing';
_miss31_ = 0;
if nmiss(M_GEO_CAC_INT_17) GT 0 then do;
   _miss31_ = 1;
   _miss_ = _miss_ + 1;
   M_GEO_CAC_INT_17 = 0.6340724192 ;
end;

attrib _miss780_ length=3 label='CEN_POPRACE_16 missing';
_miss780_ = 0;
if nmiss(CEN_POPRACE_16) GT 0 then do;
   _miss780_ = 1;
   _miss_ = _miss_ + 1;
   CEN_POPRACE_16 = 0.1802833076 ;
end;

attrib _miss42_ length=3 label='M_GEO_CAC_INT_27 missing';
_miss42_ = 0;
if nmiss(M_GEO_CAC_INT_27) GT 0 then do;
   _miss42_ = 1;
   _miss_ = _miss_ + 1;
   M_GEO_CAC_INT_27 = 0.1139967692 ;
end;

attrib _miss643_ length=3 label='CEN_POPLABR_22 missing';
_miss643_ = 0;
if nmiss(CEN_POPLABR_22) GT 0 then do;
   _miss643_ = 1;
   _miss_ = _miss_ + 1;
   CEN_POPLABR_22 = 0.0273976092 ;
end;
attrib _miss36_ length=3 label='M_GEO_CAC_INT_21 missing';
_miss36_ = 0;
if nmiss(M_GEO_CAC_INT_21) GT 0 then do;
   _miss36_ = 1;
   _miss_ = _miss_ + 1;
   M_GEO_CAC_INT_21 = 0.3181551702 ;
end;

attrib _miss59_ length=3 label='M_GEO_CAC_INT_42 missing';
_miss59_ = 0;
if nmiss(M_GEO_CAC_INT_42) GT 0 then do;
   _miss59_ = 1;
   _miss_ = _miss_ + 1;
   M_GEO_CAC_INT_42 = 0.0998962627 ;
end;

attrib _miss573_ length=3 label='CEN_POPED_4 missing';
_miss573_ = 0;
if nmiss(CEN_POPED_4) GT 0 then do;
   _miss573_ = 1;
   _miss_ = _miss_ + 1;
   CEN_POPED_4 = 0.0813380177 ;
end;
/************ Transformations ***************/
T_M_GEO_CAC_INT_101 =100*(   0.124071475363868+(M_GEO_CAC_INT_101*(   4.202045065835430))+((M_GEO_CAC_INT_101**2)*(-181.862270227365000))+((M_GEO_CAC_INT_101**3)*(2022.883944425180000))+((M_GEO_CAC_INT_101**4)*(-6367.98029095348000)));
label t_M_GEO_CAC_INT_101 ='Z2: Mail Order: Womens Plus - transformed';
T_M_GEO_CAC_INT_17 =100*(  -0.725236087047862+(M_GEO_CAC_INT_17*(   5.760053053213900))+((M_GEO_CAC_INT_17**2)*( -15.094857607625300))+((M_GEO_CAC_INT_17**3)*(  17.296407231600100))+((M_GEO_CAC_INT_17**4)*(  -7.057095158680430)));
label t_M_GEO_CAC_INT_17 ='Z2: Electronics - transformed';
T_M_GEO_CAC_INT_21 =100*(   0.066417506307269+(M_GEO_CAC_INT_21*(  -0.138112119608949))+((M_GEO_CAC_INT_21**2)*(   2.090037056384470))+((M_GEO_CAC_INT_21**3)*(  -3.514474200666730))+((M_GEO_CAC_INT_21**4)*(   1.389606756612880)));
label t_M_GEO_CAC_INT_21 ='Z2: Home Furnishing Mail Order - transformed';
T_M_GEO_CAC_INT_27 =100*(   0.096114203316327+(M_GEO_CAC_INT_27*(  -0.378844342886737))+((M_GEO_CAC_INT_27**2)*(  11.547036034275200))+((M_GEO_CAC_INT_27**3)*( -54.978326283608800))+((M_GEO_CAC_INT_27**4)*(  73.897702241226100)));
label t_M_GEO_CAC_INT_27 ='Z2: Cultural/Arts Events - transformed';
T_M_GEO_CAC_INT_37 =100*(   0.046561966169011+(M_GEO_CAC_INT_37*(   1.117776042608450))+((M_GEO_CAC_INT_37**2)*(  -6.672325163390200))+((M_GEO_CAC_INT_37**3)*(  22.801645974004200))+((M_GEO_CAC_INT_37**4)*( -25.939814174071200)));
label t_M_GEO_CAC_INT_37 ='Z2: Golf - transformed';
T_M_INCOME =100*(   0.036942072488129+(M_INCOME*(   0.002287741769374))+((M_INCOME**2)*(  -0.000011838580322))+((M_INCOME**3)*(   0.000000017702176))+((M_INCOME**4)*(   0.000000000007451)));
label t_M_INCOME ='NUMERIC INCOME BASED ON CAC_DEMO_INCOME_ENH - transformed';
T_CEN_POPLABR_22 =100*(   0.154778295983057+(CEN_POPLABR_22*(  -1.173119497404990))+((CEN_POPLABR_22**2)*(   7.003812745398970))+((CEN_POPLABR_22**3)*( -16.372255854771100))+((CEN_POPLABR_22**4)*(  11.845589912610400)));
label t_CEN_POPLABR_22 ='POPULATION LABOR FORCE COMMUTE: % WALKING/BIKING TO WORK - transformed';
T_CEN_POPRACE_16 =100*(   0.101453488071204+(CEN_POPRACE_16*(   0.604941208928034))+((CEN_POPRACE_16**2)*(  -2.345108326542840))+((CEN_POPRACE_16**3)*(   3.120646092580980))+((CEN_POPRACE_16**4)*(  -1.516781741387680)));
label t_CEN_POPRACE_16 ='POPULATION RACE: % CHINESE - ASIAN GROUP - transformed';

/********** Lables ******/


label T_M_INCOME='NUMERIC INCOME BASED ON CAC_DEMO_INCOME_ENH - transformed';
label T_M_GEO_CAC_INT_37='Z2: Golf - transformed';
label M_HOH_AGE_25_44_ENH='HOH AGE 25-44 FLAG  ENH';
label T_M_GEO_CAC_INT_101='Z2: Mail Order: Womens Plus - transformed';
label M_CAC_ECOM_5='ECOM SEG: BRICK AND MORTAR';
label T_M_GEO_CAC_INT_17='Z2: Electronics - transformed';
label T_CEN_POPRACE_16='POPULATION RACE: % CHINESE - ASIAN GROUP - transformed';
label T_M_GEO_CAC_INT_27='Z2: Cultural/Arts Events - transformed';
label T_CEN_POPLABR_22='POPULATION LABOR FORCE COMMUTE: % WALKING/BIKING TO WORK - transformed';
label M_CAC_DIGINF_1='DIG INFLUENCER: MOST INFLUENTIAL';
label M_FAM_COMP_01_ENH='MARRIED HUSBAND AND WIFE PRESENT WITH KIDS FLAG  ENH';
label T_M_GEO_CAC_INT_21='Z2: Home Furnishing Mail Order - transformed';
label M_INC_OVER_100_ENH='Income over 100K ENH';
label CEN_POPED_4='POPULATION EDUCATION: % ADULTS 25+ COMPLETED SOME HIGH SCHOOL';
label M_HOME_OWNER='PROBABLE OR KNOWN HOME OWNER';
label M_NUM_PERS_6PLUS_ENH='Numer of Persones 6 Plus ENH';
label M_GEO_CAC_INT_42='Z2: Wines';
label M_CAC_ECOM_4='ECOM SEG: CAUTIOUS INTERNET';





