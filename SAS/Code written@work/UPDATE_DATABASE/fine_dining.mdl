/************ Recodes *****************/

M_INC_75_100_ENH=((CAC_DEMO_INCOME_ENH='7'));
M_INC_100_125_ENH=((CAC_DEMO_INCOME_ENH='8'));  
M_INC_125_150_ENH=((CAC_DEMO_INCOME_ENH='9')); 
M_INC_150_PLUS_ENH=(strip(CAC_DEMO_INCOME_ENH)in ('A','B','C','D')); 
M_INC_OVER_75_ENH =(M_INC_75_100_ENH=1 OR M_INC_100_125_ENH=1 OR M_INC_125_150_ENH=1 OR M_INC_150_PLUS_ENH=1);


M_INC_UNDER_15_ENH=((CAC_DEMO_INCOME_ENH='1')); 
M_INC_15_20_ENH=((CAC_DEMO_INCOME_ENH='2'));  
M_INC_20_30_ENH=((CAC_DEMO_INCOME_ENH='3')); 
M_INC_UNDER_30_ENH=( M_INC_UNDER_15_ENH=1 OR  M_INC_15_20_ENH=1 OR  M_INC_20_30_ENH=1); 


M_GEO_CAC_INT_40=GEO_CAC_INT_40;
M_CAC_ECOM_5=((CAC_SILH_ECOM=5));
M_CRED_TRAVEL=((CAC_CRED_TRAVEL=1));
M_EDU_COLLEGE_ENH = ((CAC_DEMO_EDUCATION_ENH) in (3,4,5));
M_CAC_INT_FOOD_HIGH=(sum (of CAC_INT_46 CAC_INT_49 CAC_INT_58 CAC_INT_40 CAC_INT_42) ge 3);
M_CAC_ADDR_CDI_D=((CAC_ADDR_CDI='D'));
M_NET_WORTH_OVER_1MM_ENH =((CAC_DEMO_NET_WORTH_ENH=9));
M_GEO_CAC_INT_27=GEO_CAC_INT_27;
M_CAC_SILHOUETTE_K3=((CAC_SILH='K3'));
M_CAC_LIFESTYLE_4=((CAC_SILH_LIFESTYLE=4));
M_CAC_SOCIAL_8=((CAC_SILH_SOCIAL=8)); M_CAC_SOCIAL_9=((CAC_SILH_SOCIAL=9));  M_CAC_SOCIAL_10=((CAC_SILH_SOCIAL=10)); M_SOCIAL_LOW=sum(of M_CAC_SOCIAL_8 M_CAC_SOCIAL_9 M_CAC_SOCIAL_10);
M_OCC_PROF_TECH=((CAC_DEMO_OCCUPATION=5));
M_CAC_SILHOUETTE_H5=((CAC_SILH='H5'));
M_ADLT_55_64_1PLUS_ENH=((CAC_DEMO_ADULT_55_64_ENH) not in (.,0));
M_CAC_SILH_PRICE_5=((CAC_SILH_PRICE=5));
M_MAIL_BUY_SINGLE=((CAC_INT_MAIL_BUY)=1);
M_CAC_SILH_SUPER_E=((CAC_SILH_SUPER='E'));



/****** Missfill *******/
attrib _miss575_ length=3 label='CEN_POPED_6 missing';
_miss575_ = 0;
if nmiss(CEN_POPED_6) GT 0 then do;
   _miss575_ = 1;
   _miss_ = _miss_ + 1;
   CEN_POPED_6 = 0.1809323975 ;
end;


attrib _miss57_ length=3 label='M_GEO_CAC_INT_40 missing';
_miss57_ = 0;
if nmiss(M_GEO_CAC_INT_40) GT 0 then do;
   _miss57_ = 1;
   _miss_ = _miss_ + 1;
   M_GEO_CAC_INT_40 = 0.1942500548 ;
end;


attrib _miss511_ length=3 label='CEN_HSEVAL_5 missing';
_miss511_ = 0;
if nmiss(CEN_HSEVAL_5) GT 0 then do;
   _miss511_ = 1;
   _miss_ = _miss_ + 1;
   CEN_HSEVAL_5 = 0.4762865198 ;
end;

attrib _miss42_ length=3 label='M_GEO_CAC_INT_27 missing';
_miss42_ = 0;
if nmiss(M_GEO_CAC_INT_27) GT 0 then do;
   _miss42_ = 1;
   _miss_ = _miss_ + 1;
   M_GEO_CAC_INT_27 = 0.1142138616 ;
end;


/******* Transformations ***********/

T_M_GEO_CAC_INT_27 =100*(   0.028373201184275+(M_GEO_CAC_INT_27*(  -0.164963465680513))+((M_GEO_CAC_INT_27**2)*(   7.970516411752380))+((M_GEO_CAC_INT_27**3)*( -20.206925772108800))+((M_GEO_CAC_INT_27**4)*(  11.294909500458500)));
label t_M_GEO_CAC_INT_27 ='Z2: Cultural/Arts Events - transformed';
T_M_GEO_CAC_INT_40 =100*(   0.068547355797695+(M_GEO_CAC_INT_40*(  -1.173928271755370))+((M_GEO_CAC_INT_40**2)*(   9.766435379218630))+((M_GEO_CAC_INT_40**3)*( -19.778224466233700))+((M_GEO_CAC_INT_40**4)*(  12.144273209371100)));
label t_M_GEO_CAC_INT_40 ='Z2: Gourmet Foods - transformed';
T_CEN_HSEVAL_5 =100*(   0.042329042367402+(CEN_HSEVAL_5*(  -0.012107675988977))+((CEN_HSEVAL_5**2)*(   0.255991439750775))+((CEN_HSEVAL_5**3)*(  -0.313501860967872))+((CEN_HSEVAL_5**4)*(   0.186761500767167)));
label t_CEN_HSEVAL_5 ='HOUSING UNITS VALUE OF HOME: % HOME VALUE $200,000+ - transformed';



/****** LABELS ******/
label CEN_POPED_6='POPULATION EDUCATION: % ADULTS 25+ WITH BACHELORS DEGREE';
label M_INC_OVER_75_ENH='INCOME OVER 75K ENH';
label M_INC_UNDER_30_ENH='INCOME UNDER 30K ENH';
label T_M_GEO_CAC_INT_40='Z2: Gourmet Foods - transformed';
label M_CAC_ECOM_5='ECOM SEG: BRICK AND MORTAR';
label M_CRED_TRAVEL='TRAVEL ENTERTAINMENT CREDIT CARD FLAG';
label M_EDU_COLLEGE_ENH='HOH EDUCATION COLLEGE OR HIGHER FLAG  ENH';
label T_CEN_HSEVAL_5='HOUSING UNITS VALUE OF HOME: % HOME VALUE $200,000+ - transformed';
label M_CAC_INT_FOOD_HIGH='AT LEAST 3 INTS IN FOOD FLAG';
label M_CAC_ADDR_CDI_D='COUNTIES WITH DENSITY LT 44 HH PER MILE FLAG';
label M_NET_WORTH_OVER_1MM_ENH='CAC_DEMO_NET_WORTH = $1,000,000 or More ENH';
label T_M_GEO_CAC_INT_27='Z2: Cultural/Arts Events - transformed';
label M_CAC_SILHOUETTE_K3='SILHOUETTE: Struggling Seniors';
label M_CAC_LIFESTYLE_4='LIFESTYLE: FINE DINING & WORLD TRAVEL';
label M_SOCIAL_LOW='SOCIAL: IN BOTTOM THREE BUCKETS';
label M_OCC_PROF_TECH='OCCUPATION: PROFESSIONAL OR TECHNICAL';
label M_CAC_SILHOUETTE_H5='SILHOUETTE: Cultured Elite';
label M_ADLT_55_64_1PLUS_ENH='ADULT AGE 55-64 FLAG  ENH';
label M_CAC_SILH_PRICE_5='PRICE DIMENSION: LEAST PRICE SENSITIVE';
label M_MAIL_BUY_SINGLE='SINGLE MAIL BUYER FLAG';
label M_CAC_SILH_SUPER_E='SILH SUPER: PRIVILEDGED PROVIDERS';


