/******************* Recodes *********************/

M_INC_UNDER_15_ENH=((CAC_DEMO_INCOME_ENH='1'));
M_INC_15_20_ENH=((CAC_DEMO_INCOME_ENH='2'));
M_INC_20_30_ENH=((CAC_DEMO_INCOME_ENH='3'));
M_INC_30_40_ENH=((CAC_DEMO_INCOME_ENH='4'));
M_INC_40_50_ENH=((CAC_DEMO_INCOME_ENH='5'));
M_INC_50_75_ENH=((CAC_DEMO_INCOME_ENH='6'));
M_INC_75_100_ENH=((CAC_DEMO_INCOME_ENH='7'));
M_INC_100_125_ENH=((CAC_DEMO_INCOME_ENH='8'));
M_INC_125_150_ENH=((CAC_DEMO_INCOME_ENH='9'));
M_INC_150_PLUS_ENH=(strip(CAC_DEMO_INCOME_ENH)in ('A','B','C','D'));

M_INC_20_25=((CAC_DEMO_INCOME_NARROW_ENH='2'));
M_INC_25_30=((CAC_DEMO_INCOME_NARROW_ENH='3'));
M_INC_30_35=((CAC_DEMO_INCOME_NARROW_ENH='4'));
M_INC_35_40=((CAC_DEMO_INCOME_NARROW_ENH='5'));
M_INC_40_45=((CAC_DEMO_INCOME_NARROW_ENH='6'));
M_INC_45_50=((CAC_DEMO_INCOME_NARROW_ENH='7'));
M_INC_50_55=((CAC_DEMO_INCOME_NARROW_ENH='8'));
M_INC_55_60=((CAC_DEMO_INCOME_NARROW_ENH='9'));
M_INC_60_65=((CAC_DEMO_INCOME_NARROW_ENH='A'));
M_INC_65_70=((CAC_DEMO_INCOME_NARROW_ENH='B'));
M_INC_70_75=((CAC_DEMO_INCOME_NARROW_ENH='C'));
M_INC_75_80=((CAC_DEMO_INCOME_NARROW_ENH='D'));
M_INC_80_85=((CAC_DEMO_INCOME_NARROW_ENH='E'));
M_INC_85_90=((CAC_DEMO_INCOME_NARROW_ENH='F'));
M_INC_90_95=((CAC_DEMO_INCOME_NARROW_ENH='G'));
M_INC_95_100=((CAC_DEMO_INCOME_NARROW_ENH='H'));
M_INC_100_105=((CAC_DEMO_INCOME_NARROW_ENH='I'));
M_INC_105_110=((CAC_DEMO_INCOME_NARROW_ENH='J'));
M_INC_110_115=((CAC_DEMO_INCOME_NARROW_ENH='K'));
M_INC_115_120=((CAC_DEMO_INCOME_NARROW_ENH='L'));
M_INC_120_125=((CAC_DEMO_INCOME_NARROW_ENH='M'));
M_INC_125_130=((CAC_DEMO_INCOME_NARROW_ENH='N'));
M_INC_130_135=((CAC_DEMO_INCOME_NARROW_ENH='O'));
M_INC_135_140=((CAC_DEMO_INCOME_NARROW_ENH='P'));
M_INC_140_145=((CAC_DEMO_INCOME_NARROW_ENH='Q'));
M_INC_145_150=((CAC_DEMO_INCOME_NARROW_ENH='R'));
M_INC_150_160=((CAC_DEMO_INCOME_NARROW_ENH='S'));
M_INC_160_170=((CAC_DEMO_INCOME_NARROW_ENH='T'));
M_INC_170_175=((CAC_DEMO_INCOME_NARROW_ENH='U'));
M_INC_175_190=((CAC_DEMO_INCOME_NARROW_ENH='V'));
M_INC_190_200=((CAC_DEMO_INCOME_NARROW_ENH='W'));
M_INC_200_225=((CAC_DEMO_INCOME_NARROW_ENH='X'));
M_INC_225_250=((CAC_DEMO_INCOME_NARROW_ENH='Y'));
M_INC_250_PLUS=((CAC_DEMO_INCOME_NARROW_ENH='Z'));


   M_INCOME = M_INC_UNDER_15_ENH*7.5 + M_INC_15_20_ENH*17.5 + M_INC_20_25*22.5 + M_INC_25_30*27.5 + M_INC_30_35*32.5 +
              M_INC_35_40*37.5 + M_INC_40_45*42.5 + M_INC_45_50*47.5 + M_INC_50_55*52.5 + M_INC_55_60*57.5 + 
              M_INC_60_65*62.5 + M_INC_65_70*67.5 + M_INC_70_75*72.5 + M_INC_75_80*77.5 + M_INC_80_85*82.5 + 
              M_INC_85_90*87.5 + M_INC_90_95*92.5 + M_INC_95_100*97.5 + M_INC_100_105*102.5 + M_INC_105_110*107.5 + 
              M_INC_110_115*112.5 + M_INC_115_120*117.5 + M_INC_120_125*122.5 + M_INC_125_130*127.5 + M_INC_130_135*132.5 + 
              M_INC_135_140*137.5 + M_INC_140_145*142.5 + M_INC_145_150*147.5 + M_INC_150_PLUS_ENH*250; 
   if M_INCOME = 0 then M_INCOME = .;



M_CAC_SILH_GEO_2=((CAC_SILH_GEO=2));
M_CAC_ECOM_5=((CAC_SILH_ECOM=5));

M_CAC_BUYSTYLE_3=((CAC_SILH_BUY_STYLE_GROUP=3));
M_GEO_CAC_INT_7=GEO_CAC_INT_7;


M_CAC_SILHOUETTE_G3=((CAC_SILH='G3'));
M_CAC_LIFESTAGE_5=((CAC_SILH_LIFESTAGE_GROUP=5));
M_FAM_COMP_02_ENH=((CAC_DEMO_HH_TYPE_ENH=2));
M_OCC_PROF_TECH=((CAC_DEMO_OCCUPATION=5));
M_CAC_SILHOUETTE_I1=((CAC_SILH='I1'));
M_OCC_MANAGEMENT=((CAC_DEMO_OCCUPATION=6));
M_FAM_COMP_10_ENH=((CAC_DEMO_HH_TYPE_ENH=10));
M_CAC_LIFESTYLE_8=((CAC_SILH_LIFESTYLE=8));
M_CAC_LIFESTYLE_13=((CAC_SILH_LIFESTYLE=13));
M_CAC_SILHOUETTE_L1=((CAC_SILH='L1'));

M_GEO_CAC_INT_118=GEO_CAC_INT_118;




/*************** Missfill ************/

attrib _miss22_ length=3 label='M_GEO_CAC_INT_118 missing';
_miss22_ = 0;
if nmiss(M_GEO_CAC_INT_118) GT 0 then do;
   _miss22_ = 1;
   _miss_ = _miss_ + 1;
   M_GEO_CAC_INT_118 = 0.1944428186 ;
end;

attrib _miss134_ length=3 label='CEN_FACTOR4 missing';
_miss134_ = 0;
if nmiss(CEN_FACTOR4) GT 0 then do;
   _miss134_ = 1;
   _miss_ = _miss_ + 1;
   CEN_FACTOR4 = 0.0006096099 ;
end;

attrib _miss139_ length=3 label='CEN_FACTOR9 missing';
_miss139_ = 0;
if nmiss(CEN_FACTOR9) GT 0 then do;
   _miss139_ = 1;
   _miss_ = _miss_ + 1;
   CEN_FACTOR9 = 0.0018001295 ;
end;

attrib _miss133_ length=3 label='CEN_FACTOR3 missing';
_miss133_ = 0;
if nmiss(CEN_FACTOR3) GT 0 then do;
   _miss133_ = 1;
   _miss_ = _miss_ + 1;
   CEN_FACTOR3 = 0.0002638597 ;
end;

attrib _miss89_ length=3 label='M_GEO_CAC_INT_7 missing';
_miss89_ = 0;
if nmiss(M_GEO_CAC_INT_7) GT 0 then do;
   _miss89_ = 1;
   _miss_ = _miss_ + 1;
   M_GEO_CAC_INT_7 = 0.1655975528 ;
end;

attrib _miss507_ length=3 label='CEN_HSEVAL_19 missing';
_miss507_ = 0;
if nmiss(CEN_HSEVAL_19) GT 0 then do;
   _miss507_ = 1;
   _miss_ = _miss_ + 1;
   CEN_HSEVAL_19 = 0.0108167259 ;
end;

attrib _miss346_ length=3 label='CEN_HHSIZE_2 missing';
_miss346_ = 0;
if nmiss(CEN_HHSIZE_2) GT 0 then do;
   _miss346_ = 1;
   _miss_ = _miss_ + 1;
   CEN_HHSIZE_2 = 0.3321325745 ;
end;

attrib _miss137_ length=3 label='CEN_FACTOR7 missing';
_miss137_ = 0;
if nmiss(CEN_FACTOR7) GT 0 then do;
   _miss137_ = 1;
   _miss_ = _miss_ + 1;
   CEN_FACTOR7 = 0.002178671 ;
end;


/*************** Transformations ***********/

T_M_GEO_CAC_INT_118 =100*(   0.043610244513857+(M_GEO_CAC_INT_118*(  -0.115134593772030))+((M_GEO_CAC_INT_118**2)*(   1.889836733803370))+((M_GEO_CAC_INT_118**3)*(   0.553467358196177))+((M_GEO_CAC_INT_118**4)*(  -9.505842202859240)));
label t_M_GEO_CAC_INT_118 ='Z2: Cruise Ship Vacation - transformed';
T_M_GEO_CAC_INT_7 =100*(   0.025536637722098+(M_GEO_CAC_INT_7*(   0.923822975278230))+((M_GEO_CAC_INT_7**2)*(  -3.187141322368320))+((M_GEO_CAC_INT_7**3)*(  -1.020573844893140))+((M_GEO_CAC_INT_7**4)*(   9.802846952294720)));
label t_M_GEO_CAC_INT_7 ='Z2: Camping/Hiking - transformed';
T_M_INCOME =100*(  -0.003191866117787+(M_INCOME*(   0.003383853592367))+((M_INCOME**2)*(  -0.000046127383874))+((M_INCOME**3)*(   0.000000276348373))+((M_INCOME**4)*(  -0.000000000555228)));
label t_M_INCOME ='NUMERIC INCOME BASED ON CAC_DEMO_INCOME_ENH - transformed';
T_CEN_FACTOR3 =100*(   0.079880597594449+(CEN_FACTOR3*(  -0.096660582864129))+((CEN_FACTOR3**2)*(   1.500197570169190))+((CEN_FACTOR3**3)*(  -1.705373207841920))+((CEN_FACTOR3**4)*( -44.988162996135900)));
label t_CEN_FACTOR3 ='CENSUS FACTOR3: Luxury Rentals - transformed';
T_CEN_FACTOR4 =100*(   0.088871529652384+(CEN_FACTOR4*(  -0.380930566643204))+((CEN_FACTOR4**2)*(  -3.570935465254190))+((CEN_FACTOR4**3)*(  24.416343537999700))+((CEN_FACTOR4**4)*(  44.343681872666700)));
label t_CEN_FACTOR4 ='CENSUS FACTOR4: Mortgage Leverage - transformed';
T_CEN_FACTOR7 =100*(   0.081809627768652+(CEN_FACTOR7*(   0.026407549154843))+((CEN_FACTOR7**2)*(   0.559734282676268))+((CEN_FACTOR7**3)*(  -0.061491977953107))+((CEN_FACTOR7**4)*(  -3.735719395634230)));
label t_CEN_FACTOR7 ='CENSUS FACTOR7: Middle Age - transformed';
T_CEN_FACTOR9 =100*(   0.082821500865083+(CEN_FACTOR9*(  -0.459971291778871))+((CEN_FACTOR9**2)*(   0.747197284065696))+((CEN_FACTOR9**3)*(  12.148633506983000))+((CEN_FACTOR9**4)*( -12.058243976331600)));
label t_CEN_FACTOR9 ='CENSUS FACTOR9: Older Housing - transformed';


/************ Lables **********/


label T_M_INCOME='NUMERIC INCOME BASED ON CAC_DEMO_INCOME_ENH - transformed';
label T_M_GEO_CAC_INT_118='Z2: Cruise Ship Vacation - transformed';
label T_CEN_FACTOR4='CENSUS FACTOR4: Mortgage Leverage - transformed';
label T_CEN_FACTOR9='CENSUS FACTOR9: Older Housing - transformed';
label M_CAC_SILH_GEO_2='GEO DIMENSION: In a metro area with fewer than 1MM residents';
label M_CAC_ECOM_5='ECOM SEG: BRICK AND MORTAR';
label T_CEN_FACTOR3='CENSUS FACTOR3: Luxury Rentals - transformed';
label M_CAC_BUYSTYLE_3='BUYSTYLE: ENVIRONMENTAL/HEALTH';
label T_M_GEO_CAC_INT_7='Z2: Camping/Hiking - transformed';
label CEN_HSEVAL_19='HOUSING UNITS VALUE OF HOME, SIZE: AVERAGE VALUE FOR OWNER OCCUPIED HOUSING UNITS - BOAT, RV, VAN, ETC. ($000s)';
label CEN_HHSIZE_2='HOUSEHOLD SIZE: % 2 PERSON HOUSEHOLD';
label M_CAC_SILHOUETTE_G3='SILHOUETTE: Arrived';
label M_CAC_LIFESTAGE_5='LIFESTAGE: EMERGING PARENTS';
label M_FAM_COMP_02_ENH='MARRIED HUSBAND AND WIFE PRESENT NO KIDS FLAG  ENH';
label M_OCC_PROF_TECH='OCCUPATION: PROFESSIONAL OR TECHNICAL';
label M_CAC_SILHOUETTE_I1='SILHOUETTE: Metro Couples';
label M_OCC_MANAGEMENT='OCCUPATION: MANAGEMENT';
label M_FAM_COMP_10_ENH='TWO PERSONS NO KIDS FLAG  ENH';
label M_CAC_LIFESTYLE_8='LIFESTYLE: INVESTORS';
label M_CAC_LIFESTYLE_13='LIFESTYLE: OUTDOOR SPORTS';
label M_CAC_SILHOUETTE_L1='SILHOUETTE: The Cultural Estate';
label T_CEN_FACTOR7='CENSUS FACTOR7: Middle Age - transformed';



